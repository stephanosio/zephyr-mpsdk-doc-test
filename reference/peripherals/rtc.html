<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>RTC &mdash; Zephyr Project Documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/tabs.css" type="text/css" />
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script type="module" src="../../_static/js/dark-mode-toggle.min.mjs"></script>
        <script src="https://www.googletagmanager.com/gtag/js?id=UA-831873-47"></script>
        <script src="../../_static/js/ga-tracker.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="copyright" title="Copyright" href="../../copyright.html" />
    <link rel="next" title="Sensors" href="sensor.html" />
    <link rel="prev" title="Regulators" href="regulators.html" />
  <meta name="color-scheme" content="dark light">
  
  <link rel="stylesheet" href="../../_static/css/light.css" type="text/css" media="(prefers-color-scheme: light)"/>
  <link rel="stylesheet" href="../../_static/css/dark.css" type="text/css" media="(prefers-color-scheme: dark)"/>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html">
            <img src="../../_static/logo.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                3.0.99
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
  
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Zephyr Project</span>
      v: latest
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        <dt>Document Release Versions</dt>
        
          <dd><a href="/">latest</a></dd>
        
          <dd><a href="/3.0.0/">3.0.0</a></dd>
        
          <dd><a href="/2.7.0/">2.7.0</a></dd>
        
          <dd><a href="/2.6.0/">2.6.0</a></dd>
        
          <dd><a href="/2.5.0/">2.5.0</a></dd>
        
          <dd><a href="/2.4.0/">2.4.0</a></dd>
        
          <dd><a href="/2.3.0/">2.3.0</a></dd>
        
          <dd><a href="/1.14.1/">1.14.1</a></dd>
        
      </dl>
      <dl>
        <dt>Downloads</dt>
        
        <dd><a href="/latest/zephyr.pdf">PDF</a></dd>
      </dl>
      <dl>
        <dt>zephyrproject.org Links</dt>
          <dd>
            <a href="https://www.zephyrproject.org/">Project Home</a>
          </dd>
          <dd>
            <a href="https://github.com/zephyrproject-rtos/sdk-ng/releases">SDK</a>
          </dd>
          <dd>
            <a href="https://github.com/zephyrproject-rtos/zephyr/releases">Releases</a>
          </dd>
      </dl>
    </div>
  </div>
  
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started/index.html">Getting Started Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contribute/index.html">Contribution Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development_process/index.html">Development and Contribution Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../guides/build/index.html">Build and Configuration Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../application/index.html">Application Development</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../api/index.html">API Status and Guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../audio/index.html">Audio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../misc/notify.html">Asynchronous Notifications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bluetooth/index.html">Bluetooth</a></li>
<li class="toctree-l2"><a class="reference internal" href="../canbus/index.html">Controller Area Network (CAN)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../crypto/index.html">Crypto</a></li>
<li class="toctree-l2"><a class="reference internal" href="../devicetree/index.html">Devicetree</a></li>
<li class="toctree-l2"><a class="reference internal" href="../drivers/index.html">Device Driver Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../display/index.html">Display Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../edac/index.html">Error Detection And Correction (EDAC)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../file_system/index.html">File Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iterable_sections/index.html">Iterable Sections</a></li>
<li class="toctree-l2"><a class="reference internal" href="../misc/formatted_output.html">Formatted Output</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kernel/index.html">Kernel Services</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libc/index.html">C standard library</a></li>
<li class="toctree-l2"><a class="reference internal" href="../logging/index.html">Logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../memory_management/index.html">Memory Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../misc/index.html">Miscellaneous</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data_structures/index.html">Data Structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modbus/index.html">Modbus</a></li>
<li class="toctree-l2"><a class="reference internal" href="../networking/index.html">Networking</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Peripherals</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="adc.html">ADC</a></li>
<li class="toctree-l3"><a class="reference internal" href="counter.html">Counter</a></li>
<li class="toctree-l3"><a class="reference internal" href="clock_control.html">Clock Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="dac.html">DAC</a></li>
<li class="toctree-l3"><a class="reference internal" href="dma.html">DMA</a></li>
<li class="toctree-l3"><a class="reference internal" href="ec_host_cmd_periph.html">EC Host Command</a></li>
<li class="toctree-l3"><a class="reference internal" href="eeprom.html">EEPROM</a></li>
<li class="toctree-l3"><a class="reference internal" href="entropy.html">Entropy</a></li>
<li class="toctree-l3"><a class="reference internal" href="flash.html">Flash</a></li>
<li class="toctree-l3"><a class="reference internal" href="gna.html">GNA</a></li>
<li class="toctree-l3"><a class="reference internal" href="gpio.html">GPIO</a></li>
<li class="toctree-l3"><a class="reference internal" href="hwinfo.html">Hardware Information</a></li>
<li class="toctree-l3"><a class="reference internal" href="i2c_eeprom_slave.html">I2C EEPROM Slave</a></li>
<li class="toctree-l3"><a class="reference internal" href="i2c.html">I2C</a></li>
<li class="toctree-l3"><a class="reference internal" href="ipm.html">IPM</a></li>
<li class="toctree-l3"><a class="reference internal" href="kscan.html">KSCAN</a></li>
<li class="toctree-l3"><a class="reference internal" href="led.html">LED</a></li>
<li class="toctree-l3"><a class="reference internal" href="mbox.html">MBOX</a></li>
<li class="toctree-l3"><a class="reference internal" href="pinmux.html">Pinmux</a></li>
<li class="toctree-l3"><a class="reference internal" href="pwm.html">PWM</a></li>
<li class="toctree-l3"><a class="reference internal" href="ps2.html">PS/2</a></li>
<li class="toctree-l3"><a class="reference internal" href="peci.html">PECI</a></li>
<li class="toctree-l3"><a class="reference internal" href="regulators.html">Regulators</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">RTC</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#api-reference">API Reference</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="sensor.html">Sensors</a></li>
<li class="toctree-l3"><a class="reference internal" href="spi.html">SPI</a></li>
<li class="toctree-l3"><a class="reference internal" href="uart.html">UART</a></li>
<li class="toctree-l3"><a class="reference internal" href="mdio.html">MDIO</a></li>
<li class="toctree-l3"><a class="reference internal" href="watchdog.html">Watchdog</a></li>
<li class="toctree-l3"><a class="reference internal" href="video.html">Video</a></li>
<li class="toctree-l3"><a class="reference internal" href="espi.html">eSPI</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../pinctrl/index.html">Pin Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pm/index.html">Power Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../random/index.html">Random Number Generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../resource_management/index.html">Resource Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shell/index.html">Shell</a></li>
<li class="toctree-l2"><a class="reference internal" href="../storage/index.html">Storage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../task_wdt/index.html">Task Watchdog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../misc/timeutil.html">Time Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../usb/index.html">USB device support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../usermode/index.html">User Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../util/index.html">Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../settings/index.html">Settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../timing_functions/index.html">Executing Time Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../virtualization/index.html">Virtualization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../guides/index.html">User and Developer Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../security/index.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../samples/index.html">Samples and Demos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../boards/index.html">Supported Boards</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../releases/index.html">Release Notes</a></li>
</ul>

  
  <div class="toctree-wrapper compound">
    <p class="caption"><span class="caption-text">Reference</span></p>
    <ul>
      
      <li class="toctree-l1">
        <a class="reference internal" href="/latest/doxygen/html/index.html">API</a>
      </li>
      
      <li class="toctree-l1">
        <a class="reference internal" href="/latest/kconfig.html">Kconfig Options</a>
      </li>
      
      <li class="toctree-l1">
        <a class="reference internal" href="/latest/reference/devicetree/bindings.html">Devicetree Bindings</a>
      </li>
      
    </ul>
  </div>
  

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Zephyr Project</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
  <!-- Docs / Latest -->
  
  

  <li><a href="../../index.html">Docs / Latest</a> &raquo;</li>
  
     <li><a href="../index.html">API Reference</a> &raquo;</li>
  
     <li><a href="index.html">Peripherals</a> &raquo;</li>
  
  <li>RTC</li>


  <li class="wy-breadcrumbs-aside">
    <dark-mode-toggle id="dark-mode-toggle" appearance="toggle" permanent="true"/>
  </li>
  <li class="wy-breadcrumbs-aside">
      
      
        <a href="https://github.com/zephyrproject-rtos/zephyr/blob/main/doc/reference/peripherals/rtc.rst" class="fa fa-github"> Open on GitHub</a>
      
    
  </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
  
    <div class="wy-alert wy-alert-danger">
     This is the documentation for the latest (main) development branch of
     Zephyr. If you are looking for the documentation of previous releases, use
     the drop-down menu on the left and select the desired version.
    </div>
  
  
           <div itemprop="articleBody">
             
  <div class="section" id="rtc">
<span id="rtc-api"></span><h1>RTC<a class="headerlink" href="#rtc" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>This is a placeholder for API specific to real-time clocks.  Currently
all RTC peripherals are implemented through <a class="reference internal" href="counter.html#counter-api"><span class="std std-ref">Counter</span></a> with
device-specific API for counters with real-time support.</p>
</div>
<div class="section" id="api-reference">
<h2>API Reference<a class="headerlink" href="#api-reference" title="Permalink to this headline">¶</a></h2>
<dl>
<dt class="sig sig-object cpp">
<span class="target" id="group__rtc__interface"></span><em><span class="pre">group</span></em> <span class="sig-name descname"><span class="pre">rtc_interface</span></span></dt>
<dd><p>RTC DS3231 Driver-Specific API. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-typedefs">Typedefs</p>
<dl class="c type">
<dt class="sig sig-object c" id="c.maxim_ds3231_alarm_callback_handler_t">
<span class="target" id="group__rtc__interface_1ga684b29dc1c11d8df698437f27e6d0403"></span><span class="k"><span class="pre">typedef</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">maxim_ds3231_alarm_callback_handler_t</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="../drivers/index.html#c.device" title="device"><span class="n"><span class="pre">device</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">dev</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">id</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n"><span class="pre">syncclock</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">user_data</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#c.maxim_ds3231_alarm_callback_handler_t" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Signature for DS3231 alarm callbacks. </p>
<p>The alarm callback is invoked from the system work queue thread. At the point the callback is invoked the corresponding alarm flags will have been cleared from the device status register. The callback is permitted to invoke operations on the device.</p>
<dl class="field-list simple">
<dt class="field-odd">Param dev</dt>
<dd class="field-odd"><p>the device from which the callback originated </p>
</dd>
<dt class="field-even">Param id</dt>
<dd class="field-even"><p>the alarm id </p>
</dd>
<dt class="field-odd">Param syncclock</dt>
<dd class="field-odd"><p>the value from <a class="reference internal" href="#group__rtc__interface_1ga68e1512974db4b526a632e140fa7eed8"><span class="std std-ref">maxim_ds3231_read_syncclock()</span></a> at the time the alarm interrupt was processed. </p>
</dd>
<dt class="field-even">Param user_data</dt>
<dd class="field-even"><p>the corresponding parameter from <a class="reference internal" href="#structmaxim__ds3231__alarm_1a192fb8c10246bfe466e74aafbb45d720"><span class="std std-ref">maxim_ds3231_alarm::user_data</span></a>. </p>
</dd>
</dl>
</dd></dl>

<dl class="c type">
<dt class="sig sig-object c" id="c.maxim_ds3231_notify_callback">
<span class="target" id="group__rtc__interface_1ga59541c849327f388169ca3a15df0ba57"></span><span class="k"><span class="pre">typedef</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">maxim_ds3231_notify_callback</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="../drivers/index.html#c.device" title="device"><span class="n"><span class="pre">device</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">dev</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="../misc/notify.html#c.sys_notify" title="sys_notify"><span class="n"><span class="pre">sys_notify</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">notify</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">res</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#c.maxim_ds3231_notify_callback" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Signature used to notify a user of the DS3231 that an asynchronous operation has completed. </p>
<p>Functions compatible with this type are subject to all the constraints of <a class="reference internal" href="../misc/notify.html#group__sys__notify__apis_1ga2a9ffe35a5ad44fb7c5b00bb5c5c0499"><span class="std std-ref">sys_notify_generic_callback</span></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Param dev</dt>
<dd class="field-odd"><p>the DS3231 device pointer</p>
</dd>
<dt class="field-even">Param notify</dt>
<dd class="field-even"><p>the notification structure provided in the call</p>
</dd>
<dt class="field-odd">Param res</dt>
<dd class="field-odd"><p>the result of the operation. </p>
</dd>
</dl>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.maxim_ds3231_read_syncclock">
<span class="target" id="group__rtc__interface_1ga68e1512974db4b526a632e140fa7eed8"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">maxim_ds3231_read_syncclock</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="../drivers/index.html#c.device" title="device"><span class="n"><span class="pre">device</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">dev</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.maxim_ds3231_read_syncclock" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Read the local synchronization clock. </p>
<p>Synchronization aligns the DS3231 real-time clock with a stable monotonic local clock which should have a frequency between 1 kHz and 1 MHz and be itself synchronized with the primary system time clock. The accuracy of the alignment and the maximum time between synchronization updates is affected by the resolution of this clock.</p>
<p>On some systems the hardware clock from k_cycles_get_32() is suitable, but on others that clock advances too quickly. The frequency of the target-specific clock is provided by <a class="reference internal" href="#group__rtc__interface_1ga6e4a3f34023be910d33fd7f89f81dba3"><span class="std std-ref">maxim_ds3231_syncclock_frequency()</span></a>.</p>
<p>At this time the value is captured from <code class="docutils literal notranslate"><a class="reference internal" href="../kernel/timing/clocks.html#group__clock__apis_1ga9253cfb7b46af4d8994349323ce9872b"><span class="std std-ref"><span class="pre">k_uptime_get_32()</span></span></a></code>; future kernel extensions may make a higher-resolution clock available.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function is <em>isr-ok</em>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dev</strong> – the DS3231 device pointer</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the current value of the synchronization clock. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.maxim_ds3231_syncclock_frequency">
<span class="target" id="group__rtc__interface_1ga6e4a3f34023be910d33fd7f89f81dba3"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">maxim_ds3231_syncclock_frequency</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="../drivers/index.html#c.device" title="device"><span class="n"><span class="pre">device</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">dev</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.maxim_ds3231_syncclock_frequency" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Get the frequency of the synchronization clock. </p>
<p>Provides the frequency of the clock used in <a class="reference internal" href="#group__rtc__interface_1ga68e1512974db4b526a632e140fa7eed8"><span class="std std-ref">maxim_ds3231_read_syncclock()</span></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dev</strong> – the DS3231 device pointer</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the frequency of the selected synchronization clock. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.maxim_ds3231_ctrl_update">
<span class="target" id="group__rtc__interface_1ga1a41193eb70b147eb623ff07be3b3954"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">maxim_ds3231_ctrl_update</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="../drivers/index.html#c.device" title="device"><span class="n"><span class="pre">device</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">dev</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">set_bits</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">clear_bits</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.maxim_ds3231_ctrl_update" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Set and clear specific bits in the control register. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function assumes the device register cache is valid. It will not read the register value, and it will write to the device only if the value changes as a result of applying the set and clear changes.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Unlike <a class="reference internal" href="#group__rtc__interface_1ga1073100b5943141333de8cfd0cd8ac2b"><span class="std std-ref">maxim_ds3231_stat_update()</span></a> the return value from this function indicates the register value after changes were made. That return value is cached for use in subsequent operations.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function is <em>supervisor</em>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the non-negative updated value of the register, or a negative error code from an I2C transaction. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.maxim_ds3231_stat_update">
<span class="target" id="group__rtc__interface_1ga1073100b5943141333de8cfd0cd8ac2b"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">maxim_ds3231_stat_update</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="../drivers/index.html#c.device" title="device"><span class="n"><span class="pre">device</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">dev</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">set_bits</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">clear_bits</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.maxim_ds3231_stat_update" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Read the ctrl_stat register then set and clear bits in it. </p>
<p>The content of the ctrl_stat register will be read, then the set and clear bits applied and the result written back to the device (regardless of whether there appears to be a change in value).</p>
<p>OSF, A1F, and A2F will be written with 1s if the corresponding bits do not appear in either <code class="docutils literal notranslate"><span class="pre">set_bits</span></code> or <code class="docutils literal notranslate"><span class="pre">clear_bits</span></code>. This ensures that if any flag becomes set between the read and the write that indicator will not be cleared.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Unlike <a class="reference internal" href="#group__rtc__interface_1ga1a41193eb70b147eb623ff07be3b3954"><span class="std std-ref">maxim_ds3231_ctrl_update()</span></a> the return value from this function indicates the register value before any changes were made.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function is <em>supervisor</em>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dev</strong> – the DS3231 device pointer</p></li>
<li><p><strong>set_bits</strong> – bits to be set when writing back. Setting bits other than MAXIM_DS3231_REG_STAT_EN32kHz will have no effect.</p></li>
<li><p><strong>clear_bits</strong> – bits to be cleared when writing back. Include the bits for the status flags you want to clear.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the non-negative register value as originally read (disregarding the effect of clears and sets), or a negative error code from an I2C transaction. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.maxim_ds3231_get_alarm">
<span class="target" id="group__rtc__interface_1gabc9bd9ff8a2107c08a7d9ca02c162be1"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">maxim_ds3231_get_alarm</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="../drivers/index.html#c.device" title="device"><span class="n"><span class="pre">device</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">dev</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">id</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.maxim_ds3231_alarm" title="maxim_ds3231_alarm"><span class="n"><span class="pre">maxim_ds3231_alarm</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">cfg</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.maxim_ds3231_get_alarm" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Read a DS3231 alarm configuration. </p>
<p>The alarm configuration data is read from the device and reconstructed into the output parameter.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function is <em>supervisor</em>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dev</strong> – the DS3231 device pointer.</p></li>
<li><p><strong>id</strong> – the alarm index, which must be 0 (for the 1 s resolution alarm) or 1 (for the 1 min resolution alarm).</p></li>
<li><p><strong>cfg</strong> – a pointer to a structure into which the configured alarm data will be stored.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a non-negative value indicating successful conversion, or a negative error code from an I2C transaction or invalid parameter. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.maxim_ds3231_set_alarm">
<span class="target" id="group__rtc__interface_1ga8f876ad2e16e88d80a2f914be3df49b1"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">maxim_ds3231_set_alarm</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="../drivers/index.html#c.device" title="device"><span class="n"><span class="pre">device</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">dev</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n"><span class="pre">id</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.maxim_ds3231_alarm" title="maxim_ds3231_alarm"><span class="n"><span class="pre">maxim_ds3231_alarm</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">cfg</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.maxim_ds3231_set_alarm" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Configure a DS3231 alarm. </p>
<p>The alarm configuration is validated and stored into the device.</p>
<p>To cancel an alarm use <a class="reference internal" href="counter.html#group__counter__interface_1gade0bb97c0dfa03676d11ee47601d4cee"><span class="std std-ref">counter_cancel_channel_alarm()</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function is <em>supervisor</em>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dev</strong> – the DS3231 device pointer.</p></li>
<li><p><strong>id</strong> – 0 Analog to counter index. <code class="docutils literal notranslate"><span class="pre">ALARM1</span></code> is 0 and has 1 s resolution, <code class="docutils literal notranslate"><span class="pre">ALARM2</span></code> is 1 and has 1 minute resolution.</p></li>
<li><p><strong>cfg</strong> – a pointer to the desired alarm configuration. Both alarms are configured; if only one is to change the application must supply the existing configuration for the other.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a non-negative value on success, or a negative error code from an I2C transaction or an invalid parameter. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.maxim_ds3231_synchronize">
<span class="target" id="group__rtc__interface_1gabdf39bc4983b12646ad3b18ccfc1a7dc"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">maxim_ds3231_synchronize</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="../drivers/index.html#c.device" title="device"><span class="n"><span class="pre">device</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">dev</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="../misc/notify.html#c.sys_notify" title="sys_notify"><span class="n"><span class="pre">sys_notify</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">notify</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.maxim_ds3231_synchronize" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Synchronize the RTC against the local clock. </p>
<p>The RTC advances one tick per second with no access to sub-second precision. Synchronizing clocks at sub-second resolution requires enabling a 1pps signal then capturing the system clocks in a GPIO callback. This function provides that operation.</p>
<p>Synchronization is performed in asynchronously, and may take as long as 1 s to complete; notification of completion is provided through the <code class="docutils literal notranslate"><span class="pre">notify</span></code> parameter.</p>
<p>Applications should use <a class="reference internal" href="#group__rtc__interface_1ga4e9fab406fd3b9b20c0c7011bfbb7a8a"><span class="std std-ref">maxim_ds3231_get_syncpoint()</span></a> to retrieve the synchronization data collected by this operation.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function is <em>supervisor</em>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dev</strong> – the DS3231 device pointer.</p></li>
<li><p><strong>notify</strong> – pointer to the object used to specify asynchronous function behavior and store completion information.</p></li>
</ul>
</dd>
<dt class="field-even">Return values</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>non-negative</strong> – on success </p></li>
<li><p><strong>-EBUSY</strong> – if a synchronization or set is currently in progress </p></li>
<li><p><strong>-EINVAL</strong> – if notify is not provided </p></li>
<li><p><strong>-ENOTSUP</strong> – if the required interrupt is not configured </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.maxim_ds3231_req_syncpoint">
<span class="target" id="group__rtc__interface_1ga45656b5994c063b77d04f60c71d42c5b"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">maxim_ds3231_req_syncpoint</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="../drivers/index.html#c.device" title="device"><span class="n"><span class="pre">device</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">dev</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="../kernel/other/polling.html#c.k_poll_signal" title="k_poll_signal"><span class="n"><span class="pre">k_poll_signal</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">signal</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.maxim_ds3231_req_syncpoint" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Request to update the synchronization point. </p>
<p>This is a variant of <a class="reference internal" href="#group__rtc__interface_1gabdf39bc4983b12646ad3b18ccfc1a7dc"><span class="std std-ref">maxim_ds3231_synchronize()</span></a> for use from user threads.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dev</strong> – the DS3231 device pointer.</p></li>
<li><p><strong>signal</strong> – pointer to a valid and ready-to-be-signalled <a class="reference internal" href="../kernel/other/polling.html#structk__poll__signal"><span class="std std-ref">k_poll_signal</span></a>. May be NULL to request a synchronization point be collected without notifying when it has been updated.</p></li>
</ul>
</dd>
<dt class="field-even">Return values</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>non-negative</strong> – on success </p></li>
<li><p><strong>-EBUSY</strong> – if a synchronization or set is currently in progress </p></li>
<li><p><strong>-ENOTSUP</strong> – if the required interrupt is not configured </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.maxim_ds3231_get_syncpoint">
<span class="target" id="group__rtc__interface_1ga4e9fab406fd3b9b20c0c7011bfbb7a8a"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">maxim_ds3231_get_syncpoint</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="../drivers/index.html#c.device" title="device"><span class="n"><span class="pre">device</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">dev</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.maxim_ds3231_syncpoint" title="maxim_ds3231_syncpoint"><span class="n"><span class="pre">maxim_ds3231_syncpoint</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">syncpoint</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.maxim_ds3231_get_syncpoint" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Retrieve the most recent synchronization point. </p>
<p>This function returns the synchronization data last captured using <a class="reference internal" href="#group__rtc__interface_1gabdf39bc4983b12646ad3b18ccfc1a7dc"><span class="std std-ref">maxim_ds3231_synchronize()</span></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dev</strong> – the DS3231 device pointer.</p></li>
<li><p><strong>syncpoint</strong> – where to store the synchronization data.</p></li>
</ul>
</dd>
<dt class="field-even">Return values</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>non-negative</strong> – on success </p></li>
<li><p><strong>-ENOENT</strong> – if no syncpoint has been captured </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.maxim_ds3231_set">
<span class="target" id="group__rtc__interface_1ga485db29a3aca59000798d5ae16ad7041"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">maxim_ds3231_set</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="../drivers/index.html#c.device" title="device"><span class="n"><span class="pre">device</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">dev</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.maxim_ds3231_syncpoint" title="maxim_ds3231_syncpoint"><span class="n"><span class="pre">maxim_ds3231_syncpoint</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">syncpoint</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="../misc/notify.html#c.sys_notify" title="sys_notify"><span class="n"><span class="pre">sys_notify</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">notify</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.maxim_ds3231_set" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Set the RTC to a time consistent with the provided synchronization. </p>
<p>The RTC advances one tick per second with no access to sub-second precision, and setting the clock resets the internal countdown chain. This function implements the magic necessary to set the clock while retaining as much sub-second accuracy as possible. It requires a synchronization point that pairs sub-second resolution civil time with a local synchronization clock captured at the same instant. The set operation may take as long as 1 second to complete; notification of completion is provided through the <code class="docutils literal notranslate"><span class="pre">notify</span></code> parameter.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function is <em>supervisor</em>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dev</strong> – the DS3231 device pointer.</p></li>
<li><p><strong>syncpoint</strong> – the structure providing the synchronization point.</p></li>
<li><p><strong>notify</strong> – pointer to the object used to specify asynchronous function behavior and store completion information.</p></li>
</ul>
</dd>
<dt class="field-even">Return values</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>non-negative</strong> – on success </p></li>
<li><p><strong>-EINVAL</strong> – if syncpoint or notify are null </p></li>
<li><p><strong>-ENOTSUP</strong> – if the required interrupt signal is not configured </p></li>
<li><p><strong>-EBUSY</strong> – if a synchronization or set is currently in progress </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.maxim_ds3231_check_alarms">
<span class="target" id="group__rtc__interface_1gab2091298eb9b94da29ad79616b707bad"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">maxim_ds3231_check_alarms</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="../drivers/index.html#c.device" title="device"><span class="n"><span class="pre">device</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">dev</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.maxim_ds3231_check_alarms" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Check for and clear flags indicating that an alarm has fired. </p>
<p>Returns a mask indicating alarms that are marked as having fired, and clears from stat the flags that it found set. Alarms that have been configured with a callback are not represented in the return value.</p>
<p>This API may be used when a persistent alarm has been programmed.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function is <em>supervisor</em>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dev</strong> – the DS3231 device pointer.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a non-negative value that may have MAXIM_DS3231_ALARM1 and/or MAXIM_DS3231_ALARM2 set, or a negative error code. </p>
</dd>
</dl>
</dd></dl>

</div>
<dl class="c struct">
<dt class="sig sig-object c" id="c.maxim_ds3231_alarm">
<span class="target" id="structmaxim__ds3231__alarm"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">maxim_ds3231_alarm</span></span></span><a class="headerlink" href="#c.maxim_ds3231_alarm" title="Permalink to this definition">¶</a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;maxim_ds3231.h&gt;</em></div>
<p>Information defining the alarm configuration. </p>
<p>DS3231 alarms can be set to fire at specific times or at the rollover of minute, hour, day, or day of week.</p>
<p>When an alarm is configured with a handler an interrupt will be generated and the handler called from the system work queue.</p>
<p>When an alarm is configured without a handler, or a persisted alarm is present, alarms can be read using <a class="reference internal" href="#group__rtc__interface_1gab2091298eb9b94da29ad79616b707bad"><span class="std std-ref">maxim_ds3231_check_alarms()</span></a>. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="c var">
<dt class="sig sig-object c" id="c.maxim_ds3231_alarm.time">
<span class="target" id="structmaxim__ds3231__alarm_1a363a2dc65517c3d00de7658ce421937f"></span><span class="n"><span class="pre">time_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">time</span></span></span><a class="headerlink" href="#c.maxim_ds3231_alarm.time" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Time specification for an RTC alarm. </p>
<p>Though specified as a UNIX time, the alarm parameters are determined by converting to civil time and interpreting the component hours, minutes, seconds, day-of-week, and day-of-month fields, mediated by the corresponding <a class="reference internal" href="#structmaxim__ds3231__alarm_1a98ebc645761cc0d035e269fa8d3f9c68"><span class="std std-ref">flags</span></a>.</p>
<p>The year and month are ignored, but be aware that gmtime() determines day-of-week based on calendar date. Decoded alarm times will fall within 1978-01 since 1978-01-01 (first of month) was a Sunday (first of week). </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.maxim_ds3231_alarm.handler">
<span class="target" id="structmaxim__ds3231__alarm_1a9628b99ed059a64f25143291c0df1c8c"></span><a class="reference internal" href="#c.maxim_ds3231_alarm_callback_handler_t" title="maxim_ds3231_alarm_callback_handler_t"><span class="n"><span class="pre">maxim_ds3231_alarm_callback_handler_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">handler</span></span></span><a class="headerlink" href="#c.maxim_ds3231_alarm.handler" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Handler to be invoked when alarms are signalled. </p>
<p>If this is null the alarm will not be triggered by the INTn/SQW GPIO. This is a “persisted” alarm from its role in using the DS3231 to trigger a wake from deep sleep. The application should use <a class="reference internal" href="#group__rtc__interface_1gab2091298eb9b94da29ad79616b707bad"><span class="std std-ref">maxim_ds3231_check_alarms()</span></a> to determine whether such an alarm has been triggered.</p>
<p>If this is not null the driver will monitor the ISW GPIO for alarm signals and will invoke the handler with a parameter carrying the value returned by <a class="reference internal" href="#group__rtc__interface_1gab2091298eb9b94da29ad79616b707bad"><span class="std std-ref">maxim_ds3231_check_alarms()</span></a>. The corresponding status flags will be cleared in the device before the handler is invoked.</p>
<p>The handler will be invoked from the system work queue. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.maxim_ds3231_alarm.user_data">
<span class="target" id="structmaxim__ds3231__alarm_1a192fb8c10246bfe466e74aafbb45d720"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">user_data</span></span></span><a class="headerlink" href="#c.maxim_ds3231_alarm.user_data" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>User-provided pointer passed to alarm callback. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.maxim_ds3231_alarm.flags">
<span class="target" id="structmaxim__ds3231__alarm_1a98ebc645761cc0d035e269fa8d3f9c68"></span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">flags</span></span></span><a class="headerlink" href="#c.maxim_ds3231_alarm.flags" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Flags controlling configuration of the alarm alarm. </p>
<p>See MAXIM_DS3231_ALARM_FLAGS_IGNSE and related constants.</p>
<p>Note that as described the alarm mask fields require that if a unit is not ignored, higher-precision units must also not be ignored. For example, if match on hours is enabled, match on minutes and seconds must also be enabled. Failure to comply with this requirement will cause <a class="reference internal" href="#group__rtc__interface_1ga8f876ad2e16e88d80a2f914be3df49b1"><span class="std std-ref">maxim_ds3231_set_alarm()</span></a> to return an error, leaving the alarm configuration unchanged. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="c struct">
<dt class="sig sig-object c" id="c.maxim_ds3231_syncpoint">
<span class="target" id="structmaxim__ds3231__syncpoint"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">maxim_ds3231_syncpoint</span></span></span><a class="headerlink" href="#c.maxim_ds3231_syncpoint" title="Permalink to this definition">¶</a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;maxim_ds3231.h&gt;</em></div>
<p>Register the RTC clock against system clocks. </p>
<p>This captures the same instant in both the RTC time scale and a stable system clock scale, allowing conversion between those scales. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="c var">
<dt class="sig sig-object c" id="c.maxim_ds3231_syncpoint.rtc">
<span class="target" id="structmaxim__ds3231__syncpoint_1aff4219f350140cb6a53e73bb91815452"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">timespec</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">rtc</span></span></span><a class="headerlink" href="#c.maxim_ds3231_syncpoint.rtc" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Time from the DS3231. </p>
<p>This maybe in UTC, TAI, or local offset depending on how the RTC is maintained. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.maxim_ds3231_syncpoint.syncclock">
<span class="target" id="structmaxim__ds3231__syncpoint_1adb649c698084d6dbb83915aa6e6079b8"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">syncclock</span></span></span><a class="headerlink" href="#c.maxim_ds3231_syncpoint.syncclock" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Value of a local clock at the same instant as <a class="reference internal" href="#structmaxim__ds3231__syncpoint_1aff4219f350140cb6a53e73bb91815452"><span class="std std-ref">rtc</span></a>. </p>
<p>This is captured from a stable monotonic system clock running at between 1 kHz and 1 MHz, allowing for microsecond to millisecond accuracy in synchronization. </p>
</dd></dl>

</div>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
          </div>

          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; <a href="../../copyright.html">Copyright</a> 2015-2022 Zephyr Project members and individual contributors.
      <span class="lastupdated">Last updated on Mar 05, 2022.
      </span></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>