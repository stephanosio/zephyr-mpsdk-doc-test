<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Stacks &mdash; Zephyr Project Documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/custom.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/tabs.css" type="text/css" />
    <link rel="shortcut icon" href="../../../_static/favicon.png"/>
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script type="module" src="../../../_static/js/dark-mode-toggle.min.mjs"></script>
        <script src="https://www.googletagmanager.com/gtag/js?id=UA-831873-47"></script>
        <script src="../../../_static/js/ga-tracker.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="copyright" title="Copyright" href="../../../copyright.html" />
    <link rel="next" title="Message Queues" href="message_queues.html" />
    <link rel="prev" title="LIFOs" href="lifos.html" />
  <meta name="color-scheme" content="dark light">
  
  <link rel="stylesheet" href="../../../_static/css/light.css" type="text/css" media="(prefers-color-scheme: light)"/>
  <link rel="stylesheet" href="../../../_static/css/dark.css" type="text/css" media="(prefers-color-scheme: dark)"/>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html">
            <img src="../../../_static/logo.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                3.0.0-rc3
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
  
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Zephyr Project</span>
      v: latest
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        <dt>Document Release Versions</dt>
        
          <dd><a href="/">latest</a></dd>
        
          <dd><a href="/2.7.0/">2.7.0</a></dd>
        
          <dd><a href="/2.6.0/">2.6.0</a></dd>
        
          <dd><a href="/2.5.0/">2.5.0</a></dd>
        
          <dd><a href="/2.4.0/">2.4.0</a></dd>
        
          <dd><a href="/2.3.0/">2.3.0</a></dd>
        
          <dd><a href="/1.14.1/">1.14.1</a></dd>
        
      </dl>
      <dl>
        <dt>Downloads</dt>
        
        <dd><a href="/latest/zephyr.pdf">PDF</a></dd>
      </dl>
      <dl>
        <dt>zephyrproject.org Links</dt>
          <dd>
            <a href="https://www.zephyrproject.org/">Project Home</a>
          </dd>
          <dd>
            <a href="https://github.com/zephyrproject-rtos/sdk-ng/releases">SDK</a>
          </dd>
          <dd>
            <a href="https://github.com/zephyrproject-rtos/zephyr/releases">Releases</a>
          </dd>
      </dl>
    </div>
  </div>
  
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started/index.html">Getting Started Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contribute/index.html">Contribution Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../development_process/index.html">Development and Contribution Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../guides/build/index.html">Build and Configuration Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../application/index.html">Application Development</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../api/index.html">API Status and Guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../audio/index.html">Audio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../misc/notify.html">Asynchronous Notifications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../bluetooth/index.html">Bluetooth</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../canbus/index.html">Controller Area Network (CAN)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../crypto/index.html">Crypto</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../devicetree/index.html">Devicetree</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../drivers/index.html">Device Driver Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../display/index.html">Display Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../edac/index.html">Error Detection And Correction (EDAC)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../file_system/index.html">File Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../iterable_sections/index.html">Iterable Sections</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../misc/formatted_output.html">Formatted Output</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Kernel Services</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../index.html#scheduling-interrupts-and-synchronization">Scheduling, Interrupts, and Synchronization</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../index.html#data-passing">Data Passing</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="queues.html">Queues</a></li>
<li class="toctree-l4"><a class="reference internal" href="fifos.html">FIFOs</a></li>
<li class="toctree-l4"><a class="reference internal" href="lifos.html">LIFOs</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Stacks</a></li>
<li class="toctree-l4"><a class="reference internal" href="message_queues.html">Message Queues</a></li>
<li class="toctree-l4"><a class="reference internal" href="mailboxes.html">Mailboxes</a></li>
<li class="toctree-l4"><a class="reference internal" href="pipes.html">Pipes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#memory-management">Memory Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#timing">Timing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#other">Other</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../libc/index.html">C standard library</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../logging/index.html">Logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../memory_management/index.html">Memory Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../misc/index.html">Miscellaneous</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../data_structures/index.html">Data Structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../modbus/index.html">Modbus</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../networking/index.html">Networking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../peripherals/index.html">Peripherals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../pinctrl/index.html">Pin Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../pm/index.html">Power Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../random/index.html">Random Number Generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../resource_management/index.html">Resource Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../shell/index.html">Shell</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../storage/index.html">Storage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../task_wdt/index.html">Task Watchdog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../misc/timeutil.html">Time Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usb/index.html">USB device support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usermode/index.html">User Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../util/index.html">Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../settings/index.html">Settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../timing_functions/index.html">Executing Time Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../virtualization/index.html">Virtualization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../guides/index.html">User and Developer Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../security/index.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../samples/index.html">Samples and Demos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../boards/index.html">Supported Boards</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../releases/index.html">Release Notes</a></li>
</ul>

  
  <div class="toctree-wrapper compound">
    <p class="caption"><span class="caption-text">Reference</span></p>
    <ul>
      
      <li class="toctree-l1">
        <a class="reference internal" href="/latest/doxygen/html/index.html">API</a>
      </li>
      
      <li class="toctree-l1">
        <a class="reference internal" href="/latest/reference/kconfig/index.html">Kconfig Options</a>
      </li>
      
      <li class="toctree-l1">
        <a class="reference internal" href="/latest/reference/devicetree/bindings.html">Devicetree Bindings</a>
      </li>
      
    </ul>
  </div>
  

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Zephyr Project</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
  <!-- Docs / Latest -->
  
  

  <li><a href="../../../index.html">Docs / Latest</a> &raquo;</li>
  
     <li><a href="../../index.html">API Reference</a> &raquo;</li>
  
     <li><a href="../index.html">Kernel Services</a> &raquo;</li>
  
  <li>Stacks</li>


  <li class="wy-breadcrumbs-aside">
    <dark-mode-toggle id="dark-mode-toggle" appearance="toggle" permanent="true"/>
  </li>
  <li class="wy-breadcrumbs-aside">
      
      
        <a href="https://github.com/zephyrproject-rtos/zephyr/blob/main/doc/reference/kernel/data_passing/stacks.rst" class="fa fa-github"> Open on GitHub</a>
      
    
  </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
  
    <div class="wy-alert wy-alert-danger">
     This is the documentation for the latest (main) development branch of
     Zephyr. If you are looking for the documentation of previous releases, use
     the drop-down menu on the left and select the desired version.
    </div>
  
  
           <div itemprop="articleBody">
             
  <div class="section" id="stacks">
<span id="stacks-v2"></span><h1>Stacks<a class="headerlink" href="#stacks" title="Permalink to this headline">¶</a></h1>
<p>A <em class="dfn">stack</em> is a kernel object that implements a traditional
last in, first out (LIFO) queue, allowing threads and ISRs
to add and remove a limited number of integer data values.</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#concepts" id="id1">Concepts</a></p></li>
<li><p><a class="reference internal" href="#implementation" id="id2">Implementation</a></p>
<ul>
<li><p><a class="reference internal" href="#defining-a-stack" id="id3">Defining a Stack</a></p></li>
<li><p><a class="reference internal" href="#pushing-to-a-stack" id="id4">Pushing to a Stack</a></p></li>
<li><p><a class="reference internal" href="#popping-from-a-stack" id="id5">Popping from a Stack</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#suggested-uses" id="id6">Suggested Uses</a></p></li>
<li><p><a class="reference internal" href="#configuration-options" id="id7">Configuration Options</a></p></li>
<li><p><a class="reference internal" href="#api-reference" id="id8">API Reference</a></p></li>
</ul>
</div>
<div class="section" id="concepts">
<h2><a class="toc-backref" href="#id1">Concepts</a><a class="headerlink" href="#concepts" title="Permalink to this headline">¶</a></h2>
<p>Any number of stacks can be defined (limited only by available RAM). Each stack
is referenced by its memory address.</p>
<p>A stack has the following key properties:</p>
<ul class="simple">
<li><p>A <strong>queue</strong> of integer data values that have been added but not yet removed.
The queue is implemented using an array of stack_data_t values
and must be aligned on a native word boundary.
The stack_data_t type corresponds to the native word size i.e. 32 bits or
64 bits depending on the CPU architecture and compilation mode.</p></li>
<li><p>A <strong>maximum quantity</strong> of data values that can be queued in the array.</p></li>
</ul>
<p>A stack must be initialized before it can be used. This sets its queue to empty.</p>
<p>A data value can be <strong>added</strong> to a stack by a thread or an ISR.
The value is given directly to a waiting thread, if one exists;
otherwise the value is added to the LIFO’s queue.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <a class="reference internal" href="../../kconfig/dummy-syms.html#std-kconfig-CONFIG_NO_RUNTIME_CHECKS"><code class="xref std std-kconfig docutils literal notranslate"><span class="pre">CONFIG_NO_RUNTIME_CHECKS</span></code></a> is enabled, the kernel will <em>not</em> detect
and prevent attempts to add a data value to a stack that has already reached
its maximum quantity of queued values. Adding a data value to a stack that is
already full will result in array overflow, and lead to unpredictable behavior.</p>
</div>
<p>A data value may be <strong>removed</strong> from a stack by a thread.
If the stack’s queue is empty a thread may choose to wait for it to be given.
Any number of threads may wait on an empty stack simultaneously.
When a data item is added, it is given to the highest priority thread
that has waited longest.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The kernel does allow an ISR to remove an item from a stack, however
the ISR must not attempt to wait if the stack is empty.</p>
</div>
</div>
<div class="section" id="implementation">
<h2><a class="toc-backref" href="#id2">Implementation</a><a class="headerlink" href="#implementation" title="Permalink to this headline">¶</a></h2>
<div class="section" id="defining-a-stack">
<h3><a class="toc-backref" href="#id3">Defining a Stack</a><a class="headerlink" href="#defining-a-stack" title="Permalink to this headline">¶</a></h3>
<p>A stack is defined using a variable of type <code class="xref c c-struct docutils literal notranslate"><span class="pre">k_stack</span></code>.
It must then be initialized by calling <a class="reference internal" href="#c.k_stack_init" title="k_stack_init"><code class="xref c c-func docutils literal notranslate"><span class="pre">k_stack_init()</span></code></a> or
<a class="reference internal" href="#c.k_stack_alloc_init" title="k_stack_alloc_init"><code class="xref c c-func docutils literal notranslate"><span class="pre">k_stack_alloc_init()</span></code></a>. In the latter case, a buffer is not
provided and it is instead allocated from the calling thread’s resource
pool.</p>
<p>The following code defines and initializes an empty stack capable of holding
up to ten word-sized data values.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#define MAX_ITEMS 10</span>

<span class="n">stack_data_t</span><span class="w"> </span><span class="n">my_stack_array</span><span class="p">[</span><span class="n">MAX_ITEMS</span><span class="p">];</span><span class="w"></span>
<span class="k">struct</span><span class="w"> </span><span class="nc">k_stack</span><span class="w"> </span><span class="n">my_stack</span><span class="p">;</span><span class="w"></span>

<span class="n">k_stack_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">my_stack</span><span class="p">,</span><span class="w"> </span><span class="n">my_stack_array</span><span class="p">,</span><span class="w"> </span><span class="n">MAX_ITEMS</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>Alternatively, a stack can be defined and initialized at compile time
by calling <a class="reference internal" href="#c.K_STACK_DEFINE" title="K_STACK_DEFINE"><code class="xref c c-macro docutils literal notranslate"><span class="pre">K_STACK_DEFINE</span></code></a>.</p>
<p>The following code has the same effect as the code segment above. Observe
that the macro defines both the stack and its array of data values.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">K_STACK_DEFINE</span><span class="p">(</span><span class="n">my_stack</span><span class="p">,</span><span class="w"> </span><span class="n">MAX_ITEMS</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="pushing-to-a-stack">
<h3><a class="toc-backref" href="#id4">Pushing to a Stack</a><a class="headerlink" href="#pushing-to-a-stack" title="Permalink to this headline">¶</a></h3>
<p>A data item is added to a stack by calling <a class="reference internal" href="#c.k_stack_push" title="k_stack_push"><code class="xref c c-func docutils literal notranslate"><span class="pre">k_stack_push()</span></code></a>.</p>
<p>The following code builds on the example above, and shows how a thread
can create a pool of data structures by saving their memory addresses
in a stack.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* define array of data structures */</span><span class="w"></span>
<span class="k">struct</span><span class="w"> </span><span class="nc">my_buffer_type</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">field1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">...</span><span class="w"></span>
<span class="w">    </span><span class="p">};</span><span class="w"></span>
<span class="k">struct</span><span class="w"> </span><span class="nc">my_buffer_type</span><span class="w"> </span><span class="n">my_buffers</span><span class="p">[</span><span class="n">MAX_ITEMS</span><span class="p">];</span><span class="w"></span>

<span class="cm">/* save address of each data structure in a stack */</span><span class="w"></span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">MAX_ITEMS</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">k_stack_push</span><span class="p">(</span><span class="o">&amp;</span><span class="n">my_stack</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">stack_data_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">my_buffers</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="popping-from-a-stack">
<h3><a class="toc-backref" href="#id5">Popping from a Stack</a><a class="headerlink" href="#popping-from-a-stack" title="Permalink to this headline">¶</a></h3>
<p>A data item is taken from a stack by calling <a class="reference internal" href="#c.k_stack_pop" title="k_stack_pop"><code class="xref c c-func docutils literal notranslate"><span class="pre">k_stack_pop()</span></code></a>.</p>
<p>The following code builds on the example above, and shows how a thread
can dynamically allocate an unused data structure.
When the data structure is no longer required, the thread must push
its address back on the stack to allow the data structure to be reused.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span><span class="w"> </span><span class="nc">my_buffer_type</span><span class="w"> </span><span class="o">*</span><span class="n">new_buffer</span><span class="p">;</span><span class="w"></span>

<span class="n">k_stack_pop</span><span class="p">(</span><span class="o">&amp;</span><span class="n">buffer_stack</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">stack_data_t</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">new_buffer</span><span class="p">,</span><span class="w"> </span><span class="n">K_FOREVER</span><span class="p">);</span><span class="w"></span>
<span class="n">new_buffer</span><span class="o">-&gt;</span><span class="n">field1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="suggested-uses">
<h2><a class="toc-backref" href="#id6">Suggested Uses</a><a class="headerlink" href="#suggested-uses" title="Permalink to this headline">¶</a></h2>
<p>Use a stack to store and retrieve integer data values in a “last in,
first out” manner, when the maximum number of stored items is known.</p>
</div>
<div class="section" id="configuration-options">
<h2><a class="toc-backref" href="#id7">Configuration Options</a><a class="headerlink" href="#configuration-options" title="Permalink to this headline">¶</a></h2>
<p>Related configuration options:</p>
<ul class="simple">
<li><p>None.</p></li>
</ul>
</div>
<div class="section" id="api-reference">
<h2><a class="toc-backref" href="#id8">API Reference</a><a class="headerlink" href="#api-reference" title="Permalink to this headline">¶</a></h2>
<dl>
<dt class="sig sig-object cpp">
<span class="target" id="group__stack__apis"></span><em><span class="pre">group</span></em> <span class="sig-name descname"><span class="pre">stack_apis</span></span></dt>
<dd><div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-defines">Defines</p>
<dl class="c macro">
<dt class="sig sig-object c" id="c.K_STACK_DEFINE">
<span class="target" id="group__stack__apis_1ga8c9ca77e5de3c9757dcd4ecb55797835"></span><span class="sig-name descname"><span class="n"><span class="pre">K_STACK_DEFINE</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">name</span></span>, <span class="n"><span class="pre">stack_num_entries</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.K_STACK_DEFINE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Statically define and initialize a stack. </p>
<p>The stack can be accessed outside the module where it is defined using:</p>
<p><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">extern</span> <span class="n">struct</span> <span class="n">k_stack</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="p">;</span> 
</pre></div>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – Name of the stack. </p></li>
<li><p><strong>stack_num_entries</strong> – Maximum number of values that can be stacked. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.k_stack_init">
<span class="target" id="group__stack__apis_1ga4400a39ef48289305cf66a092d5c6c7d"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">k_stack_init</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">k_stack</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">stack</span></span>, <span class="n"><span class="pre">stack_data_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">buffer</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n"><span class="pre">num_entries</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.k_stack_init" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Initialize a stack. </p>
<p>This routine initializes a stack object, prior to its first use.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stack</strong> – Address of the stack. </p></li>
<li><p><strong>buffer</strong> – Address of array used to hold stacked values. </p></li>
<li><p><strong>num_entries</strong> – Maximum number of values that can be stacked. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.k_stack_alloc_init">
<span class="target" id="group__stack__apis_1gab97d924db1aef3f6adade156a107d45c"></span><span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">k_stack_alloc_init</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">k_stack</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">stack</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n"><span class="pre">num_entries</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.k_stack_alloc_init" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Initialize a stack. </p>
<p>This routine initializes a stack object, prior to its first use. Internal buffers will be allocated from the calling thread’s resource pool. This memory will be released if <a class="reference internal" href="#group__stack__apis_1ga819f4e7b2cf11cf2e1b80933fdcb67ea"><span class="std std-ref">k_stack_cleanup()</span></a> is called, or userspace is enabled and the stack object loses all references to it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stack</strong> – Address of the stack. </p></li>
<li><p><strong>num_entries</strong> – Maximum number of values that can be stacked.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>-ENOMEM if memory couldn’t be allocated </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.k_stack_cleanup">
<span class="target" id="group__stack__apis_1ga819f4e7b2cf11cf2e1b80933fdcb67ea"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">k_stack_cleanup</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">k_stack</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">stack</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.k_stack_cleanup" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Release a stack’s allocated buffer. </p>
<p>If a stack object was given a dynamically allocated buffer via <a class="reference internal" href="#group__stack__apis_1gab97d924db1aef3f6adade156a107d45c"><span class="std std-ref">k_stack_alloc_init()</span></a>, this will free it. This function does nothing if the buffer wasn’t dynamically allocated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stack</strong> – Address of the stack. </p></li>
</ul>
</dd>
<dt class="field-even">Return values</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>0</strong> – on success </p></li>
<li><p><strong>-EAGAIN</strong> – when object is still in use </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.k_stack_push">
<span class="target" id="group__stack__apis_1gaa6180f4db6ec93ee84149cba054d3e53"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">k_stack_push</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">k_stack</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">stack</span></span>, <span class="n"><span class="pre">stack_data_t</span></span><span class="w"> </span><span class="n"><span class="pre">data</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.k_stack_push" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Push an element onto a stack. </p>
<p>This routine adds a stack_data_t value <em>data</em> to <em>stack</em>.</p>
<p><dl class="simple">
<dt><strong>Function properties (list may not be complete)</strong></dt><dd><p><span> <a class="reference internal" href="../../api/terminology.html#api-term-isr-ok"><span class="std std-ref">isr-ok</span></a></span> </p>
</dd>
</dl>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stack</strong> – Address of the stack. </p></li>
<li><p><strong>data</strong> – Value to push onto the stack.</p></li>
</ul>
</dd>
<dt class="field-even">Return values</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>0</strong> – on success </p></li>
<li><p><strong>-ENOMEM</strong> – if stack is full </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.k_stack_pop">
<span class="target" id="group__stack__apis_1ga36ce6ceb9ea3d5c36d22b10430789480"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">k_stack_pop</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">k_stack</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">stack</span></span>, <span class="n"><span class="pre">stack_data_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span>, <a class="reference internal" href="../timing/clocks.html#c.k_timeout_t" title="k_timeout_t"><span class="n"><span class="pre">k_timeout_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">timeout</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.k_stack_pop" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Pop an element from a stack. </p>
<p>This routine removes a stack_data_t value from <em>stack</em><p>in a “last in,</p>
<p>first out” manner and stores the value in</p>
<em>data</em>.</p>
<p><dl class="simple">
<dt><strong>Function properties (list may not be complete)</strong></dt><dd><p><span> <a class="reference internal" href="../../api/terminology.html#api-term-isr-ok"><span class="std std-ref">isr-ok</span></a></span> </p>
</dd>
</dl>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><em>timeout</em> must be set to K_NO_WAIT if called from ISR.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stack</strong> – Address of the stack. </p></li>
<li><p><strong>data</strong> – Address of area to hold the value popped from the stack. </p></li>
<li><p><strong>timeout</strong> – Waiting period to obtain a value, or one of the special values K_NO_WAIT and K_FOREVER.</p></li>
</ul>
</dd>
<dt class="field-even">Return values</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>0</strong> – Element popped from stack. </p></li>
<li><p><strong>-EBUSY</strong> – Returned without waiting. </p></li>
<li><p><strong>-EAGAIN</strong> – Waiting period timed out. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
</dd></dl>

</div>
</div>


           </div>
          </div>

          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; <a href="../../../copyright.html">Copyright</a> 2015-2021 Zephyr Project members and individual contributors.
      <span class="lastupdated">Last updated on Feb 21, 2022.
      </span></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>