<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pipes &mdash; Zephyr Project Documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/custom.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/tabs.css" type="text/css" />
    <link rel="shortcut icon" href="../../../_static/favicon.png"/>
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script type="module" src="../../../_static/js/dark-mode-toggle.min.mjs"></script>
        <script src="https://www.googletagmanager.com/gtag/js?id=UA-831873-47"></script>
        <script src="../../../_static/js/ga-tracker.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="copyright" title="Copyright" href="../../../copyright.html" />
    <link rel="next" title="Memory Heaps" href="../memory/heap.html" />
    <link rel="prev" title="Mailboxes" href="mailboxes.html" />
  <meta name="color-scheme" content="dark light">
  
  <link rel="stylesheet" href="../../../_static/css/light.css" type="text/css" media="(prefers-color-scheme: light)"/>
  <link rel="stylesheet" href="../../../_static/css/dark.css" type="text/css" media="(prefers-color-scheme: dark)"/>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html">
            <img src="../../../_static/logo.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                3.0.0-rc3
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
  
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Zephyr Project</span>
      v: latest
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        <dt>Document Release Versions</dt>
        
          <dd><a href="/">latest</a></dd>
        
          <dd><a href="/2.7.0/">2.7.0</a></dd>
        
          <dd><a href="/2.6.0/">2.6.0</a></dd>
        
          <dd><a href="/2.5.0/">2.5.0</a></dd>
        
          <dd><a href="/2.4.0/">2.4.0</a></dd>
        
          <dd><a href="/2.3.0/">2.3.0</a></dd>
        
          <dd><a href="/1.14.1/">1.14.1</a></dd>
        
      </dl>
      <dl>
        <dt>Downloads</dt>
        
        <dd><a href="/latest/zephyr.pdf">PDF</a></dd>
      </dl>
      <dl>
        <dt>zephyrproject.org Links</dt>
          <dd>
            <a href="https://www.zephyrproject.org/">Project Home</a>
          </dd>
          <dd>
            <a href="https://github.com/zephyrproject-rtos/sdk-ng/releases">SDK</a>
          </dd>
          <dd>
            <a href="https://github.com/zephyrproject-rtos/zephyr/releases">Releases</a>
          </dd>
      </dl>
    </div>
  </div>
  
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started/index.html">Getting Started Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contribute/index.html">Contribution Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../development_process/index.html">Development and Contribution Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../guides/build/index.html">Build and Configuration Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../application/index.html">Application Development</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../api/index.html">API Status and Guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../audio/index.html">Audio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../misc/notify.html">Asynchronous Notifications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../bluetooth/index.html">Bluetooth</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../canbus/index.html">Controller Area Network (CAN)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../crypto/index.html">Crypto</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../devicetree/index.html">Devicetree</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../drivers/index.html">Device Driver Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../display/index.html">Display Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../edac/index.html">Error Detection And Correction (EDAC)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../file_system/index.html">File Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../iterable_sections/index.html">Iterable Sections</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../misc/formatted_output.html">Formatted Output</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Kernel Services</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../index.html#scheduling-interrupts-and-synchronization">Scheduling, Interrupts, and Synchronization</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../index.html#data-passing">Data Passing</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="queues.html">Queues</a></li>
<li class="toctree-l4"><a class="reference internal" href="fifos.html">FIFOs</a></li>
<li class="toctree-l4"><a class="reference internal" href="lifos.html">LIFOs</a></li>
<li class="toctree-l4"><a class="reference internal" href="stacks.html">Stacks</a></li>
<li class="toctree-l4"><a class="reference internal" href="message_queues.html">Message Queues</a></li>
<li class="toctree-l4"><a class="reference internal" href="mailboxes.html">Mailboxes</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Pipes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#memory-management">Memory Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#timing">Timing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#other">Other</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../libc/index.html">C standard library</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../logging/index.html">Logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../memory_management/index.html">Memory Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../misc/index.html">Miscellaneous</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../data_structures/index.html">Data Structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../modbus/index.html">Modbus</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../networking/index.html">Networking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../peripherals/index.html">Peripherals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../pinctrl/index.html">Pin Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../pm/index.html">Power Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../random/index.html">Random Number Generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../resource_management/index.html">Resource Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../shell/index.html">Shell</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../storage/index.html">Storage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../task_wdt/index.html">Task Watchdog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../misc/timeutil.html">Time Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usb/index.html">USB device support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usermode/index.html">User Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../util/index.html">Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../settings/index.html">Settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../timing_functions/index.html">Executing Time Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../virtualization/index.html">Virtualization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../guides/index.html">User and Developer Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../security/index.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../samples/index.html">Samples and Demos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../boards/index.html">Supported Boards</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../releases/index.html">Release Notes</a></li>
</ul>

  
  <div class="toctree-wrapper compound">
    <p class="caption"><span class="caption-text">Reference</span></p>
    <ul>
      
      <li class="toctree-l1">
        <a class="reference internal" href="/latest/doxygen/html/index.html">API</a>
      </li>
      
      <li class="toctree-l1">
        <a class="reference internal" href="/latest/reference/kconfig/index.html">Kconfig Options</a>
      </li>
      
      <li class="toctree-l1">
        <a class="reference internal" href="/latest/reference/devicetree/bindings.html">Devicetree Bindings</a>
      </li>
      
    </ul>
  </div>
  

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Zephyr Project</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
  <!-- Docs / Latest -->
  
  

  <li><a href="../../../index.html">Docs / Latest</a> &raquo;</li>
  
     <li><a href="../../index.html">API Reference</a> &raquo;</li>
  
     <li><a href="../index.html">Kernel Services</a> &raquo;</li>
  
  <li>Pipes</li>


  <li class="wy-breadcrumbs-aside">
    <dark-mode-toggle id="dark-mode-toggle" appearance="toggle" permanent="true"/>
  </li>
  <li class="wy-breadcrumbs-aside">
      
      
        <a href="https://github.com/zephyrproject-rtos/zephyr/blob/main/doc/reference/kernel/data_passing/pipes.rst" class="fa fa-github"> Open on GitHub</a>
      
    
  </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
  
    <div class="wy-alert wy-alert-danger">
     This is the documentation for the latest (main) development branch of
     Zephyr. If you are looking for the documentation of previous releases, use
     the drop-down menu on the left and select the desired version.
    </div>
  
  
           <div itemprop="articleBody">
             
  <div class="section" id="pipes">
<span id="pipes-v2"></span><h1>Pipes<a class="headerlink" href="#pipes" title="Permalink to this headline">¶</a></h1>
<p>A <em class="dfn">pipe</em> is a kernel object that allows a thread to send a byte stream
to another thread. Pipes can be used to synchronously transfer chunks of data
in whole or in part.</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#concepts" id="id1">Concepts</a></p></li>
<li><p><a class="reference internal" href="#implementation" id="id2">Implementation</a></p>
<ul>
<li><p><a class="reference internal" href="#writing-to-a-pipe" id="id3">Writing to a Pipe</a></p></li>
<li><p><a class="reference internal" href="#reading-from-a-pipe" id="id4">Reading from a Pipe</a></p></li>
<li><p><a class="reference internal" href="#flushing-a-pipe-s-buffer" id="id5">Flushing a Pipe’s Buffer</a></p></li>
<li><p><a class="reference internal" href="#flushing-a-pipe" id="id6">Flushing a Pipe</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#suggested-uses" id="id7">Suggested uses</a></p></li>
<li><p><a class="reference internal" href="#configuration-options" id="id8">Configuration Options</a></p></li>
<li><p><a class="reference internal" href="#api-reference" id="id9">API Reference</a></p></li>
</ul>
</div>
<div class="section" id="concepts">
<h2><a class="toc-backref" href="#id1">Concepts</a><a class="headerlink" href="#concepts" title="Permalink to this headline">¶</a></h2>
<p>The pipe can be configured with a ring buffer which holds data that has been
sent but not yet received; alternatively, the pipe may have no ring buffer.</p>
<p>Any number of pipes can be defined (limited only by available RAM). Each pipe is
referenced by its memory address.</p>
<p>A pipe has the following key property:</p>
<ul class="simple">
<li><p>A <strong>size</strong> that indicates the size of the pipe’s ring buffer. Note that a
size of zero defines a pipe with no ring buffer.</p></li>
</ul>
<p>A pipe must be initialized before it can be used. The pipe is initially empty.</p>
<p>Data is synchronously <strong>sent</strong> either in whole or in part to a pipe by a
thread. If the specified minimum number of bytes can not be immediately
satisfied, then the operation will either fail immediately or attempt to send
as many bytes as possible and then pend in the hope that the send can be
completed later. Accepted data is either copied to the pipe’s ring buffer
or directly to the waiting reader(s).</p>
<p>Data is synchronously <strong>received</strong> from a pipe by a thread. If the specified
minimum number of bytes can not be immediately satisfied, then the operation
will either fail immediately or attempt to receive as many bytes as possible
and then pend in the hope that the receive can be completed later. Accepted
data is either copied from the pipe’s ring buffer or directly from the
waiting sender(s).</p>
<p>Data may also be <strong>flushed</strong> from a pipe by a thread. Flushing can be performed
either on the entire pipe or on only its ring buffer. Flushing the entire pipe
is equivalent to reading all the information in the ring buffer <strong>and</strong> waiting
to be written into a giant temporary buffer which is then discarded. Flushing
the ring buffer is equivalent to reading <strong>only</strong> the data in the ring buffer
into a temporary buffer which is then discarded. Flushing the ring buffer does
not guarantee that the ring buffer will stay empty; flushing it may allow a
pended writer to fill the ring buffer.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Flushing does not in practice allocate or use additional buffers.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The kernel does NOT allow for an ISR to send or receive data to/from a
pipe or flush even if it does not attempt to wait for space/data.</p>
</div>
</div>
<div class="section" id="implementation">
<h2><a class="toc-backref" href="#id2">Implementation</a><a class="headerlink" href="#implementation" title="Permalink to this headline">¶</a></h2>
<p>A pipe is defined using a variable of type <a class="reference internal" href="#c.k_pipe" title="k_pipe"><code class="xref c c-struct docutils literal notranslate"><span class="pre">k_pipe</span></code></a> and an
optional character buffer of type <code class="docutils literal notranslate"><span class="pre">unsigned</span> <span class="pre">char</span></code>. It must then be
initialized by calling <a class="reference internal" href="#c.k_pipe_init" title="k_pipe_init"><code class="xref c c-func docutils literal notranslate"><span class="pre">k_pipe_init()</span></code></a>.</p>
<p>The following code defines and initializes an empty pipe that has a ring
buffer capable of holding 100 bytes and is aligned to a 4-byte boundary.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="nf">__aligned</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="n">my_ring_buffer</span><span class="p">[</span><span class="mi">100</span><span class="p">];</span><span class="w"></span>
<span class="k">struct</span><span class="w"> </span><span class="nc">k_pipe</span><span class="w"> </span><span class="n">my_pipe</span><span class="p">;</span><span class="w"></span>

<span class="n">k_pipe_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">my_pipe</span><span class="p">,</span><span class="w"> </span><span class="n">my_ring_buffer</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">my_ring_buffer</span><span class="p">));</span><span class="w"></span>
</pre></div>
</div>
<p>Alternatively, a pipe can be defined and initialized at compile time by
calling <a class="reference internal" href="#c.K_PIPE_DEFINE" title="K_PIPE_DEFINE"><code class="xref c c-macro docutils literal notranslate"><span class="pre">K_PIPE_DEFINE</span></code></a>.</p>
<p>The following code has the same effect as the code segment above. Observe
that that macro defines both the pipe and its ring buffer.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">K_PIPE_DEFINE</span><span class="p">(</span><span class="n">my_pipe</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<div class="section" id="writing-to-a-pipe">
<h3><a class="toc-backref" href="#id3">Writing to a Pipe</a><a class="headerlink" href="#writing-to-a-pipe" title="Permalink to this headline">¶</a></h3>
<p>Data is added to a pipe by calling <a class="reference internal" href="#c.k_pipe_put" title="k_pipe_put"><code class="xref c c-func docutils literal notranslate"><span class="pre">k_pipe_put()</span></code></a>.</p>
<p>The following code builds on the example above, and uses the pipe to pass
data from a producing thread to one or more consuming threads. If the pipe’s
ring buffer fills up because the consumers can’t keep up, the producing thread
waits for a specified amount of time.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span><span class="w"> </span><span class="nc">message_header</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="p">...</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="kt">void</span><span class="w"> </span><span class="nf">producer_thread</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">data</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">total_size</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">bytes_written</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w">    </span><span class="n">rc</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">...</span><span class="w"></span>

<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="cm">/* Craft message to send in the pipe */</span><span class="w"></span>
<span class="w">        </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...;</span><span class="w"></span>
<span class="w">        </span><span class="n">total_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...;</span><span class="w"></span>

<span class="w">        </span><span class="cm">/* send data to the consumers */</span><span class="w"></span>
<span class="w">        </span><span class="n">rc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k_pipe_put</span><span class="p">(</span><span class="o">&amp;</span><span class="n">my_pipe</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">total_size</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">bytes_written</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">message_header</span><span class="p">),</span><span class="w"> </span><span class="n">K_NO_WAIT</span><span class="p">);</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">rc</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="cm">/* Incomplete message header sent */</span><span class="w"></span>
<span class="w">            </span><span class="p">...</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bytes_written</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">total_size</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="cm">/* Some of the data was sent */</span><span class="w"></span>
<span class="w">            </span><span class="p">...</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="cm">/* All data sent */</span><span class="w"></span>
<span class="w">            </span><span class="p">...</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="reading-from-a-pipe">
<h3><a class="toc-backref" href="#id4">Reading from a Pipe</a><a class="headerlink" href="#reading-from-a-pipe" title="Permalink to this headline">¶</a></h3>
<p>Data is read from the pipe by calling <a class="reference internal" href="#c.k_pipe_get" title="k_pipe_get"><code class="xref c c-func docutils literal notranslate"><span class="pre">k_pipe_get()</span></code></a>.</p>
<p>The following code builds on the example above, and uses the pipe to
process data items generated by one or more producing threads.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">consumer_thread</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">buffer</span><span class="p">[</span><span class="mi">120</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w">   </span><span class="n">bytes_read</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">message_header</span><span class="w">  </span><span class="o">*</span><span class="n">header</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">message_header</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">buffer</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">rc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k_pipe_get</span><span class="p">(</span><span class="o">&amp;</span><span class="n">my_pipe</span><span class="p">,</span><span class="w"> </span><span class="n">buffer</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">buffer</span><span class="p">),</span><span class="w"> </span><span class="o">&amp;</span><span class="n">bytes_read</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="k">sizeof</span><span class="p">(</span><span class="n">header</span><span class="p">),</span><span class="w"> </span><span class="n">K_MSEC</span><span class="p">(</span><span class="mi">100</span><span class="p">));</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">rc</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">(</span><span class="n">bytes_read</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="k">sizeof</span><span class="w"> </span><span class="p">(</span><span class="n">header</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="cm">/* Incomplete message header received */</span><span class="w"></span>
<span class="w">            </span><span class="p">...</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">header</span><span class="o">-&gt;</span><span class="n">num_data_bytes</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">header</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">bytes_read</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="cm">/* Only some data was received */</span><span class="w"></span>
<span class="w">            </span><span class="p">...</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="cm">/* All data was received */</span><span class="w"></span>
<span class="w">            </span><span class="p">...</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>Use a pipe to send streams of data between threads.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A pipe can be used to transfer long streams of data if desired.  However
it is often preferable to send pointers to large data items to avoid
copying the data.</p>
</div>
</div>
<div class="section" id="flushing-a-pipe-s-buffer">
<h3><a class="toc-backref" href="#id5">Flushing a Pipe’s Buffer</a><a class="headerlink" href="#flushing-a-pipe-s-buffer" title="Permalink to this headline">¶</a></h3>
<p>Data is flushed from the pipe’s ring buffer by calling
<a class="reference internal" href="#c.k_pipe_buffer_flush" title="k_pipe_buffer_flush"><code class="xref c c-func docutils literal notranslate"><span class="pre">k_pipe_buffer_flush()</span></code></a>.</p>
<p>The following code builds on the examples above, and flushes the pipe’s
buffer.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">monitor_thread</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="p">...</span><span class="w"></span>
<span class="w">        </span><span class="cm">/* Pipe buffer contains stale data. Flush it. */</span><span class="w"></span>
<span class="w">        </span><span class="n">k_pipe_buffer_flush</span><span class="p">(</span><span class="o">&amp;</span><span class="n">my_pipe</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">...</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="flushing-a-pipe">
<h3><a class="toc-backref" href="#id6">Flushing a Pipe</a><a class="headerlink" href="#flushing-a-pipe" title="Permalink to this headline">¶</a></h3>
<p>All data in the pipe is flushed by calling <a class="reference internal" href="#c.k_pipe_flush" title="k_pipe_flush"><code class="xref c c-func docutils literal notranslate"><span class="pre">k_pipe_flush()</span></code></a>.</p>
<p>The following code builds on the examples above, and flushes all the
data in the pipe.</p>
</div>
</div>
<div class="section" id="suggested-uses">
<h2><a class="toc-backref" href="#id7">Suggested uses</a><a class="headerlink" href="#suggested-uses" title="Permalink to this headline">¶</a></h2>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">monitor_thread</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="p">...</span><span class="w"></span>
<span class="w">        </span><span class="cm">/* Critical error detected. Flush the entire pipe to reset it. */</span><span class="w"></span>
<span class="w">        </span><span class="n">k_pipe_flush</span><span class="p">(</span><span class="o">&amp;</span><span class="n">my_pipe</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">...</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="configuration-options">
<h2><a class="toc-backref" href="#id8">Configuration Options</a><a class="headerlink" href="#configuration-options" title="Permalink to this headline">¶</a></h2>
<p>Related configuration options:</p>
<ul class="simple">
<li><p>None.</p></li>
</ul>
</div>
<div class="section" id="api-reference">
<h2><a class="toc-backref" href="#id9">API Reference</a><a class="headerlink" href="#api-reference" title="Permalink to this headline">¶</a></h2>
<dl>
<dt class="sig sig-object cpp">
<span class="target" id="group__pipe__apis"></span><em><span class="pre">group</span></em> <span class="sig-name descname"><span class="pre">pipe_apis</span></span></dt>
<dd><div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-defines">Defines</p>
<dl class="c macro">
<dt class="sig sig-object c" id="c.K_PIPE_DEFINE">
<span class="target" id="group__pipe__apis_1gac2256aa00c59e78199be9bdefd61aa52"></span><span class="sig-name descname"><span class="n"><span class="pre">K_PIPE_DEFINE</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">name</span></span>, <span class="n"><span class="pre">pipe_buffer_size</span></span>, <span class="n"><span class="pre">pipe_align</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.K_PIPE_DEFINE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Statically define and initialize a pipe. </p>
<p>The pipe can be accessed outside the module where it is defined using:</p>
<p><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">extern</span> <span class="n">struct</span> <span class="n">k_pipe</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="p">;</span> 
</pre></div>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – Name of the pipe. </p></li>
<li><p><strong>pipe_buffer_size</strong> – Size of the pipe’s ring buffer (in bytes), or zero if no ring buffer is used. </p></li>
<li><p><strong>pipe_align</strong> – Alignment of the pipe’s ring buffer (power of 2). </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.k_pipe_init">
<span class="target" id="group__pipe__apis_1gae9e807fb63bb7186b87015664f2c762d"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">k_pipe_init</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.k_pipe" title="k_pipe"><span class="n"><span class="pre">k_pipe</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">pipe</span></span>, <span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">buffer</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">size</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.k_pipe_init" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Initialize a pipe. </p>
<p>This routine initializes a pipe object, prior to its first use.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pipe</strong> – Address of the pipe. </p></li>
<li><p><strong>buffer</strong> – Address of the pipe’s ring buffer, or NULL if no ring buffer is used. </p></li>
<li><p><strong>size</strong> – Size of the pipe’s ring buffer (in bytes), or zero if no ring buffer is used. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.k_pipe_cleanup">
<span class="target" id="group__pipe__apis_1gaad0ab1b97b537da408031e4bcbe04f36"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">k_pipe_cleanup</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.k_pipe" title="k_pipe"><span class="n"><span class="pre">k_pipe</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">pipe</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.k_pipe_cleanup" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Release a pipe’s allocated buffer. </p>
<p>If a pipe object was given a dynamically allocated buffer via <a class="reference internal" href="#group__pipe__apis_1ga32a902a5d12ca54b17c2b58783214613"><span class="std std-ref">k_pipe_alloc_init()</span></a>, this will free it. This function does nothing if the buffer wasn’t dynamically allocated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pipe</strong> – Address of the pipe. </p></li>
</ul>
</dd>
<dt class="field-even">Return values</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>0</strong> – on success </p></li>
<li><p><strong>-EAGAIN</strong> – nothing to cleanup </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.k_pipe_alloc_init">
<span class="target" id="group__pipe__apis_1ga32a902a5d12ca54b17c2b58783214613"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">k_pipe_alloc_init</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.k_pipe" title="k_pipe"><span class="n"><span class="pre">k_pipe</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">pipe</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">size</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.k_pipe_alloc_init" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Initialize a pipe and allocate a buffer for it. </p>
<p>Storage for the buffer region will be allocated from the calling thread’s resource pool. This memory will be released if <a class="reference internal" href="#group__pipe__apis_1gaad0ab1b97b537da408031e4bcbe04f36"><span class="std std-ref">k_pipe_cleanup()</span></a> is called, or userspace is enabled and the pipe object loses all references to it.</p>
<p>This function should only be called on uninitialized pipe objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pipe</strong> – Address of the pipe. </p></li>
<li><p><strong>size</strong> – Size of the pipe’s ring buffer (in bytes), or zero if no ring buffer is used. </p></li>
</ul>
</dd>
<dt class="field-even">Return values</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>0</strong> – on success </p></li>
<li><p><strong>-ENOMEM</strong> – if memory couldn’t be allocated </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.k_pipe_put">
<span class="target" id="group__pipe__apis_1ga5cfd4b75485c7d69f8614030914ad132"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">k_pipe_put</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.k_pipe" title="k_pipe"><span class="n"><span class="pre">k_pipe</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">pipe</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">bytes_to_write</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">bytes_written</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">min_xfer</span></span>, <a class="reference internal" href="../timing/clocks.html#c.k_timeout_t" title="k_timeout_t"><span class="n"><span class="pre">k_timeout_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">timeout</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.k_pipe_put" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Write data to a pipe. </p>
<p>This routine writes up to <em>bytes_to_write</em> bytes of data to <em>pipe</em>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pipe</strong> – Address of the pipe. </p></li>
<li><p><strong>data</strong> – Address of data to write. </p></li>
<li><p><strong>bytes_to_write</strong> – Size of data (in bytes). </p></li>
<li><p><strong>bytes_written</strong> – Address of area to hold the number of bytes written. </p></li>
<li><p><strong>min_xfer</strong> – Minimum number of bytes to write. </p></li>
<li><p><strong>timeout</strong> – Waiting period to wait for the data to be written, or one of the special values K_NO_WAIT and K_FOREVER.</p></li>
</ul>
</dd>
<dt class="field-even">Return values</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>0</strong> – At least <em>min_xfer</em> bytes of data were written. </p></li>
<li><p><strong>-EIO</strong> – Returned without waiting; zero data bytes were written. </p></li>
<li><p><strong>-EAGAIN</strong> – Waiting period timed out; between zero and <em>min_xfer</em> minus one data bytes were written. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.k_pipe_get">
<span class="target" id="group__pipe__apis_1gada9aaf9a336d98a95441212f4223e9ef"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">k_pipe_get</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.k_pipe" title="k_pipe"><span class="n"><span class="pre">k_pipe</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">pipe</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">bytes_to_read</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">bytes_read</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">min_xfer</span></span>, <a class="reference internal" href="../timing/clocks.html#c.k_timeout_t" title="k_timeout_t"><span class="n"><span class="pre">k_timeout_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">timeout</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.k_pipe_get" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Read data from a pipe. </p>
<p>This routine reads up to <em>bytes_to_read</em> bytes of data from <em>pipe</em>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pipe</strong> – Address of the pipe. </p></li>
<li><p><strong>data</strong> – Address to place the data read from pipe. </p></li>
<li><p><strong>bytes_to_read</strong> – Maximum number of data bytes to read. </p></li>
<li><p><strong>bytes_read</strong> – Address of area to hold the number of bytes read. </p></li>
<li><p><strong>min_xfer</strong> – Minimum number of data bytes to read. </p></li>
<li><p><strong>timeout</strong> – Waiting period to wait for the data to be read, or one of the special values K_NO_WAIT and K_FOREVER.</p></li>
</ul>
</dd>
<dt class="field-even">Return values</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>0</strong> – At least <em>min_xfer</em> bytes of data were read. </p></li>
<li><p><strong>-EINVAL</strong> – invalid parameters supplied </p></li>
<li><p><strong>-EIO</strong> – Returned without waiting; zero data bytes were read. </p></li>
<li><p><strong>-EAGAIN</strong> – Waiting period timed out; between zero and <em>min_xfer</em> minus one data bytes were read. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.k_pipe_read_avail">
<span class="target" id="group__pipe__apis_1ga21849ebf856532de6e3ea38489071220"></span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">k_pipe_read_avail</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.k_pipe" title="k_pipe"><span class="n"><span class="pre">k_pipe</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">pipe</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.k_pipe_read_avail" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Query the number of bytes that may be read from <em>pipe</em>. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pipe</strong> – Address of the pipe.</p></li>
</ul>
</dd>
<dt class="field-even">Return values</dt>
<dd class="field-even"><p><strong>a</strong> – number n such that 0 &lt;= n &lt;= <a class="reference internal" href="#structk__pipe_1aca3472fb8d68f01af4e26b0b88736d64"><span class="std std-ref">k_pipe::size</span></a>; the result is zero for unbuffered pipes. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.k_pipe_write_avail">
<span class="target" id="group__pipe__apis_1gaff3ed3e93591d72c60a3640d195998c3"></span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">k_pipe_write_avail</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.k_pipe" title="k_pipe"><span class="n"><span class="pre">k_pipe</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">pipe</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.k_pipe_write_avail" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Query the number of bytes that may be written to <em>pipe</em>. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pipe</strong> – Address of the pipe.</p></li>
</ul>
</dd>
<dt class="field-even">Return values</dt>
<dd class="field-even"><p><strong>a</strong> – number n such that 0 &lt;= n &lt;= <a class="reference internal" href="#structk__pipe_1aca3472fb8d68f01af4e26b0b88736d64"><span class="std std-ref">k_pipe::size</span></a>; the result is zero for unbuffered pipes. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.k_pipe_flush">
<span class="target" id="group__pipe__apis_1ga41484bb5c7dcd97e7a7b7f1422f8026f"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">k_pipe_flush</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.k_pipe" title="k_pipe"><span class="n"><span class="pre">k_pipe</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">pipe</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.k_pipe_flush" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Flush the pipe of write data. </p>
<p>This routine flushes the pipe. Flushing the pipe is equivalent to reading both all the data in the pipe’s buffer and all the data waiting to go into that pipe into a large temporary buffer and discarding the buffer. Any writers that were previously pended become unpended.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pipe</strong> – Address of the pipe.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>N/A </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.k_pipe_buffer_flush">
<span class="target" id="group__pipe__apis_1ga71e0e38a15fa27f27c1f028223936445"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">k_pipe_buffer_flush</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.k_pipe" title="k_pipe"><span class="n"><span class="pre">k_pipe</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">pipe</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.k_pipe_buffer_flush" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Flush the pipe’s internal buffer. </p>
<p>This routine flushes the pipe’s internal buffer. This is equivalent to reading up to N bytes from the pipe (where N is the size of the pipe’s buffer) into a temporary buffer and then discarding that buffer. If there were writers previously pending, then some may unpend as they try to fill up the pipe’s emptied buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pipe</strong> – Address of the pipe.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>N/A </p>
</dd>
</dl>
</dd></dl>

</div>
<dl class="c struct">
<dt class="sig sig-object c" id="c.k_pipe">
<span class="target" id="structk__pipe"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">k_pipe</span></span></span><a class="headerlink" href="#c.k_pipe" title="Permalink to this definition">¶</a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;kernel.h&gt;</em></div>
<p>Pipe Structure </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="c var">
<dt class="sig sig-object c" id="c.k_pipe.buffer">
<span class="target" id="structk__pipe_1acb78995d6b7df28a5452f5d2e88b4dfb"></span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">buffer</span></span></span><a class="headerlink" href="#c.k_pipe.buffer" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Pipe buffer: may be NULL </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.k_pipe.size">
<span class="target" id="structk__pipe_1aca3472fb8d68f01af4e26b0b88736d64"></span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">size</span></span></span><a class="headerlink" href="#c.k_pipe.size" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Buffer size </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.k_pipe.bytes_used">
<span class="target" id="structk__pipe_1a91bedad65285546734b8724811dc6eb8"></span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">bytes_used</span></span></span><a class="headerlink" href="#c.k_pipe.bytes_used" title="Permalink to this definition">¶</a><br /></dt>
<dd><div class="section" id="structk__pipe_1autotoc_md3">
<h3>bytes used in buffer<a class="headerlink" href="#structk__pipe_1autotoc_md3" title="Permalink to this headline">¶</a></h3>
<span class="target" id="structk__pipe_1autotoc_md3"></span></div>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.k_pipe.read_index">
<span class="target" id="structk__pipe_1ae40f81d9c1459fa42f179cbc728aadd0"></span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">read_index</span></span></span><a class="headerlink" href="#c.k_pipe.read_index" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Where in buffer to read from </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.k_pipe.write_index">
<span class="target" id="structk__pipe_1a8f46bd01da0e52e4ee918d9ebe6ad739"></span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">write_index</span></span></span><a class="headerlink" href="#c.k_pipe.write_index" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Where in buffer to write </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.k_pipe.lock">
<span class="target" id="structk__pipe_1aa2a367a9c8f0be89bcdf1bf6d3b0b875"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="../smp/smp.html#c.k_spinlock" title="k_spinlock"><span class="n"><span class="pre">k_spinlock</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">lock</span></span></span><a class="headerlink" href="#c.k_pipe.lock" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Synchronization lock </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.k_pipe.readers">
<span class="target" id="structk__pipe_1a81ab4435d9ca7e5246164fc4fcd9ad59"></span><span class="n"><span class="pre">_wait_q_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">readers</span></span></span><a class="headerlink" href="#c.k_pipe.readers" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Reader wait queue </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.k_pipe.writers">
<span class="target" id="structk__pipe_1ac61ce23d990cf4cef44a1ecfc5047ccc"></span><span class="n"><span class="pre">_wait_q_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">writers</span></span></span><a class="headerlink" href="#c.k_pipe.writers" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Writer wait queue </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.k_pipe.flags">
<span class="target" id="structk__pipe_1a2ed95fbe24ea20c4f292a66def1d4dde"></span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">flags</span></span></span><a class="headerlink" href="#c.k_pipe.flags" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Wait queue Flags </p>
</dd></dl>

</div>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
          </div>

          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; <a href="../../../copyright.html">Copyright</a> 2015-2021 Zephyr Project members and individual contributors.
      <span class="lastupdated">Last updated on Feb 21, 2022.
      </span></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>