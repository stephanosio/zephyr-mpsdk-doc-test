<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Settings &mdash; Zephyr Project Documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/tabs.css" type="text/css" />
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script type="module" src="../../_static/js/dark-mode-toggle.min.mjs"></script>
        <script src="https://www.googletagmanager.com/gtag/js?id=UA-831873-47"></script>
        <script src="../../_static/js/ga-tracker.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="copyright" title="Copyright" href="../../copyright.html" />
    <link rel="next" title="Executing Time Functions" href="../timing_functions/index.html" />
    <link rel="prev" title="Utilities" href="../util/index.html" />
  <meta name="color-scheme" content="dark light">
  
  <link rel="stylesheet" href="../../_static/css/light.css" type="text/css" media="(prefers-color-scheme: light)"/>
  <link rel="stylesheet" href="../../_static/css/dark.css" type="text/css" media="(prefers-color-scheme: dark)"/>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html">
            <img src="../../_static/logo.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                3.0.0-rc3
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
  
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Zephyr Project</span>
      v: latest
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        <dt>Document Release Versions</dt>
        
          <dd><a href="/">latest</a></dd>
        
          <dd><a href="/2.7.0/">2.7.0</a></dd>
        
          <dd><a href="/2.6.0/">2.6.0</a></dd>
        
          <dd><a href="/2.5.0/">2.5.0</a></dd>
        
          <dd><a href="/2.4.0/">2.4.0</a></dd>
        
          <dd><a href="/2.3.0/">2.3.0</a></dd>
        
          <dd><a href="/1.14.1/">1.14.1</a></dd>
        
      </dl>
      <dl>
        <dt>Downloads</dt>
        
        <dd><a href="/latest/zephyr.pdf">PDF</a></dd>
      </dl>
      <dl>
        <dt>zephyrproject.org Links</dt>
          <dd>
            <a href="https://www.zephyrproject.org/">Project Home</a>
          </dd>
          <dd>
            <a href="https://github.com/zephyrproject-rtos/sdk-ng/releases">SDK</a>
          </dd>
          <dd>
            <a href="https://github.com/zephyrproject-rtos/zephyr/releases">Releases</a>
          </dd>
      </dl>
    </div>
  </div>
  
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started/index.html">Getting Started Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contribute/index.html">Contribution Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development_process/index.html">Development and Contribution Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../guides/build/index.html">Build and Configuration Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../application/index.html">Application Development</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../api/index.html">API Status and Guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../audio/index.html">Audio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../misc/notify.html">Asynchronous Notifications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bluetooth/index.html">Bluetooth</a></li>
<li class="toctree-l2"><a class="reference internal" href="../canbus/index.html">Controller Area Network (CAN)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../crypto/index.html">Crypto</a></li>
<li class="toctree-l2"><a class="reference internal" href="../devicetree/index.html">Devicetree</a></li>
<li class="toctree-l2"><a class="reference internal" href="../drivers/index.html">Device Driver Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../display/index.html">Display Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../edac/index.html">Error Detection And Correction (EDAC)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../file_system/index.html">File Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iterable_sections/index.html">Iterable Sections</a></li>
<li class="toctree-l2"><a class="reference internal" href="../misc/formatted_output.html">Formatted Output</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kernel/index.html">Kernel Services</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libc/index.html">C standard library</a></li>
<li class="toctree-l2"><a class="reference internal" href="../logging/index.html">Logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../memory_management/index.html">Memory Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../misc/index.html">Miscellaneous</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data_structures/index.html">Data Structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modbus/index.html">Modbus</a></li>
<li class="toctree-l2"><a class="reference internal" href="../networking/index.html">Networking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../peripherals/index.html">Peripherals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pinctrl/index.html">Pin Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pm/index.html">Power Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../random/index.html">Random Number Generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../resource_management/index.html">Resource Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shell/index.html">Shell</a></li>
<li class="toctree-l2"><a class="reference internal" href="../storage/index.html">Storage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../task_wdt/index.html">Task Watchdog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../misc/timeutil.html">Time Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../usb/index.html">USB device support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../usermode/index.html">User Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../util/index.html">Utilities</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Settings</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#handlers">Handlers</a></li>
<li class="toctree-l3"><a class="reference internal" href="#backends">Backends</a></li>
<li class="toctree-l3"><a class="reference internal" href="#zephyr-storage-backends">Zephyr Storage Backends</a></li>
<li class="toctree-l3"><a class="reference internal" href="#loading-data-from-persisted-storage">Loading data from persisted storage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#storing-data-to-persistent-storage">Storing data to persistent storage</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#garbage-collection">Garbage collection</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#secure-domain-settings">Secure domain settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-device-configuration">Example: Device Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-persist-runtime-state">Example: Persist Runtime State</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-custom-backend-implementation">Example: Custom Backend Implementation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#api-reference">API Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#api-for-general-settings-usage">API for general settings usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#api-for-key-name-processing">API for key-name processing</a></li>
<li class="toctree-l4"><a class="reference internal" href="#api-for-runtime-settings-manipulation">API for runtime settings manipulation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#api-of-backend-interface">API of backend interface</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../timing_functions/index.html">Executing Time Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../virtualization/index.html">Virtualization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../guides/index.html">User and Developer Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../security/index.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../samples/index.html">Samples and Demos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../boards/index.html">Supported Boards</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../releases/index.html">Release Notes</a></li>
</ul>

  
  <div class="toctree-wrapper compound">
    <p class="caption"><span class="caption-text">Reference</span></p>
    <ul>
      
      <li class="toctree-l1">
        <a class="reference internal" href="/latest/doxygen/html/index.html">API</a>
      </li>
      
      <li class="toctree-l1">
        <a class="reference internal" href="/latest/reference/kconfig/index.html">Kconfig Options</a>
      </li>
      
      <li class="toctree-l1">
        <a class="reference internal" href="/latest/reference/devicetree/bindings.html">Devicetree Bindings</a>
      </li>
      
    </ul>
  </div>
  

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Zephyr Project</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
  <!-- Docs / Latest -->
  
  

  <li><a href="../../index.html">Docs / Latest</a> &raquo;</li>
  
     <li><a href="../index.html">API Reference</a> &raquo;</li>
  
  <li>Settings</li>


  <li class="wy-breadcrumbs-aside">
    <dark-mode-toggle id="dark-mode-toggle" appearance="toggle" permanent="true"/>
  </li>
  <li class="wy-breadcrumbs-aside">
      
      
        <a href="https://github.com/zephyrproject-rtos/zephyr/blob/main/doc/reference/settings/index.rst" class="fa fa-github"> Open on GitHub</a>
      
    
  </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
  
    <div class="wy-alert wy-alert-danger">
     This is the documentation for the latest (main) development branch of
     Zephyr. If you are looking for the documentation of previous releases, use
     the drop-down menu on the left and select the desired version.
    </div>
  
  
           <div itemprop="articleBody">
             
  <div class="section" id="settings">
<span id="settings-api"></span><h1>Settings<a class="headerlink" href="#settings" title="Permalink to this headline">¶</a></h1>
<p>The settings subsystem gives modules a way to store persistent per-device
configuration and runtime state.  A variety of storage implementations are
provided behind a common API using FCB, NVS, or a file system.  These different
implementations give the application developer flexibility to select an
appropriate storage medium, and even change it later as needs change.  This
subsystem is used by various Zephyr components and can be used simultaneously by
user applications.</p>
<p>Settings items are stored as key-value pair strings.  By convention,
the keys can be organized by the package and subtree defining the key,
for example the key <code class="docutils literal notranslate"><span class="pre">id/serial</span></code> would define the <code class="docutils literal notranslate"><span class="pre">serial</span></code> configuration
element for the package <code class="docutils literal notranslate"><span class="pre">id</span></code>.</p>
<p>Convenience routines are provided for converting a key value to
and from a string type.</p>
<p>For an example of the settings subsystem refer to
<a class="reference internal" href="../../samples/subsys/settings/README.html#settings-subsys-sample"><span class="std std-ref">the sample</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As of Zephyr release 2.1 the recommended backend for non-filesystem
storage is <a class="reference internal" href="../storage/nvs/nvs.html#nvs-api"><span class="std std-ref">NVS</span></a>.</p>
</div>
<div class="section" id="handlers">
<h2>Handlers<a class="headerlink" href="#handlers" title="Permalink to this headline">¶</a></h2>
<p>Settings handlers for subtree implement a set of handler functions.
These are registered using a call to <code class="docutils literal notranslate"><span class="pre">settings_register()</span></code>.</p>
<dl class="simple">
<dt><strong>h_get</strong></dt><dd><p>This gets called when asking for a settings element value by its name using
<code class="docutils literal notranslate"><span class="pre">settings_runtime_get()</span></code> from the runtime backend.</p>
</dd>
<dt><strong>h_set</strong></dt><dd><p>This gets called when the value is loaded from persisted storage with
<code class="docutils literal notranslate"><span class="pre">settings_load()</span></code>, or when using <code class="docutils literal notranslate"><span class="pre">settings_runtime_set()</span></code> from the
runtime backend.</p>
</dd>
<dt><strong>h_commit</strong></dt><dd><p>This gets called after the settings have been loaded in full.
Sometimes you don’t want an individual setting value to take
effect right away, for example if there are multiple settings
which are interdependent.</p>
</dd>
<dt><strong>h_export</strong></dt><dd><p>This gets called to write all current settings. This happens
when <code class="docutils literal notranslate"><span class="pre">settings_save()</span></code> tries to save the settings or transfer to any
user-implemented back-end.</p>
</dd>
</dl>
</div>
<div class="section" id="backends">
<h2>Backends<a class="headerlink" href="#backends" title="Permalink to this headline">¶</a></h2>
<p>Backends are meant to load and save data to/from setting handlers, and
implement a set of handler functions. These are registered using a call to
<code class="docutils literal notranslate"><span class="pre">settings_src_register()</span></code> for backends that can load data, and/or
<code class="docutils literal notranslate"><span class="pre">settings_dst_register()</span></code> for backends that can save data. The current
implementation allows for multiple source backends but only a single destination
backend.</p>
<dl class="simple">
<dt><strong>csi_load</strong></dt><dd><p>This gets called when loading values from persistent storage using
<code class="docutils literal notranslate"><span class="pre">settings_load()</span></code>.</p>
</dd>
<dt><strong>csi_save</strong></dt><dd><p>This gets called when a saving a single setting to persistent storage using
<code class="docutils literal notranslate"><span class="pre">settings_save_one()</span></code>.</p>
</dd>
<dt><strong>csi_save_start</strong></dt><dd><p>This gets called when starting a save of all current settings using
<code class="docutils literal notranslate"><span class="pre">settings_save()</span></code>.</p>
</dd>
<dt><strong>csi_save_end</strong></dt><dd><p>This gets called after having saved of all current settings using
<code class="docutils literal notranslate"><span class="pre">settings_save()</span></code>.</p>
</dd>
</dl>
</div>
<div class="section" id="zephyr-storage-backends">
<h2>Zephyr Storage Backends<a class="headerlink" href="#zephyr-storage-backends" title="Permalink to this headline">¶</a></h2>
<p>Zephyr has three storage backends: a Flash Circular Buffer
(<a class="reference internal" href="../kconfig/dummy-syms.html#std-kconfig-CONFIG_SETTINGS_FCB"><code class="xref std std-kconfig docutils literal notranslate"><span class="pre">CONFIG_SETTINGS_FCB</span></code></a>), a file in the filesystem
(<a class="reference internal" href="../kconfig/dummy-syms.html#std-kconfig-CONFIG_SETTINGS_FS"><code class="xref std std-kconfig docutils literal notranslate"><span class="pre">CONFIG_SETTINGS_FS</span></code></a>), or non-volatile storage
(<a class="reference internal" href="../kconfig/dummy-syms.html#std-kconfig-CONFIG_SETTINGS_NVS"><code class="xref std std-kconfig docutils literal notranslate"><span class="pre">CONFIG_SETTINGS_NVS</span></code></a>).</p>
<p>You can declare multiple sources for settings; settings from
all of these are restored when <code class="docutils literal notranslate"><span class="pre">settings_load()</span></code> is called.</p>
<p>There can be only one target for writing settings; this is where
data is stored when you call <code class="docutils literal notranslate"><span class="pre">settings_save()</span></code>, or <code class="docutils literal notranslate"><span class="pre">settings_save_one()</span></code>.</p>
<p>FCB read target is registered using <code class="docutils literal notranslate"><span class="pre">settings_fcb_src()</span></code>, and write target
using <code class="docutils literal notranslate"><span class="pre">settings_fcb_dst()</span></code>. As a side-effect,  <code class="docutils literal notranslate"><span class="pre">settings_fcb_src()</span></code>
initializes the FCB area, so it must be called before calling
<code class="docutils literal notranslate"><span class="pre">settings_fcb_dst()</span></code>. File read target is registered using
<code class="docutils literal notranslate"><span class="pre">settings_file_src()</span></code>, and write target by using <code class="docutils literal notranslate"><span class="pre">settings_file_dst()</span></code>.
Non-volatile storage read target is registered using
<code class="docutils literal notranslate"><span class="pre">settings_nvs_src()</span></code>, and write target by using
<code class="docutils literal notranslate"><span class="pre">settings_nvs_dst()</span></code>.</p>
</div>
<div class="section" id="loading-data-from-persisted-storage">
<h2>Loading data from persisted storage<a class="headerlink" href="#loading-data-from-persisted-storage" title="Permalink to this headline">¶</a></h2>
<p>A call to <code class="docutils literal notranslate"><span class="pre">settings_load()</span></code> uses an <code class="docutils literal notranslate"><span class="pre">h_set</span></code> implementation
to load settings data from storage to volatile memory.
After all data is loaded, the <code class="docutils literal notranslate"><span class="pre">h_commit</span></code> handler is issued,
signalling the application that the settings were successfully
retrieved.</p>
<p>Technically FCB and filesystem backends may store some history of the entities.
This means that the newest data entity is stored after any
older existing data entities.
Starting with Zephyr 2.1, the back-end must filter out all old entities and
call the callback with only the newest entity.</p>
</div>
<div class="section" id="storing-data-to-persistent-storage">
<h2>Storing data to persistent storage<a class="headerlink" href="#storing-data-to-persistent-storage" title="Permalink to this headline">¶</a></h2>
<p>A call to <code class="docutils literal notranslate"><span class="pre">settings_save_one()</span></code> uses a backend implementation to store
settings data to the storage medium. A call to <code class="docutils literal notranslate"><span class="pre">settings_save()</span></code> uses an
<code class="docutils literal notranslate"><span class="pre">h_export</span></code> implementation to store different data in one operation using
<code class="docutils literal notranslate"><span class="pre">settings_save_one()</span></code>.
A key need to be covered by a <code class="docutils literal notranslate"><span class="pre">h_export</span></code> only if it is supposed to be stored
by <code class="docutils literal notranslate"><span class="pre">settings_save()</span></code> call.</p>
<p>For both FCB and filesystem back-end only storage requests with data which
changes most actual key’s value are stored, therefore there is no need to check
whether a value changed by the application. Such a storage mechanism implies
that storage can contain multiple value assignments for a key , while only the
last is the current value for the key.</p>
<div class="section" id="garbage-collection">
<h3>Garbage collection<a class="headerlink" href="#garbage-collection" title="Permalink to this headline">¶</a></h3>
<p>When storage becomes full (FCB) or consumes too much space (file system),
the backend removes non-recent key-value pairs records and unnecessary
key-delete records.</p>
</div>
</div>
<div class="section" id="secure-domain-settings">
<h2>Secure domain settings<a class="headerlink" href="#secure-domain-settings" title="Permalink to this headline">¶</a></h2>
<p>Currently settings doesn’t provide scheme of being secure, and non-secure
configuration storage simultaneously for the same instance.
It is recommended that secure domain uses its own settings instance and it might
provide data for non-secure domain using dedicated interface if needed
(case dependent).</p>
</div>
<div class="section" id="example-device-configuration">
<h2>Example: Device Configuration<a class="headerlink" href="#example-device-configuration" title="Permalink to this headline">¶</a></h2>
<p>This is a simple example, where the settings handler only implements <code class="docutils literal notranslate"><span class="pre">h_set</span></code>
and <code class="docutils literal notranslate"><span class="pre">h_export</span></code>. <code class="docutils literal notranslate"><span class="pre">h_set</span></code> is called when the value is restored from storage
(or when set initially), and <code class="docutils literal notranslate"><span class="pre">h_export</span></code> is used to write the value to
storage thanks to <code class="docutils literal notranslate"><span class="pre">storage_func()</span></code>. The user can also implement some other
export functionality, for example, writing to the shell console).</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#define DEFAULT_FOO_VAL_VALUE 1</span>

<span class="k">static</span><span class="w"> </span><span class="n">int8</span><span class="w"> </span><span class="n">foo_val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULT_FOO_VAL_VALUE</span><span class="p">;</span><span class="w"></span>

<span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">foo_settings_set</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">len</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="n">settings_read_cb</span><span class="w"> </span><span class="n">read_cb</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">cb_arg</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">next</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">rc</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">settings_name_steq</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;bar&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">next</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">next</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">len</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">foo_val</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>

<span class="w">        </span><span class="n">rc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">read_cb</span><span class="p">(</span><span class="n">cb_arg</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">foo_val</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">foo_val</span><span class="p">));</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">rc</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="cm">/* key-value pair was properly read.</span>
<span class="cm">             * rc contains value length.</span>
<span class="cm">             */</span><span class="w"></span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="cm">/* read-out error */</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">rc</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="n">ENOENT</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">foo_settings_export</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">storage_func</span><span class="p">)(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">name</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                   </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">value</span><span class="p">,</span><span class="w"></span>
<span class="w">                                                   </span><span class="kt">size_t</span><span class="w"> </span><span class="n">val_len</span><span class="p">))</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">storage_func</span><span class="p">(</span><span class="s">&quot;foo/bar&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">foo_val</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">foo_val</span><span class="p">));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">struct</span><span class="w"> </span><span class="nc">settings_handler</span><span class="w"> </span><span class="n">my_conf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;foo&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="p">.</span><span class="n">h_set</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">foo_settings_set</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="p">.</span><span class="n">h_export</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">foo_settings_export</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="example-persist-runtime-state">
<h2>Example: Persist Runtime State<a class="headerlink" href="#example-persist-runtime-state" title="Permalink to this headline">¶</a></h2>
<p>This is a simple example showing how to persist runtime state. In this example,
only <code class="docutils literal notranslate"><span class="pre">h_set</span></code> is defined, which is used when restoring value from
persisted storage.</p>
<p>In this example, the <code class="docutils literal notranslate"><span class="pre">main</span></code> function increments <code class="docutils literal notranslate"><span class="pre">foo_val</span></code>, and then
persists the latest number. When the system restarts, the application calls
<code class="docutils literal notranslate"><span class="pre">settings_load()</span></code> while initializing, and <code class="docutils literal notranslate"><span class="pre">foo_val</span></code> will continue counting
up from where it was before restart.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;zephyr.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;sys/reboot.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;settings/settings.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;sys/printk.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;inttypes.h&gt;</span><span class="cp"></span>

<span class="cp">#define DEFAULT_FOO_VAL_VALUE 0</span>

<span class="k">static</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">foo_val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULT_FOO_VAL_VALUE</span><span class="p">;</span><span class="w"></span>

<span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">foo_settings_set</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">len</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="n">settings_read_cb</span><span class="w"> </span><span class="n">read_cb</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">cb_arg</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">next</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">rc</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">settings_name_steq</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;bar&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">next</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">next</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">len</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">foo_val</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>

<span class="w">        </span><span class="n">rc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">read_cb</span><span class="p">(</span><span class="n">cb_arg</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">foo_val</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">foo_val</span><span class="p">));</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">rc</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">rc</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>


<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">-</span><span class="n">ENOENT</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">struct</span><span class="w"> </span><span class="nc">settings_handler</span><span class="w"> </span><span class="n">my_conf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;foo&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="p">.</span><span class="n">h_set</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">foo_settings_set</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">settings_subsys_init</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">settings_register</span><span class="p">(</span><span class="o">&amp;</span><span class="n">my_conf</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">settings_load</span><span class="p">();</span><span class="w"></span>

<span class="w">    </span><span class="n">foo_val</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">settings_save_one</span><span class="p">(</span><span class="s">&quot;foo/bar&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">foo_val</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">foo_val</span><span class="p">));</span><span class="w"></span>

<span class="w">    </span><span class="n">printk</span><span class="p">(</span><span class="s">&quot;foo: %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">foo_val</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">k_sleep</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">sys_reboot</span><span class="p">(</span><span class="n">SYS_REBOOT_COLD</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="example-custom-backend-implementation">
<h2>Example: Custom Backend Implementation<a class="headerlink" href="#example-custom-backend-implementation" title="Permalink to this headline">¶</a></h2>
<p>This is a simple example showing how to register a simple custom backend
handler (<a class="reference internal" href="../kconfig/dummy-syms.html#std-kconfig-CONFIG_SETTINGS_CUSTOM"><code class="xref std std-kconfig docutils literal notranslate"><span class="pre">CONFIG_SETTINGS_CUSTOM</span></code></a>).</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">settings_custom_load</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">settings_store</span><span class="w"> </span><span class="o">*</span><span class="n">cs</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">//...</span>
<span class="p">}</span><span class="w"></span>

<span class="k">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">settings_custom_save</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">settings_store</span><span class="w"> </span><span class="o">*</span><span class="n">cs</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">name</span><span class="p">,</span><span class="w"></span>
<span class="w">                                </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">val_len</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">//...</span>
<span class="p">}</span><span class="w"></span>

<span class="cm">/* custom backend interface */</span><span class="w"></span>
<span class="k">static</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">settings_store_itf</span><span class="w"> </span><span class="n">settings_custom_itf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="p">.</span><span class="n">csi_load</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">settings_custom_load</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="p">.</span><span class="n">csi_save</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">settings_custom_save</span><span class="p">,</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="cm">/* custom backend node */</span><span class="w"></span>
<span class="k">static</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">settings_store</span><span class="w"> </span><span class="n">settings_custom_store</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="p">.</span><span class="n">cs_itf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">settings_custom_itf</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kt">int</span><span class="w"> </span><span class="n">settings_backend_init</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="cm">/* register custom backend */</span><span class="w"></span>
<span class="w">    </span><span class="n">settings_dst_register</span><span class="p">(</span><span class="o">&amp;</span><span class="n">settings_custom_store</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">settings_src_register</span><span class="p">(</span><span class="o">&amp;</span><span class="n">settings_custom_store</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="api-reference">
<h2>API Reference<a class="headerlink" href="#api-reference" title="Permalink to this headline">¶</a></h2>
<p>The Settings subsystem APIs are provided by <code class="docutils literal notranslate"><span class="pre">settings.h</span></code>:</p>
<div class="section" id="api-for-general-settings-usage">
<h3>API for general settings usage<a class="headerlink" href="#api-for-general-settings-usage" title="Permalink to this headline">¶</a></h3>
<dl>
<dt class="sig sig-object cpp">
<span class="target" id="group__settings"></span><em><span class="pre">group</span></em> <span class="sig-name descname"><span class="pre">settings</span></span></dt>
<dd><div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-defines">Defines</p>
<dl class="c macro">
<dt class="sig sig-object c" id="c.SETTINGS_MAX_DIR_DEPTH">
<span class="target" id="group__settings_1ga2afa32b032e88a188c5263156d9e73e1"></span><span class="sig-name descname"><span class="n"><span class="pre">SETTINGS_MAX_DIR_DEPTH</span></span></span><a class="headerlink" href="#c.SETTINGS_MAX_DIR_DEPTH" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.SETTINGS_MAX_NAME_LEN">
<span class="target" id="group__settings_1gad96357290d7289dd1d7917abd575c4f7"></span><span class="sig-name descname"><span class="n"><span class="pre">SETTINGS_MAX_NAME_LEN</span></span></span><a class="headerlink" href="#c.SETTINGS_MAX_NAME_LEN" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.SETTINGS_MAX_VAL_LEN">
<span class="target" id="group__settings_1gaa9705c71c2d7cfdf3beab49d6b510769"></span><span class="sig-name descname"><span class="n"><span class="pre">SETTINGS_MAX_VAL_LEN</span></span></span><a class="headerlink" href="#c.SETTINGS_MAX_VAL_LEN" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.SETTINGS_NAME_SEPARATOR">
<span class="target" id="group__settings_1gab66e3bb2f0f5f5e3a20c6702df6a0694"></span><span class="sig-name descname"><span class="n"><span class="pre">SETTINGS_NAME_SEPARATOR</span></span></span><a class="headerlink" href="#c.SETTINGS_NAME_SEPARATOR" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.SETTINGS_NAME_END">
<span class="target" id="group__settings_1ga41fb7b74ecb502093d4aa5cd6adb4093"></span><span class="sig-name descname"><span class="n"><span class="pre">SETTINGS_NAME_END</span></span></span><a class="headerlink" href="#c.SETTINGS_NAME_END" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.SETTINGS_EXTRA_LEN">
<span class="target" id="group__settings_1ga9f10069ed74c368aef366d659d3a917d"></span><span class="sig-name descname"><span class="n"><span class="pre">SETTINGS_EXTRA_LEN</span></span></span><a class="headerlink" href="#c.SETTINGS_EXTRA_LEN" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.SETTINGS_STATIC_HANDLER_DEFINE">
<span class="target" id="group__settings_1ga2098bcfc32c6daa13292d937712e476e"></span><span class="sig-name descname"><span class="n"><span class="pre">SETTINGS_STATIC_HANDLER_DEFINE</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">_hname</span></span>, <span class="n"><span class="pre">_tree</span></span>, <span class="n"><span class="pre">_get</span></span>, <span class="n"><span class="pre">_set</span></span>, <span class="n"><span class="pre">_commit</span></span>, <span class="n"><span class="pre">_export</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.SETTINGS_STATIC_HANDLER_DEFINE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Define a static handler for settings items</p>
<p>
This creates a variable <em>hname prepended by <a class="reference internal" href="#structsettings__handler"><span class="std std-ref">settings_handler</span></a></em>. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>_hname</strong> – handler name </p></li>
<li><p><strong>_tree</strong> – subtree name </p></li>
<li><p><strong>_get</strong> – get routine (can be NULL) </p></li>
<li><p><strong>_set</strong> – set routine (can be NULL) </p></li>
<li><p><strong>_commit</strong> – commit routine (can be NULL) </p></li>
<li><p><strong>_export</strong> – export routine (can be NULL)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-typedefs">Typedefs</p>
<dl class="c type">
<dt class="sig sig-object c" id="c.settings_read_cb">
<span class="target" id="group__settings_1ga51cdac276c1fb8cd27fc3eec42749a04"></span><span class="k"><span class="pre">typedef</span></span><span class="w"> </span><span class="n"><span class="pre">ssize_t</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">settings_read_cb</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">cb_arg</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">len</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#c.settings_read_cb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Function used to read the data from the settings storage in h_set handler implementations.</p>
<dl class="field-list simple">
<dt class="field-odd">Param cb_arg</dt>
<dd class="field-odd"><p><strong>[in]</strong> arguments for the read function. Appropriate cb_arg is transferred to h_set handler implementation by the backend. </p>
</dd>
<dt class="field-even">Param data</dt>
<dd class="field-even"><p><strong>[out]</strong> the destination buffer </p>
</dd>
<dt class="field-odd">Param len</dt>
<dd class="field-odd"><p><strong>[in]</strong> length of read</p>
</dd>
<dt class="field-even">Return</dt>
<dd class="field-even"><p>positive: Number of bytes read, 0: key-value pair is deleted. On error returns -ERRNO code. </p>
</dd>
</dl>
</dd></dl>

<dl class="c type">
<dt class="sig sig-object c" id="c.settings_load_direct_cb">
<span class="target" id="group__settings_1ga767bf6c2709b1c58afcf4d1c5ef0d535"></span><span class="k"><span class="pre">typedef</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">settings_load_direct_cb</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">len</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#c.settings_read_cb" title="settings_read_cb"><span class="n"><span class="pre">settings_read_cb</span></span></a><span class="w"> </span><span class="n"><span class="pre">read_cb</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">cb_arg</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">param</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#c.settings_load_direct_cb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Callback function used for direct loading. Used by <a class="reference internal" href="#group__settings_1ga1dfe42f40a7d63bbdb81aed864d0ff12"><span class="std std-ref">settings_load_subtree_direct</span></a> function.</p>
<p><ul class="simple">
<li><p>key[in] the name with skipped part that was used as name in handler registration</p></li>
<li><p>len[in] the size of the data found in the backend.</p></li>
<li><p>read_cb[in] function provided to read the data from the backend.</p></li>
<li><p>cb_arg[in] arguments for the read function provided by the backend.</p></li>
</ul>
</p>
<dl class="field-list simple">
<dt class="field-odd">Param key</dt>
<dd class="field-odd"><p><strong>[in]</strong> the name with skipped part that was used as name in handler registration </p>
</dd>
<dt class="field-even">Param len</dt>
<dd class="field-even"><p><strong>[in]</strong> the size of the data found in the backend. </p>
</dd>
<dt class="field-odd">Param read_cb</dt>
<dd class="field-odd"><p><strong>[in]</strong> function provided to read the data from the backend. </p>
</dd>
<dt class="field-even">Param cb_arg</dt>
<dd class="field-even"><p><strong>[inout]</strong> arguments for the read function provided by the backend. </p>
</dd>
<dt class="field-odd">Param param</dt>
<dd class="field-odd"><p><strong>[inout]</strong> parameter given to the <a class="reference internal" href="#group__settings_1ga1dfe42f40a7d63bbdb81aed864d0ff12"><span class="std std-ref">settings_load_subtree_direct</span></a> function.</p>
</dd>
<dt class="field-even">Return</dt>
<dd class="field-even"><p>When nonzero value is returned, further subtree searching is stopped. Use with care as some settings backends would iterate through old values, and the current value is returned last. </p>
</dd>
</dl>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.settings_subsys_init">
<span class="target" id="group__settings_1gaf81fad8575840f73a739d16d79613f8e"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">settings_subsys_init</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.settings_subsys_init" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Initialization of settings and backend</p>
<p>Can be called at application startup. In case the backend is a FS Remember to call it after the FS was mounted. For FCB backend it can be called without such a restriction.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>0 on success, non-zero on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.settings_register">
<span class="target" id="group__settings_1gab2043a6d799202e177cc3dfa0cbfa531"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">settings_register</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.settings_handler" title="settings_handler"><span class="n"><span class="pre">settings_handler</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">cf</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.settings_register" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Register a handler for settings items stored in RAM.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cf</strong> – Structure containing registration info.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>0 on success, non-zero on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.settings_load">
<span class="target" id="group__settings_1ga89c6d618df81f197cc5c1a2018b00648"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">settings_load</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.settings_load" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Load serialized items from registered persistence sources. Handlers for serialized item subtrees registered earlier will be called for encountered values.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>0 on success, non-zero on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.settings_load_subtree">
<span class="target" id="group__settings_1gab80e8a21c80243359b652386f7ce2424"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">settings_load_subtree</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">subtree</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.settings_load_subtree" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Load limited set of serialized items from registered persistence sources. Handlers for serialized item subtrees registered earlier will be called for encountered values that belong to the subtree.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subtree</strong> – <strong>[in]</strong> name of the subtree to be loaded. </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>0 on success, non-zero on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.settings_load_subtree_direct">
<span class="target" id="group__settings_1ga1dfe42f40a7d63bbdb81aed864d0ff12"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">settings_load_subtree_direct</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">subtree</span></span>, <a class="reference internal" href="#c.settings_load_direct_cb" title="settings_load_direct_cb"><span class="n"><span class="pre">settings_load_direct_cb</span></span></a><span class="w"> </span><span class="n"><span class="pre">cb</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">param</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.settings_load_subtree_direct" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Load limited set of serialized items using given callback.</p>
<p>This function bypasses the normal data workflow in settings module. All the settings values that are found are passed to the given callback.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function does not call commit function. It works as a blocking function, so it is up to the user to call any kind of commit function when this operation ends.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subtree</strong> – <strong>[in]</strong> subtree name of the subtree to be loaded. </p></li>
<li><p><strong>cb</strong> – <strong>[in]</strong> pointer to the callback function. </p></li>
<li><p><strong>param</strong> – <strong>[inout]</strong> parameter to be passed when callback function is called. </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>0 on success, non-zero on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.settings_save">
<span class="target" id="group__settings_1ga789410aa059398d6c8a7851ea6945b55"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">settings_save</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.settings_save" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Save currently running serialized items. All serialized items which are different from currently persisted values will be saved.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>0 on success, non-zero on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.settings_save_one">
<span class="target" id="group__settings_1gaf22356f0dd01d4cf43a6297fafa86e30"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">settings_save_one</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">name</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">value</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">val_len</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.settings_save_one" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Write a single serialized value to persisted storage (if it has changed value).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – Name/key of the settings item. </p></li>
<li><p><strong>value</strong> – Pointer to the value of the settings item. This value will be transferred to the <a class="reference internal" href="#structsettings__handler_1a30207125407f57a0f117ecaee5a2054a"><span class="std std-ref">settings_handler::h_export</span></a> handler implementation. </p></li>
<li><p><strong>val_len</strong> – Length of the value.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>0 on success, non-zero on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.settings_delete">
<span class="target" id="group__settings_1ga070b6ad31bca0bee71ec1f1a4d67618d"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">settings_delete</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">name</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.settings_delete" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Delete a single serialized in persisted storage.</p>
<p>Deleting an existing key-value pair in the settings mean to set its value to NULL.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – Name/key of the settings item.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>0 on success, non-zero on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.settings_commit">
<span class="target" id="group__settings_1ga623c60b89dda3145f9334343748d5954"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">settings_commit</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.settings_commit" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Call commit for all settings handler. This should apply all settings which has been set, but not applied yet.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>0 on success, non-zero on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.settings_commit_subtree">
<span class="target" id="group__settings_1ga11523bc43121d78e0ac8ee1443559e42"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">settings_commit_subtree</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">subtree</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.settings_commit_subtree" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Call commit for settings handler that belong to subtree. This should apply all settings which has been set, but not applied yet.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subtree</strong> – <strong>[in]</strong> name of the subtree to be committed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>0 on success, non-zero on failure. </p>
</dd>
</dl>
</dd></dl>

</div>
<dl class="c struct">
<dt class="sig sig-object c" id="c.settings_handler">
<span class="target" id="structsettings__handler"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">settings_handler</span></span></span><a class="headerlink" href="#c.settings_handler" title="Permalink to this definition">¶</a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;settings.h&gt;</em></div>
<p>Config handlers for subtree implement a set of handler functions. These are registered using a call to <a class="reference internal" href="#group__settings_1gab2043a6d799202e177cc3dfa0cbfa531"><span class="std std-ref">settings_register</span></a>. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="c var">
<dt class="sig sig-object c" id="c.settings_handler.name">
<span class="target" id="structsettings__handler_1ab8eee945dc866ec90b272fb526abc646"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">name</span></span></span><a class="headerlink" href="#c.settings_handler.name" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Name of subtree. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.settings_handler.h_get">
<span class="target" id="structsettings__handler_1a8d4036babe22872777610e54c4dadf21"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">h_get</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">val</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">val_len_max</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#c.settings_handler.h_get" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Get values handler of settings items identified by keyword names.</p>
<p>Parameters:<ul class="simple">
<li><p>key[in] the name with skipped part that was used as name in handler registration</p></li>
<li><p>val[out] buffer to receive value.</p></li>
<li><p>val_len_max[in] size of that buffer.</p></li>
</ul>
</p>
<p>Return: length of data read on success, negative on failure. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.settings_handler.h_set">
<span class="target" id="structsettings__handler_1a70aa25bf3b53898ab22906e9949963a4"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">h_set</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">len</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#c.settings_read_cb" title="settings_read_cb"><span class="n"><span class="pre">settings_read_cb</span></span></a><span class="w"> </span><span class="n"><span class="pre">read_cb</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">cb_arg</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#c.settings_handler.h_set" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Set value handler of settings items identified by keyword names.</p>
<p>Parameters:<ul class="simple">
<li><p>key[in] the name with skipped part that was used as name in handler registration</p></li>
<li><p>len[in] the size of the data found in the backend.</p></li>
<li><p>read_cb[in] function provided to read the data from the backend.</p></li>
<li><p>cb_arg[in] arguments for the read function provided by the backend.</p></li>
</ul>
</p>
<p>Return: 0 on success, non-zero on failure. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.settings_handler.h_commit">
<span class="target" id="structsettings__handler_1ad5e23a2acf29bbb2a5a4f249b5f80e0a"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">h_commit</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="kt"><span class="pre">void</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#c.settings_handler.h_commit" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This handler gets called after settings has been loaded in full. User might use it to apply setting to the application.</p>
<p>Return: 0 on success, non-zero on failure. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.settings_handler.h_export">
<span class="target" id="structsettings__handler_1a30207125407f57a0f117ecaee5a2054a"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">h_export</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">export_func</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">val</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">val_len</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#c.settings_handler.h_export" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This gets called to dump all current settings items.</p>
<p>This happens when <a class="reference internal" href="#group__settings_1ga789410aa059398d6c8a7851ea6945b55"><span class="std std-ref">settings_save</span></a> tries to save the settings. Parameters:<ul class="simple">
<li><p>export_func: the pointer to the internal function which appends a single key-value pair to persisted settings. Don’t store duplicated value. The name is subtree/key string, val is the string with value.</p></li>
</ul>
</p>
<p>
Return: 0 on success, non-zero on failure. <div class="remark admonition">
<p class="admonition-title">Remark</p>
<p>The User might limit a implementations of handler to serving only one keyword at one call - what will impose limit to get/set values using full subtree/key name.</p>
</div>
</p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.settings_handler.node">
<span class="target" id="structsettings__handler_1a6aa2cc76c84341c3d29b679d2cc9c6ab"></span><span class="n"><span class="pre">sys_snode_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">node</span></span></span><a class="headerlink" href="#c.settings_handler.node" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Linked list node info for module internal usage. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="c struct">
<dt class="sig sig-object c" id="c.settings_handler_static">
<span class="target" id="structsettings__handler__static"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">settings_handler_static</span></span></span><a class="headerlink" href="#c.settings_handler_static" title="Permalink to this definition">¶</a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;settings.h&gt;</em></div>
<p>Config handlers without the node element, used for static handlers. These are registered using a call to SETTINGS_REGISTER_STATIC(). </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="c var">
<dt class="sig sig-object c" id="c.settings_handler_static.name">
<span class="target" id="structsettings__handler__static_1aa8e57471bd89f4792cfb0689462b6f9b"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">name</span></span></span><a class="headerlink" href="#c.settings_handler_static.name" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Name of subtree. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.settings_handler_static.h_get">
<span class="target" id="structsettings__handler__static_1acc65e884503cf7db1276e7777f57fb12"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">h_get</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">val</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">val_len_max</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#c.settings_handler_static.h_get" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Get values handler of settings items identified by keyword names.</p>
<p>Parameters:<ul class="simple">
<li><p>key[in] the name with skipped part that was used as name in handler registration</p></li>
<li><p>val[out] buffer to receive value.</p></li>
<li><p>val_len_max[in] size of that buffer.</p></li>
</ul>
</p>
<p>Return: length of data read on success, negative on failure. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.settings_handler_static.h_set">
<span class="target" id="structsettings__handler__static_1a2cf94a6dad3ec35ca58b5ef869c7edae"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">h_set</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">len</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#c.settings_read_cb" title="settings_read_cb"><span class="n"><span class="pre">settings_read_cb</span></span></a><span class="w"> </span><span class="n"><span class="pre">read_cb</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">cb_arg</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#c.settings_handler_static.h_set" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Set value handler of settings items identified by keyword names.</p>
<p>Parameters:<ul class="simple">
<li><p>key[in] the name with skipped part that was used as name in handler registration</p></li>
<li><p>len[in] the size of the data found in the backend.</p></li>
<li><p>read_cb[in] function provided to read the data from the backend.</p></li>
<li><p>cb_arg[in] arguments for the read function provided by the backend.</p></li>
</ul>
</p>
<p>Return: 0 on success, non-zero on failure. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.settings_handler_static.h_commit">
<span class="target" id="structsettings__handler__static_1a093ab8346aedd0a9cb06dfaa4387f393"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">h_commit</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="kt"><span class="pre">void</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#c.settings_handler_static.h_commit" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This handler gets called after settings has been loaded in full. User might use it to apply setting to the application. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.settings_handler_static.h_export">
<span class="target" id="structsettings__handler__static_1abb1df3f0f05fb2a57cd08e380bfffa09"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">h_export</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">export_func</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">val</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">val_len</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#c.settings_handler_static.h_export" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>This gets called to dump all current settings items.</p>
<p>This happens when <a class="reference internal" href="#group__settings_1ga789410aa059398d6c8a7851ea6945b55"><span class="std std-ref">settings_save</span></a> tries to save the settings. Parameters:<ul class="simple">
<li><p>export_func: the pointer to the internal function which appends a single key-value pair to persisted settings. Don’t store duplicated value. The name is subtree/key string, val is the string with value.</p></li>
</ul>
</p>
<p>
Return: 0 on success, non-zero on failure. <div class="remark admonition">
<p class="admonition-title">Remark</p>
<p>The User might limit a implementations of handler to serving only one keyword at one call - what will impose limit to get/set values using full subtree/key name.</p>
</div>
</p>
</dd></dl>

</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="api-for-key-name-processing">
<h3>API for key-name processing<a class="headerlink" href="#api-for-key-name-processing" title="Permalink to this headline">¶</a></h3>
<dl>
<dt class="sig sig-object cpp">
<span class="target" id="group__settings__name__proc"></span><em><span class="pre">group</span></em> <span class="sig-name descname"><span class="pre">settings_name_proc</span></span></dt>
<dd><p>API for const name processing. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.settings_name_steq">
<span class="target" id="group__settings__name__proc_1ga6d9d36d54a1bfd59bf7729621653edd9"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">settings_name_steq</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">name</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">key</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">next</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.settings_name_steq" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Compares the start of name with a key</p>
<p>
Some examples: settings_name_steq(“bt/btmesh/iv”, “b”, &amp;next) returns 1, next=”t/btmesh/iv” settings_name_steq(“bt/btmesh/iv”, “bt”, &amp;next) returns 1, next=”btmesh/iv” settings_name_steq(“bt/btmesh/iv”, “bt/”, &amp;next) returns 0, next=NULL settings_name_steq(“bt/btmesh/iv”, “bta”, &amp;next) returns 0, next=NULL</p>
<p>REMARK: This routine could be simplified if the <a class="reference internal" href="#structsettings__handler"><span class="std std-ref">settings_handler</span></a> names would include a separator at the end.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – <strong>[in]</strong> in string format </p></li>
<li><p><strong>key</strong> – <strong>[in]</strong> comparison string </p></li>
<li><p><strong>next</strong> – <strong>[out]</strong> pointer to remaining of name, when the remaining part starts with a separator the separator is removed from next</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>0: no match 1: match, next can be used to check if match is full </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.settings_name_next">
<span class="target" id="group__settings__name__proc_1gacf259320845ae83c46df634f93c6d3e5"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">settings_name_next</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">name</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">next</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.settings_name_next" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>determine the number of characters before the first separator</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – <strong>[in]</strong> in string format </p></li>
<li><p><strong>next</strong> – <strong>[out]</strong> pointer to remaining of name (excluding separator)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>index of the first separator, in case no separator was found this is the size of name </p>
</dd>
</dl>
</dd></dl>

</div>
</dd></dl>

</div>
<div class="section" id="api-for-runtime-settings-manipulation">
<h3>API for runtime settings manipulation<a class="headerlink" href="#api-for-runtime-settings-manipulation" title="Permalink to this headline">¶</a></h3>
<dl>
<dt class="sig sig-object cpp">
<span class="target" id="group__settings__rt"></span><em><span class="pre">group</span></em> <span class="sig-name descname"><span class="pre">settings_rt</span></span></dt>
<dd><p>API for runtime settings. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.settings_runtime_set">
<span class="target" id="group__settings__rt_1gae1b95c47c49774d53b4745af810e881e"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">settings_runtime_set</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">name</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">len</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.settings_runtime_set" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Set a value with a specific key to a module handler.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – Key in string format. </p></li>
<li><p><strong>data</strong> – Binary value. </p></li>
<li><p><strong>len</strong> – Value length in bytes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>0 on success, non-zero on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.settings_runtime_get">
<span class="target" id="group__settings__rt_1ga99a4714ba8c184afc659c43ec2020844"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">settings_runtime_get</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">name</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">data</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">len</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.settings_runtime_get" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Get a value corresponding to a key from a module handler.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – Key in string format. </p></li>
<li><p><strong>data</strong> – Returned binary value. </p></li>
<li><p><strong>len</strong> – requested value length in bytes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>length of data read on success, negative on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.settings_runtime_commit">
<span class="target" id="group__settings__rt_1gafa96974170dced7a131bfd5f022483f8"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">settings_runtime_commit</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">name</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.settings_runtime_commit" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Apply settings in a module handler.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – Key in string format.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>0 on success, non-zero on failure. </p>
</dd>
</dl>
</dd></dl>

</div>
</dd></dl>

</div>
<div class="section" id="api-of-backend-interface">
<h3>API of backend interface<a class="headerlink" href="#api-of-backend-interface" title="Permalink to this headline">¶</a></h3>
<dl>
<dt class="sig sig-object cpp">
<span class="target" id="group__settings__backend"></span><em><span class="pre">group</span></em> <span class="sig-name descname"><span class="pre">settings_backend</span></span></dt>
<dd><p>settings </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.settings_src_register">
<span class="target" id="group__settings__backend_1gad16bb70588cf69873f8872d7bf90e1c6"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">settings_src_register</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.settings_store" title="settings_store"><span class="n"><span class="pre">settings_store</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">cs</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.settings_src_register" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Register a backend handler acting as source.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cs</strong> – Backend handler node containing handler information. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.settings_dst_register">
<span class="target" id="group__settings__backend_1ga37bcada0be44b023cd3759e519e69d01"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">settings_dst_register</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.settings_store" title="settings_store"><span class="n"><span class="pre">settings_store</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">cs</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.settings_dst_register" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Register a backend handler acting as destination.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cs</strong> – Backend handler node containing handler information. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.settings_parse_and_lookup">
<span class="target" id="group__settings__backend_1gab03a10ed0b65809369b4b6f220aa3df6"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">settings_handler_</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">settings_parse_and_lookup</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">name</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">next</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.settings_parse_and_lookup" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Parses a key to an array of elements and locate corresponding module handler.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – <strong>[in]</strong> in string format </p></li>
<li><p><strong>next</strong> – <strong>[out]</strong> remaining of name after matched handler</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#structsettings__handler__static"><span class="std std-ref">settings_handler_static</span></a> on success, NULL on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.settings_call_set_handler">
<span class="target" id="group__settings__backend_1gaf94e311eba2b109cdbddd2767e502e77"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">settings_call_set_handler</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">name</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">len</span></span>, <a class="reference internal" href="#c.settings_read_cb" title="settings_read_cb"><span class="n"><span class="pre">settings_read_cb</span></span></a><span class="w"> </span><span class="n"><span class="pre">read_cb</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">read_cb_arg</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.settings_load_arg" title="settings_load_arg"><span class="n"><span class="pre">settings_load_arg</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">load_arg</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.settings_call_set_handler" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Calls settings handler.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – <strong>[in]</strong> The name of the data found in the backend. </p></li>
<li><p><strong>len</strong> – <strong>[in]</strong> The size of the data found in the backend. </p></li>
<li><p><strong>read_cb</strong> – <strong>[in]</strong> Function provided to read the data from the backend. </p></li>
<li><p><strong>read_cb_arg</strong> – <strong>[inout]</strong> Arguments for the read function provided by the backend. </p></li>
<li><p><strong>load_arg</strong> – <strong>[inout]</strong> Arguments for data loading.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>0 or negative error code </p>
</dd>
</dl>
</dd></dl>

</div>
<dl class="c struct">
<dt class="sig sig-object c" id="c.settings_store">
<span class="target" id="structsettings__store"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">settings_store</span></span></span><a class="headerlink" href="#c.settings_store" title="Permalink to this definition">¶</a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;settings.h&gt;</em></div>
<p>Backend handler node for storage handling. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="c var">
<dt class="sig sig-object c" id="c.settings_store.cs_next">
<span class="target" id="structsettings__store_1a9f382f4e61737585228a6a3b86e9a38c"></span><span class="n"><span class="pre">sys_snode_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cs_next</span></span></span><a class="headerlink" href="#c.settings_store.cs_next" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Linked list node info for internal usage. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.settings_store.cs_itf">
<span class="target" id="structsettings__store_1aaa0f629059f0c49b0f92f278791ce19c"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.settings_store_itf" title="settings_store_itf"><span class="n"><span class="pre">settings_store_itf</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">cs_itf</span></span></span><a class="headerlink" href="#c.settings_store.cs_itf" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Backend handler structure. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="c struct">
<dt class="sig sig-object c" id="c.settings_load_arg">
<span class="target" id="structsettings__load__arg"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">settings_load_arg</span></span></span><a class="headerlink" href="#c.settings_load_arg" title="Permalink to this definition">¶</a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;settings.h&gt;</em></div>
<p>Arguments for data loading. Holds all parameters that changes the way data should be loaded from backend. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="c var">
<dt class="sig sig-object c" id="c.settings_load_arg.subtree">
<span class="target" id="structsettings__load__arg_1a0764239993147761b12e8999f860d267"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">subtree</span></span></span><a class="headerlink" href="#c.settings_load_arg.subtree" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Name of the subtree to be loaded. </p>
<p>If NULL, all values would be loaded. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.settings_load_arg.cb">
<span class="target" id="structsettings__load__arg_1aec32e51b4a6b61aff2ea415aa80a9987"></span><a class="reference internal" href="#c.settings_load_direct_cb" title="settings_load_direct_cb"><span class="n"><span class="pre">settings_load_direct_cb</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cb</span></span></span><a class="headerlink" href="#c.settings_load_arg.cb" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Pointer to the callback function. </p>
<p>If NULL then matching registered function would be used. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.settings_load_arg.param">
<span class="target" id="structsettings__load__arg_1a7cbe713a1e0d2885528644b5a54f27d3"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">param</span></span></span><a class="headerlink" href="#c.settings_load_arg.param" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Parameter for callback function. </p>
<p>Parameter to be passed to the callback function. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="c struct">
<dt class="sig sig-object c" id="c.settings_store_itf">
<span class="target" id="structsettings__store__itf"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">settings_store_itf</span></span></span><a class="headerlink" href="#c.settings_store_itf" title="Permalink to this definition">¶</a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;settings.h&gt;</em></div>
<p>Backend handler functions. Sources are registered using a call to <a class="reference internal" href="#group__settings__backend_1gad16bb70588cf69873f8872d7bf90e1c6"><span class="std std-ref">settings_src_register</span></a>. Destinations are registered using a call to <a class="reference internal" href="#group__settings__backend_1ga37bcada0be44b023cd3759e519e69d01"><span class="std std-ref">settings_dst_register</span></a>. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="c var">
<dt class="sig sig-object c" id="c.settings_store_itf.csi_load">
<span class="target" id="structsettings__store__itf_1a8c08da2cd010f5d73689e84d02d12734"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">csi_load</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.settings_store" title="settings_store"><span class="n"><span class="pre">settings_store</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">cs</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.settings_load_arg" title="settings_load_arg"><span class="n"><span class="pre">settings_load_arg</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">arg</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#c.settings_store_itf.csi_load" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Loads values from storage limited to subtree defined by subtree.</p>
<p>Parameters:<ul class="simple">
<li><p>cs - Corresponding backend handler node,</p></li>
<li><p>arg - Structure that holds additional data for data loading.</p></li>
</ul>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Backend is expected not to provide duplicates of the entities. It means that if the backend does not contain any functionality to really delete old keys, it has to filter out old entities and call load callback only on the final entity. </p>
</div>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.settings_store_itf.csi_save_start">
<span class="target" id="structsettings__store__itf_1af6aae0b06cdc935975f19eb4c56eb991"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">csi_save_start</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.settings_store" title="settings_store"><span class="n"><span class="pre">settings_store</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">cs</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#c.settings_store_itf.csi_save_start" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Handler called before an export operation.</p>
<p>Parameters:<ul class="simple">
<li><p>cs - Corresponding backend handler node </p></li>
</ul>
</p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.settings_store_itf.csi_save">
<span class="target" id="structsettings__store__itf_1af97b8a3e2bdac663dd3872117251f0d2"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">csi_save</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.settings_store" title="settings_store"><span class="n"><span class="pre">settings_store</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">cs</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">val_len</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#c.settings_store_itf.csi_save" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Save a single key-value pair to storage.</p>
<p>Parameters:<ul class="simple">
<li><p>cs - Corresponding backend handler node</p></li>
<li><p>name - Key in string format</p></li>
<li><p>value - Binary value</p></li>
<li><p>val_len - Length of value in bytes. </p></li>
</ul>
</p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.settings_store_itf.csi_save_end">
<span class="target" id="structsettings__store__itf_1a90c2506cb06e5d80dffc6c08c6007bce"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">csi_save_end</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.settings_store" title="settings_store"><span class="n"><span class="pre">settings_store</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">cs</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#c.settings_store_itf.csi_save_end" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Handler called after an export operation.</p>
<p>Parameters:<ul class="simple">
<li><p>cs - Corresponding backend handler node </p></li>
</ul>
</p>
</dd></dl>

</div>
</dd></dl>

</dd></dl>

</div>
</div>
</div>


           </div>
          </div>

          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; <a href="../../copyright.html">Copyright</a> 2015-2021 Zephyr Project members and individual contributors.
      <span class="lastupdated">Last updated on Feb 21, 2022.
      </span></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>