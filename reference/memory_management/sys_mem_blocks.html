<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Memory Blocks Allocator &mdash; Zephyr Project Documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/tabs.css" type="text/css" />
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script type="module" src="../../_static/js/dark-mode-toggle.min.mjs"></script>
        <script src="https://www.googletagmanager.com/gtag/js?id=UA-831873-47"></script>
        <script src="../../_static/js/ga-tracker.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="copyright" title="Copyright" href="../../copyright.html" />
    <link rel="next" title="Miscellaneous" href="../misc/index.html" />
    <link rel="prev" title="Shared Multi Heap" href="shared_multi_heap.html" />
  <meta name="color-scheme" content="dark light">
  
  <link rel="stylesheet" href="../../_static/css/light.css" type="text/css" media="(prefers-color-scheme: light)"/>
  <link rel="stylesheet" href="../../_static/css/dark.css" type="text/css" media="(prefers-color-scheme: dark)"/>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html">
            <img src="../../_static/logo.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                3.0.0-rc3
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
  
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Zephyr Project</span>
      v: latest
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        <dt>Document Release Versions</dt>
        
          <dd><a href="/">latest</a></dd>
        
          <dd><a href="/2.7.0/">2.7.0</a></dd>
        
          <dd><a href="/2.6.0/">2.6.0</a></dd>
        
          <dd><a href="/2.5.0/">2.5.0</a></dd>
        
          <dd><a href="/2.4.0/">2.4.0</a></dd>
        
          <dd><a href="/2.3.0/">2.3.0</a></dd>
        
          <dd><a href="/1.14.1/">1.14.1</a></dd>
        
      </dl>
      <dl>
        <dt>Downloads</dt>
        
        <dd><a href="/latest/zephyr.pdf">PDF</a></dd>
      </dl>
      <dl>
        <dt>zephyrproject.org Links</dt>
          <dd>
            <a href="https://www.zephyrproject.org/">Project Home</a>
          </dd>
          <dd>
            <a href="https://github.com/zephyrproject-rtos/sdk-ng/releases">SDK</a>
          </dd>
          <dd>
            <a href="https://github.com/zephyrproject-rtos/zephyr/releases">Releases</a>
          </dd>
      </dl>
    </div>
  </div>
  
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started/index.html">Getting Started Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contribute/index.html">Contribution Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development_process/index.html">Development and Contribution Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../guides/build/index.html">Build and Configuration Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../application/index.html">Application Development</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../api/index.html">API Status and Guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../audio/index.html">Audio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../misc/notify.html">Asynchronous Notifications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bluetooth/index.html">Bluetooth</a></li>
<li class="toctree-l2"><a class="reference internal" href="../canbus/index.html">Controller Area Network (CAN)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../crypto/index.html">Crypto</a></li>
<li class="toctree-l2"><a class="reference internal" href="../devicetree/index.html">Devicetree</a></li>
<li class="toctree-l2"><a class="reference internal" href="../drivers/index.html">Device Driver Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../display/index.html">Display Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../edac/index.html">Error Detection And Correction (EDAC)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../file_system/index.html">File Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iterable_sections/index.html">Iterable Sections</a></li>
<li class="toctree-l2"><a class="reference internal" href="../misc/formatted_output.html">Formatted Output</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kernel/index.html">Kernel Services</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libc/index.html">C standard library</a></li>
<li class="toctree-l2"><a class="reference internal" href="../logging/index.html">Logging</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Memory Management</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="demand_paging.html">Demand Paging</a></li>
<li class="toctree-l3"><a class="reference internal" href="shared_multi_heap.html">Shared Multi Heap</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Memory Blocks Allocator</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#concepts">Concepts</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id1">Memory Blocks Allocator</a></li>
<li class="toctree-l4"><a class="reference internal" href="#multi-memory-blocks-allocator-group">Multi Memory Blocks Allocator Group</a></li>
<li class="toctree-l4"><a class="reference internal" href="#usage">Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#api-reference">API Reference</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../misc/index.html">Miscellaneous</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data_structures/index.html">Data Structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modbus/index.html">Modbus</a></li>
<li class="toctree-l2"><a class="reference internal" href="../networking/index.html">Networking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../peripherals/index.html">Peripherals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pinctrl/index.html">Pin Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pm/index.html">Power Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../random/index.html">Random Number Generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../resource_management/index.html">Resource Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shell/index.html">Shell</a></li>
<li class="toctree-l2"><a class="reference internal" href="../storage/index.html">Storage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../task_wdt/index.html">Task Watchdog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../misc/timeutil.html">Time Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../usb/index.html">USB device support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../usermode/index.html">User Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../util/index.html">Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../settings/index.html">Settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../timing_functions/index.html">Executing Time Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../virtualization/index.html">Virtualization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../guides/index.html">User and Developer Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../security/index.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../samples/index.html">Samples and Demos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../boards/index.html">Supported Boards</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../releases/index.html">Release Notes</a></li>
</ul>

  
  <div class="toctree-wrapper compound">
    <p class="caption"><span class="caption-text">Reference</span></p>
    <ul>
      
      <li class="toctree-l1">
        <a class="reference internal" href="/latest/doxygen/html/index.html">API</a>
      </li>
      
      <li class="toctree-l1">
        <a class="reference internal" href="/latest/reference/kconfig/index.html">Kconfig Options</a>
      </li>
      
      <li class="toctree-l1">
        <a class="reference internal" href="/latest/reference/devicetree/bindings.html">Devicetree Bindings</a>
      </li>
      
    </ul>
  </div>
  

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Zephyr Project</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
  <!-- Docs / Latest -->
  
  

  <li><a href="../../index.html">Docs / Latest</a> &raquo;</li>
  
     <li><a href="../index.html">API Reference</a> &raquo;</li>
  
     <li><a href="index.html">Memory Management</a> &raquo;</li>
  
  <li>Memory Blocks Allocator</li>


  <li class="wy-breadcrumbs-aside">
    <dark-mode-toggle id="dark-mode-toggle" appearance="toggle" permanent="true"/>
  </li>
  <li class="wy-breadcrumbs-aside">
      
      
        <a href="https://github.com/zephyrproject-rtos/zephyr/blob/main/doc/reference/memory_management/sys_mem_blocks.rst" class="fa fa-github"> Open on GitHub</a>
      
    
  </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
  
    <div class="wy-alert wy-alert-danger">
     This is the documentation for the latest (main) development branch of
     Zephyr. If you are looking for the documentation of previous releases, use
     the drop-down menu on the left and select the desired version.
    </div>
  
  
           <div itemprop="articleBody">
             
  <div class="section" id="memory-blocks-allocator">
<span id="sys-mem-blocks"></span><h1>Memory Blocks Allocator<a class="headerlink" href="#memory-blocks-allocator" title="Permalink to this headline">¶</a></h1>
<p>The Memory Blocks Allocator allows memory blocks to be dynamically
allocated from a designated memory region, where:</p>
<ul class="simple">
<li><p>All memory blocks have a single fixed size.</p></li>
<li><p>Multiple blocks can be allocated or freed at the same time.</p></li>
<li><p>A group of blocks allocated together may not be contiguous.
This is useful for operations such as scatter-gather DMA transfers.</p></li>
<li><p>Bookkeeping of allocated blocks is done outside of the associated
buffer (unlike memory slab). This allows the buffer to reside in
memory regions where these can be powered down to conserve energy.</p></li>
</ul>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#concepts" id="id2">Concepts</a></p>
<ul>
<li><p><a class="reference internal" href="#internal-operation" id="id3">Internal Operation</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#id1" id="id4">Memory Blocks Allocator</a></p></li>
<li><p><a class="reference internal" href="#multi-memory-blocks-allocator-group" id="id5">Multi Memory Blocks Allocator Group</a></p></li>
<li><p><a class="reference internal" href="#usage" id="id6">Usage</a></p>
<ul>
<li><p><a class="reference internal" href="#defining-a-memory-blocks-allocator" id="id7">Defining a Memory Blocks Allocator</a></p></li>
<li><p><a class="reference internal" href="#allocating-memory-blocks" id="id8">Allocating Memory Blocks</a></p></li>
<li><p><a class="reference internal" href="#releasing-a-memory-block" id="id9">Releasing a Memory Block</a></p></li>
<li><p><a class="reference internal" href="#using-multi-memory-blocks-allocator-group" id="id10">Using Multi Memory Blocks Allocator Group</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#api-reference" id="id11">API Reference</a></p></li>
</ul>
</div>
<div class="section" id="concepts">
<h2><a class="toc-backref" href="#id2">Concepts</a><a class="headerlink" href="#concepts" title="Permalink to this headline">¶</a></h2>
<p>Any number of Memory Blocks Allocator can be defined (limited only by
available RAM). Each allocator is referenced by its memory address.</p>
<p>A memory blocks allocator has the following key properties:</p>
<ul class="simple">
<li><p>The <strong>block size</strong> of each block, measured in bytes.
It must be at least 4N bytes long, where N is greater than 0.</p></li>
<li><p>The <strong>number of blocks</strong> available for allocation.
It must be greater than zero.</p></li>
<li><p>A <strong>buffer</strong> that provides the memory for the memory slab’s blocks.
It must be at least “block size” times “number of blocks” bytes long.</p></li>
<li><p>A <strong>blocks bitmap</strong> to keep track of which block has been allocated.</p></li>
</ul>
<p>The buffer must be aligned to an N-byte boundary, where N is a power of 2
larger than 2 (i.e. 4, 8, 16, …). To ensure that all memory blocks in
the buffer are similarly aligned to this boundary, the block size must
also be a multiple of N.</p>
<p>Due to the use of internal bookkeeping structures and their creation,
each memory blocks allocator must be declared and defined at compile time.</p>
<div class="section" id="internal-operation">
<h3><a class="toc-backref" href="#id3">Internal Operation</a><a class="headerlink" href="#internal-operation" title="Permalink to this headline">¶</a></h3>
<p>Each buffer associated with an allocator is an array of fixed-size blocks,
with no wasted space between the blocks.</p>
<p>The memory blocks allocator keeps track of unallocated blocks using
a bitmap.</p>
</div>
</div>
<div class="section" id="id1">
<h2><a class="toc-backref" href="#id4">Memory Blocks Allocator</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>Internally, the memory blocks allocator uses a bitmap to keep track of
which blocks have been allocated. Each allocator, utilizing
the <code class="docutils literal notranslate"><span class="pre">sys_bitarray</span></code> interface, gets memory blocks one by one from
the backing buffer up to the requested number of blocks.
All the metadata about an allocator is stored outside of the backing
buffer. This allows the memory region of the backing buffer to be
powered down to conserve energy, as the allocator code never touches
the content of the buffer.</p>
</div>
<div class="section" id="multi-memory-blocks-allocator-group">
<h2><a class="toc-backref" href="#id5">Multi Memory Blocks Allocator Group</a><a class="headerlink" href="#multi-memory-blocks-allocator-group" title="Permalink to this headline">¶</a></h2>
<p>The Multi Memory Blocks Allocator Group utility functions provide
a convenient to manage a group of allocators. A custom allocator
choosing function is used to choose which allocator to use among
this group.</p>
<p>An allocator group should be initialized at runtime via
<a class="reference internal" href="#c.sys_multi_mem_blocks_init" title="sys_multi_mem_blocks_init"><code class="xref c c-func docutils literal notranslate"><span class="pre">sys_multi_mem_blocks_init()</span></code></a>. Each allocator can then be
added via <a class="reference internal" href="#c.sys_multi_mem_blocks_add_allocator" title="sys_multi_mem_blocks_add_allocator"><code class="xref c c-func docutils literal notranslate"><span class="pre">sys_multi_mem_blocks_add_allocator()</span></code></a>.</p>
<p>To allocate memory blocks from group,
<a class="reference internal" href="#c.sys_multi_mem_blocks_alloc" title="sys_multi_mem_blocks_alloc"><code class="xref c c-func docutils literal notranslate"><span class="pre">sys_multi_mem_blocks_alloc()</span></code></a> is called with an opaque
“configuration” parameter. This parameter is passed directly to
the allocator choosing function so that an appropriate allocator
can be chosen. After an allocator is chosen, memory blocks are
allocated via <a class="reference internal" href="#c.sys_mem_blocks_alloc" title="sys_mem_blocks_alloc"><code class="xref c c-func docutils literal notranslate"><span class="pre">sys_mem_blocks_alloc()</span></code></a>.</p>
<p>Allocated memory blocks can be freed via
<a class="reference internal" href="#c.sys_multi_mem_blocks_free" title="sys_multi_mem_blocks_free"><code class="xref c c-func docutils literal notranslate"><span class="pre">sys_multi_mem_blocks_free()</span></code></a>. The caller does not need to
pass a configuration parameter. The allocator code matches
the passed in memory addresses to find the correct allocator
and then memory blocks are freed via <a class="reference internal" href="#c.sys_mem_blocks_free" title="sys_mem_blocks_free"><code class="xref c c-func docutils literal notranslate"><span class="pre">sys_mem_blocks_free()</span></code></a>.</p>
</div>
<div class="section" id="usage">
<h2><a class="toc-backref" href="#id6">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<div class="section" id="defining-a-memory-blocks-allocator">
<h3><a class="toc-backref" href="#id7">Defining a Memory Blocks Allocator</a><a class="headerlink" href="#defining-a-memory-blocks-allocator" title="Permalink to this headline">¶</a></h3>
<p>A memory blocks allocator is defined using a variable of type
<a class="reference internal" href="#c.sys_mem_blocks_t" title="sys_mem_blocks_t"><code class="xref c c-type docutils literal notranslate"><span class="pre">sys_mem_blocks_t</span></code></a>. It needs to be defined and initialized
at compile time by calling <a class="reference internal" href="#c.SYS_MEM_BLOCKS_DEFINE" title="SYS_MEM_BLOCKS_DEFINE"><code class="xref c c-macro docutils literal notranslate"><span class="pre">SYS_MEM_BLOCKS_DEFINE</span></code></a>.</p>
<p>The following code defines and initializes a memory blocks allocator
which has 4 blocks that are 64 bytes long, each of which is aliged
to a 4-byte boundary:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">SYS_MEM_BLOCKS_DEFINE</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="mi">64</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>Similarly, you can define a memory slab in private scope:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">SYS_MEM_BLOCKS_DEFINE_STATIC</span><span class="p">(</span><span class="n">static_allocator</span><span class="p">,</span><span class="w"> </span><span class="mi">64</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>A pre-defined buffer can also be provided to the allocator where
the buffer can be placed separately. Note that the alignment of
the buffer needs to be done at its definition.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">uint8_t</span><span class="w"> </span><span class="nf">__aligned</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="n">backing_buffer</span><span class="p">[</span><span class="mi">64</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">4</span><span class="p">];</span><span class="w"></span>
<span class="n">SYS_MEM_BLOCKS_DEFINE_WITH_EXT_BUF</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="mi">64</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="n">backing_buffer</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="allocating-memory-blocks">
<h3><a class="toc-backref" href="#id8">Allocating Memory Blocks</a><a class="headerlink" href="#allocating-memory-blocks" title="Permalink to this headline">¶</a></h3>
<p>Memory blocks can be allocated by calling <a class="reference internal" href="#c.sys_mem_blocks_alloc" title="sys_mem_blocks_alloc"><code class="xref c c-func docutils literal notranslate"><span class="pre">sys_mem_blocks_alloc()</span></code></a>.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span><span class="w"></span>
<span class="kt">uintptr_t</span><span class="w"> </span><span class="n">blocks</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span><span class="w"></span>

<span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sys_mem_blocks_alloc</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">blocks</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">ret</span> <span class="pre">==</span> <span class="pre">0</span></code>, the array <code class="docutils literal notranslate"><span class="pre">blocks</span></code> will contain an array of memory
addresses pointing to the allocated blocks.</p>
</div>
<div class="section" id="releasing-a-memory-block">
<h3><a class="toc-backref" href="#id9">Releasing a Memory Block</a><a class="headerlink" href="#releasing-a-memory-block" title="Permalink to this headline">¶</a></h3>
<p>Memory blocks are released by calling <a class="reference internal" href="#c.sys_mem_blocks_free" title="sys_mem_blocks_free"><code class="xref c c-func docutils literal notranslate"><span class="pre">sys_mem_blocks_free()</span></code></a>.</p>
<p>The following code builds on the example above which allocates 2 memory blocks,
then releases them once they are no longer needed.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span><span class="w"></span>
<span class="kt">uintptr_t</span><span class="w"> </span><span class="n">blocks</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span><span class="w"></span>

<span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sys_mem_blocks_alloc</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">blocks</span><span class="p">);</span><span class="w"></span>
<span class="p">...</span><span class="w"> </span><span class="cm">/* perform some operations on the allocated memory blocks */</span><span class="w"></span>
<span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sys_mem_blocks_free</span><span class="p">(</span><span class="n">allocator</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">blocks</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="using-multi-memory-blocks-allocator-group">
<h3><a class="toc-backref" href="#id10">Using Multi Memory Blocks Allocator Group</a><a class="headerlink" href="#using-multi-memory-blocks-allocator-group" title="Permalink to this headline">¶</a></h3>
<p>The following code demostrates how to initialize an allocator group:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">sys_mem_blocks_t</span><span class="w"> </span><span class="o">*</span><span class="nf">choice_fn</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">sys_multi_mem_blocks</span><span class="w"> </span><span class="o">*</span><span class="n">group</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">cfg</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="p">...</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="n">SYS_MEM_BLOCKS_DEFINE</span><span class="p">(</span><span class="n">allocator0</span><span class="p">,</span><span class="w"> </span><span class="mi">64</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span><span class="w"></span>
<span class="n">SYS_MEM_BLOCKS_DEFINE</span><span class="p">(</span><span class="n">allocator1</span><span class="p">,</span><span class="w"> </span><span class="mi">64</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span><span class="w"></span>

<span class="k">static</span><span class="w"> </span><span class="n">sys_multi_mem_blocks_t</span><span class="w"> </span><span class="n">alloc_group</span><span class="p">;</span><span class="w"></span>

<span class="n">sys_multi_mem_blocks_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">alloc_group</span><span class="p">,</span><span class="w"> </span><span class="n">choice_fn</span><span class="p">);</span><span class="w"></span>
<span class="n">sys_multi_mem_blocks_add_allocator</span><span class="p">(</span><span class="o">&amp;</span><span class="n">alloc_group</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">allocator0</span><span class="p">);</span><span class="w"></span>
<span class="n">sys_multi_mem_blocks_add_allocator</span><span class="p">(</span><span class="o">&amp;</span><span class="n">alloc_group</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">allocator1</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>To allocate and free memory blocks from the group:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span><span class="w"></span>
<span class="kt">uintptr_t</span><span class="w"> </span><span class="n">blocks</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">blk_size</span><span class="p">;</span><span class="w"></span>

<span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sys_multi_mem_blocks_alloc</span><span class="p">(</span><span class="o">&amp;</span><span class="n">alloc_group</span><span class="p">,</span><span class="w"> </span><span class="n">UINT_TO_POINTER</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="w"></span>
<span class="w">                                 </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">blocks</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">blk_size</span><span class="p">);</span><span class="w"></span>

<span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sys_multi_mem_blocks_free</span><span class="p">(</span><span class="o">&amp;</span><span class="n">alloc_group</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">blocks</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="api-reference">
<h2><a class="toc-backref" href="#id11">API Reference</a><a class="headerlink" href="#api-reference" title="Permalink to this headline">¶</a></h2>
<dl>
<dt class="sig sig-object cpp">
<span class="target" id="group__mem__blocks__apis"></span><em><span class="pre">group</span></em> <span class="sig-name descname"><span class="pre">mem_blocks_apis</span></span></dt>
<dd><div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-defines">Defines</p>
<dl class="c macro">
<dt class="sig sig-object c" id="c.SYS_MEM_BLOCKS_DEFINE">
<span class="target" id="group__mem__blocks__apis_1gab49fdcd86522d318051ca6a6ddf41c7c"></span><span class="sig-name descname"><span class="n"><span class="pre">SYS_MEM_BLOCKS_DEFINE</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">name</span></span>, <span class="n"><span class="pre">blk_sz</span></span>, <span class="n"><span class="pre">num_blks</span></span>, <span class="n"><span class="pre">buf_align</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.SYS_MEM_BLOCKS_DEFINE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Create a memory block object with a new backing buffer. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – Name of the memory block object. </p></li>
<li><p><strong>blk_sz</strong> – Size of each memory block (in bytes). </p></li>
<li><p><strong>num_blks</strong> – Total number of memory blocks. </p></li>
<li><p><strong>buf_align</strong> – Alignment of the memory block buffer (power of 2). </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.SYS_MEM_BLOCKS_DEFINE_STATIC">
<span class="target" id="group__mem__blocks__apis_1gaa6b90846448323837dab3a17c3065359"></span><span class="sig-name descname"><span class="n"><span class="pre">SYS_MEM_BLOCKS_DEFINE_STATIC</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">name</span></span>, <span class="n"><span class="pre">blk_sz</span></span>, <span class="n"><span class="pre">num_blks</span></span>, <span class="n"><span class="pre">buf_align</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.SYS_MEM_BLOCKS_DEFINE_STATIC" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Create a static memory block object with a new backing buffer. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – Name of the memory block object. </p></li>
<li><p><strong>blk_sz</strong> – Size of each memory block (in bytes). </p></li>
<li><p><strong>num_blks</strong> – Total number of memory blocks. </p></li>
<li><p><strong>buf_align</strong> – Alignment of the memory block buffer (power of 2). </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.SYS_MEM_BLOCKS_DEFINE_WITH_EXT_BUF">
<span class="target" id="group__mem__blocks__apis_1gae6b688b2925308c9007071bab681dcdd"></span><span class="sig-name descname"><span class="n"><span class="pre">SYS_MEM_BLOCKS_DEFINE_WITH_EXT_BUF</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">name</span></span>, <span class="n"><span class="pre">blk_sz</span></span>, <span class="n"><span class="pre">num_blks</span></span>, <span class="n"><span class="pre">buf</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.SYS_MEM_BLOCKS_DEFINE_WITH_EXT_BUF" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Create a memory block object with a providing backing buffer. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – Name of the memory block object. </p></li>
<li><p><strong>blk_sz</strong> – Size of each memory block (in bytes). </p></li>
<li><p><strong>num_blks</strong> – Total number of memory blocks. </p></li>
<li><p><strong>buf</strong> – Backing buffer of type uint8_t. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.SYS_MEM_BLOCKS_DEFINE_STATIC_WITH_EXT_BUF">
<span class="target" id="group__mem__blocks__apis_1gaad3cfb34553bd97290b388bec910b8cc"></span><span class="sig-name descname"><span class="n"><span class="pre">SYS_MEM_BLOCKS_DEFINE_STATIC_WITH_EXT_BUF</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">name</span></span>, <span class="n"><span class="pre">blk_sz</span></span>, <span class="n"><span class="pre">num_blks</span></span>, <span class="n"><span class="pre">buf</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.SYS_MEM_BLOCKS_DEFINE_STATIC_WITH_EXT_BUF" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Create a static memory block object with a providing backing buffer. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – Name of the memory block object. </p></li>
<li><p><strong>blk_sz</strong> – Size of each memory block (in bytes). </p></li>
<li><p><strong>num_blks</strong> – Total number of memory blocks. </p></li>
<li><p><strong>buf</strong> – Backing buffer of type uint8_t. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-typedefs">Typedefs</p>
<dl class="c type">
<dt class="sig sig-object c" id="c.sys_mem_blocks_t">
<span class="target" id="group__mem__blocks__apis_1ga918c841efcf0fb768f24d29f93feed78"></span><span class="k"><span class="pre">typedef</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">sys_mem_blocks</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">sys_mem_blocks_t</span></span></span><a class="headerlink" href="#c.sys_mem_blocks_t" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Memory Blocks Allocator. </p>
</dd></dl>

<dl class="c type">
<dt class="sig sig-object c" id="c.sys_multi_mem_blocks_t">
<span class="target" id="group__mem__blocks__apis_1gaa8365b2a833ae71fa5c04727d23cf48d"></span><span class="k"><span class="pre">typedef</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">sys_multi_mem_blocks</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">sys_multi_mem_blocks_t</span></span></span><a class="headerlink" href="#c.sys_multi_mem_blocks_t" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Multi Memory Blocks Allocator. </p>
</dd></dl>

<dl class="c type">
<dt class="sig sig-object c" id="c.sys_multi_mem_blocks_choice_fn_t">
<span class="target" id="group__mem__blocks__apis_1ga2e58484681d0d9629af9a8c7c14453d9"></span><span class="k"><span class="pre">typedef</span></span><span class="w"> </span><a class="reference internal" href="#c.sys_mem_blocks_t" title="sys_mem_blocks_t"><span class="n"><span class="pre">sys_mem_blocks_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">sys_multi_mem_blocks_choice_fn_t</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="n"><span class="pre">sys_multi_mem_blocks</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">group</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#c.sys_multi_mem_blocks_choice_fn_t" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Multi memory blocks allocator choice function. </p>
<p>This is a user-provided functions whose responsibility is selecting a specific memory blocks allocator based on the opaque cfg value, which is specified by the user as an argument to <a class="reference internal" href="#group__mem__blocks__apis_1gafa96b1567b57c4466c9640fd1f5408b2"><span class="std std-ref">sys_multi_mem_blocks_alloc()</span></a>. The callback returns a pointer to the chosen allocator where the allocation is performed.</p>
<p>NULL may be returned, which will cause the allocation to fail and a -EINVAL reported to the calling code.</p>
<dl class="field-list simple">
<dt class="field-odd">Param group</dt>
<dd class="field-odd"><p>Multi memory blocks allocator structure. </p>
</dd>
<dt class="field-even">Param cfg</dt>
<dd class="field-even"><p>An opaque user-provided value. It may be interpreted in any way by the application.</p>
</dd>
<dt class="field-odd">Return</dt>
<dd class="field-odd"><p>A pointer to the chosen allocator, or NULL if none is chosen. </p>
</dd>
</dl>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.sys_mem_blocks_alloc">
<span class="target" id="group__mem__blocks__apis_1ga3e53a5c65bb0e88fbf20e66b016c1dff"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">sys_mem_blocks_alloc</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.sys_mem_blocks_t" title="sys_mem_blocks_t"><span class="n"><span class="pre">sys_mem_blocks_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">mem_block</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">count</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">out_blocks</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.sys_mem_blocks_alloc" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Allocate multiple memory blocks. </p>
<p>Allocate multiple memory blocks, and place their pointers into the output array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mem_block</strong> – Pointer to memory block object. </p></li>
<li><p><strong>count</strong> – <strong>[in]</strong> Number of blocks to allocate. </p></li>
<li><p><strong>out_blocks</strong> – <strong>[out]</strong> Output array to be populated by pointers to the memory blocks. It must have at least <code class="docutils literal notranslate"><span class="pre">count</span></code> elements.</p></li>
</ul>
</dd>
<dt class="field-even">Return values</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>0</strong> – Successful </p></li>
<li><p><strong>-EINVAL</strong> – Invalid argument supplied. </p></li>
<li><p><strong>-ENOMEM</strong> – Not enough blocks for allocation. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.sys_mem_blocks_free">
<span class="target" id="group__mem__blocks__apis_1gadd799f4f2423277ed5daf08a0d150b9c"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">sys_mem_blocks_free</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.sys_mem_blocks_t" title="sys_mem_blocks_t"><span class="n"><span class="pre">sys_mem_blocks_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">mem_block</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">count</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">in_blocks</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.sys_mem_blocks_free" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Free multiple memory blocks. </p>
<p>Free multiple memory blocks according to the array of memory block pointers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mem_block</strong> – Pointer to memory block object. </p></li>
<li><p><strong>count</strong> – <strong>[in]</strong> Number of blocks to free. </p></li>
<li><p><strong>in_blocks</strong> – <strong>[in]</strong> Input array of pointers to the memory blocks.</p></li>
</ul>
</dd>
<dt class="field-even">Return values</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>0</strong> – Successful </p></li>
<li><p><strong>-EINVAL</strong> – Invalid argument supplied. </p></li>
<li><p><strong>-EFAULT</strong> – Invalid pointers supplied. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.sys_multi_mem_blocks_init">
<span class="target" id="group__mem__blocks__apis_1gad39867e3cd1e1e69e6fb3746c05abed0"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">sys_multi_mem_blocks_init</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.sys_multi_mem_blocks_t" title="sys_multi_mem_blocks_t"><span class="n"><span class="pre">sys_multi_mem_blocks_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">group</span></span>, <a class="reference internal" href="#c.sys_multi_mem_blocks_choice_fn_t" title="sys_multi_mem_blocks_choice_fn_t"><span class="n"><span class="pre">sys_multi_mem_blocks_choice_fn_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">choice_fn</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.sys_multi_mem_blocks_init" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Initialize multi memory blocks allocator group. </p>
<p>Initialize a sys_multi_mem_block struct with the specified choice function. Note that individual allocator must be added later with sys_multi_mem_blocks_add_allocator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>group</strong> – Multi memory blocks allocator structure. </p></li>
<li><p><strong>choice_fn</strong> – A sys_multi_mem_blocks_choice_fn_t callback used to select the allocator to be used at allocation time </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.sys_multi_mem_blocks_add_allocator">
<span class="target" id="group__mem__blocks__apis_1ga03967e8b917a1592638586c9cfbba4bb"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">sys_multi_mem_blocks_add_allocator</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.sys_multi_mem_blocks_t" title="sys_multi_mem_blocks_t"><span class="n"><span class="pre">sys_multi_mem_blocks_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">group</span></span>, <a class="reference internal" href="#c.sys_mem_blocks_t" title="sys_mem_blocks_t"><span class="n"><span class="pre">sys_mem_blocks_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">alloc</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.sys_multi_mem_blocks_add_allocator" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Add an allocator to an allocator group. </p>
<p>This adds a known allocator to an existing multi memory blocks allocator group.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>group</strong> – Multi memory blocks allocator structure. </p></li>
<li><p><strong>alloc</strong> – Allocator to add </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.sys_multi_mem_blocks_alloc">
<span class="target" id="group__mem__blocks__apis_1gafa96b1567b57c4466c9640fd1f5408b2"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">sys_multi_mem_blocks_alloc</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.sys_multi_mem_blocks_t" title="sys_multi_mem_blocks_t"><span class="n"><span class="pre">sys_multi_mem_blocks_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">group</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">cfg</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">count</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">out_blocks</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">blk_size</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.sys_multi_mem_blocks_alloc" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Allocate memory from multi memory blocks allocator group. </p>
<p>Just as for <a class="reference internal" href="#group__mem__blocks__apis_1ga3e53a5c65bb0e88fbf20e66b016c1dff"><span class="std std-ref">sys_mem_blocks_alloc()</span></a>, allocates multiple blocks of memory. Takes an opaque configuration pointer passed to the choice function, which is used by integration code to choose an allocator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>group</strong> – <strong>[in]</strong> Multi memory blocks allocator structure. </p></li>
<li><p><strong>cfg</strong> – <strong>[in]</strong> Opaque configuration parameter, as for sys_multi_mem_blocks_choice_fn_t </p></li>
<li><p><strong>count</strong> – <strong>[in]</strong> Number of blocks to allocate </p></li>
<li><p><strong>out_blocks</strong> – <strong>[out]</strong> Output array to be populated by pointers to the memory blocks. It must have at least <code class="docutils literal notranslate"><span class="pre">count</span></code> elements. </p></li>
<li><p><strong>blk_size</strong> – <strong>[out]</strong> If not NULL, output the block size of the chosen allocator.</p></li>
</ul>
</dd>
<dt class="field-even">Return values</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>0</strong> – Successful </p></li>
<li><p><strong>-EINVAL</strong> – Invalid argument supplied, or no allocator chosen. </p></li>
<li><p><strong>-ENOMEM</strong> – Not enough blocks for allocation. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.sys_multi_mem_blocks_free">
<span class="target" id="group__mem__blocks__apis_1ga8dedc28ed45e9e6350b584b1082b4d4f"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">sys_multi_mem_blocks_free</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.sys_multi_mem_blocks_t" title="sys_multi_mem_blocks_t"><span class="n"><span class="pre">sys_multi_mem_blocks_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">group</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n"><span class="pre">count</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">in_blocks</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.sys_multi_mem_blocks_free" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Free memory allocated from multi memory blocks allocator group. </p>
<p>Free previous allocated memory blocks from <a class="reference internal" href="#group__mem__blocks__apis_1gafa96b1567b57c4466c9640fd1f5408b2"><span class="std std-ref">sys_multi_mem_blocks_alloc()</span></a>.</p>
<p>Note that all blocks in <code class="docutils literal notranslate"><span class="pre">in_blocks</span></code> must be from the same allocator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>group</strong> – <strong>[in]</strong> Multi memory blocks allocator structure. </p></li>
<li><p><strong>count</strong> – <strong>[in]</strong> Number of blocks to free. </p></li>
<li><p><strong>in_blocks</strong> – <strong>[in]</strong> Input array of pointers to the memory blocks.</p></li>
</ul>
</dd>
<dt class="field-even">Return values</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>0</strong> – Successful </p></li>
<li><p><strong>-EINVAL</strong> – Invalid argument supplied, or no allocator chosen. </p></li>
<li><p><strong>-EFAULT</strong> – Invalid pointer(s) supplied. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
</dd></dl>

</div>
</div>


           </div>
          </div>

          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; <a href="../../copyright.html">Copyright</a> 2015-2021 Zephyr Project members and individual contributors.
      <span class="lastupdated">Last updated on Feb 21, 2022.
      </span></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>