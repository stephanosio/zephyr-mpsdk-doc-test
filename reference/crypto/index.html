<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Crypto &mdash; Zephyr Project Documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/tabs.css" type="text/css" />
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script type="module" src="../../_static/js/dark-mode-toggle.min.mjs"></script>
        <script src="https://www.googletagmanager.com/gtag/js?id=UA-831873-47"></script>
        <script src="../../_static/js/ga-tracker.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="copyright" title="Copyright" href="../../copyright.html" />
    <link rel="next" title="Devicetree" href="../devicetree/index.html" />
    <link rel="prev" title="ISO-TP Transport Protocol" href="../canbus/isotp.html" />
  <meta name="color-scheme" content="dark light">
  
  <link rel="stylesheet" href="../../_static/css/light.css" type="text/css" media="(prefers-color-scheme: light)"/>
  <link rel="stylesheet" href="../../_static/css/dark.css" type="text/css" media="(prefers-color-scheme: dark)"/>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html">
            <img src="../../_static/logo.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                3.0.0-rc3
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
  
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Zephyr Project</span>
      v: latest
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        <dt>Document Release Versions</dt>
        
          <dd><a href="/">latest</a></dd>
        
          <dd><a href="/2.7.0/">2.7.0</a></dd>
        
          <dd><a href="/2.6.0/">2.6.0</a></dd>
        
          <dd><a href="/2.5.0/">2.5.0</a></dd>
        
          <dd><a href="/2.4.0/">2.4.0</a></dd>
        
          <dd><a href="/2.3.0/">2.3.0</a></dd>
        
          <dd><a href="/1.14.1/">1.14.1</a></dd>
        
      </dl>
      <dl>
        <dt>Downloads</dt>
        
        <dd><a href="/latest/zephyr.pdf">PDF</a></dd>
      </dl>
      <dl>
        <dt>zephyrproject.org Links</dt>
          <dd>
            <a href="https://www.zephyrproject.org/">Project Home</a>
          </dd>
          <dd>
            <a href="https://github.com/zephyrproject-rtos/sdk-ng/releases">SDK</a>
          </dd>
          <dd>
            <a href="https://github.com/zephyrproject-rtos/zephyr/releases">Releases</a>
          </dd>
      </dl>
    </div>
  </div>
  
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started/index.html">Getting Started Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contribute/index.html">Contribution Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development_process/index.html">Development and Contribution Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../guides/build/index.html">Build and Configuration Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../application/index.html">Application Development</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../api/index.html">API Status and Guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../audio/index.html">Audio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../misc/notify.html">Asynchronous Notifications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bluetooth/index.html">Bluetooth</a></li>
<li class="toctree-l2"><a class="reference internal" href="../canbus/index.html">Controller Area Network (CAN)</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Crypto</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#api-reference">API Reference</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../devicetree/index.html">Devicetree</a></li>
<li class="toctree-l2"><a class="reference internal" href="../drivers/index.html">Device Driver Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../display/index.html">Display Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../edac/index.html">Error Detection And Correction (EDAC)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../file_system/index.html">File Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iterable_sections/index.html">Iterable Sections</a></li>
<li class="toctree-l2"><a class="reference internal" href="../misc/formatted_output.html">Formatted Output</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kernel/index.html">Kernel Services</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libc/index.html">C standard library</a></li>
<li class="toctree-l2"><a class="reference internal" href="../logging/index.html">Logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../memory_management/index.html">Memory Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../misc/index.html">Miscellaneous</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data_structures/index.html">Data Structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modbus/index.html">Modbus</a></li>
<li class="toctree-l2"><a class="reference internal" href="../networking/index.html">Networking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../peripherals/index.html">Peripherals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pinctrl/index.html">Pin Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pm/index.html">Power Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../random/index.html">Random Number Generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../resource_management/index.html">Resource Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shell/index.html">Shell</a></li>
<li class="toctree-l2"><a class="reference internal" href="../storage/index.html">Storage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../task_wdt/index.html">Task Watchdog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../misc/timeutil.html">Time Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../usb/index.html">USB device support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../usermode/index.html">User Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../util/index.html">Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../settings/index.html">Settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../timing_functions/index.html">Executing Time Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../virtualization/index.html">Virtualization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../guides/index.html">User and Developer Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../security/index.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../samples/index.html">Samples and Demos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../boards/index.html">Supported Boards</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../releases/index.html">Release Notes</a></li>
</ul>

  
  <div class="toctree-wrapper compound">
    <p class="caption"><span class="caption-text">Reference</span></p>
    <ul>
      
      <li class="toctree-l1">
        <a class="reference internal" href="/latest/doxygen/html/index.html">API</a>
      </li>
      
      <li class="toctree-l1">
        <a class="reference internal" href="/latest/reference/kconfig/index.html">Kconfig Options</a>
      </li>
      
      <li class="toctree-l1">
        <a class="reference internal" href="/latest/reference/devicetree/bindings.html">Devicetree Bindings</a>
      </li>
      
    </ul>
  </div>
  

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Zephyr Project</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
  <!-- Docs / Latest -->
  
  

  <li><a href="../../index.html">Docs / Latest</a> &raquo;</li>
  
     <li><a href="../index.html">API Reference</a> &raquo;</li>
  
  <li>Crypto</li>


  <li class="wy-breadcrumbs-aside">
    <dark-mode-toggle id="dark-mode-toggle" appearance="toggle" permanent="true"/>
  </li>
  <li class="wy-breadcrumbs-aside">
      
      
        <a href="https://github.com/zephyrproject-rtos/zephyr/blob/main/doc/reference/crypto/index.rst" class="fa fa-github"> Open on GitHub</a>
      
    
  </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
  
    <div class="wy-alert wy-alert-danger">
     This is the documentation for the latest (main) development branch of
     Zephyr. If you are looking for the documentation of previous releases, use
     the drop-down menu on the left and select the desired version.
    </div>
  
  
           <div itemprop="articleBody">
             
  <div class="section" id="crypto">
<span id="crypto-api"></span><h1>Crypto<a class="headerlink" href="#crypto" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="api-reference">
<h2>API Reference<a class="headerlink" href="#api-reference" title="Permalink to this headline">¶</a></h2>
<dl>
<dt class="sig sig-object cpp">
<span class="target" id="group__crypto__cipher"></span><em><span class="pre">group</span></em> <span class="sig-name descname"><span class="pre">crypto_cipher</span></span></dt>
<dd><p>Crypto Cipher APIs. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-defines">Defines</p>
<dl class="c macro">
<dt class="sig sig-object c" id="c.CAP_OPAQUE_KEY_HNDL">
<span class="target" id="group__crypto__cipher_1ga821c2629510aad5d591a565767d8abbd"></span><span class="sig-name descname"><span class="n"><span class="pre">CAP_OPAQUE_KEY_HNDL</span></span></span><a class="headerlink" href="#c.CAP_OPAQUE_KEY_HNDL" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.CAP_RAW_KEY">
<span class="target" id="group__crypto__cipher_1ga95fd2a144207a575b2e0d24d5d6bf85a"></span><span class="sig-name descname"><span class="n"><span class="pre">CAP_RAW_KEY</span></span></span><a class="headerlink" href="#c.CAP_RAW_KEY" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.CAP_KEY_LOADING_API">
<span class="target" id="group__crypto__cipher_1ga18aeace031f8b9bb4241b44f8b36f056"></span><span class="sig-name descname"><span class="n"><span class="pre">CAP_KEY_LOADING_API</span></span></span><a class="headerlink" href="#c.CAP_KEY_LOADING_API" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.CAP_INPLACE_OPS">
<span class="target" id="group__crypto__cipher_1ga4c00d0513306fbc511fb4828108d37c8"></span><span class="sig-name descname"><span class="n"><span class="pre">CAP_INPLACE_OPS</span></span></span><a class="headerlink" href="#c.CAP_INPLACE_OPS" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Whether the output is placed in separate buffer or not </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.CAP_SEPARATE_IO_BUFS">
<span class="target" id="group__crypto__cipher_1ga858150378de8f024e96614a6c2f138a2"></span><span class="sig-name descname"><span class="n"><span class="pre">CAP_SEPARATE_IO_BUFS</span></span></span><a class="headerlink" href="#c.CAP_SEPARATE_IO_BUFS" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.CAP_SYNC_OPS">
<span class="target" id="group__crypto__cipher_1ga469bae7c354d17ba9b22c7ce4d8e076a"></span><span class="sig-name descname"><span class="n"><span class="pre">CAP_SYNC_OPS</span></span></span><a class="headerlink" href="#c.CAP_SYNC_OPS" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>These denotes if the output (completion of a cipher_xxx_op) is conveyed by the op function returning, or it is conveyed by an async notification </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.CAP_ASYNC_OPS">
<span class="target" id="group__crypto__cipher_1ga62492a4ce9c9274c78f3a7a915a66983"></span><span class="sig-name descname"><span class="n"><span class="pre">CAP_ASYNC_OPS</span></span></span><a class="headerlink" href="#c.CAP_ASYNC_OPS" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.CAP_AUTONONCE">
<span class="target" id="group__crypto__cipher_1ga6574dce552f5ba3b6f347e260a57d2f5"></span><span class="sig-name descname"><span class="n"><span class="pre">CAP_AUTONONCE</span></span></span><a class="headerlink" href="#c.CAP_AUTONONCE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Whether the hardware/driver supports autononce feature </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.CAP_NO_IV_PREFIX">
<span class="target" id="group__crypto__cipher_1ga8fa14517853a8a1c4f134b5772f7d308"></span><span class="sig-name descname"><span class="n"><span class="pre">CAP_NO_IV_PREFIX</span></span></span><a class="headerlink" href="#c.CAP_NO_IV_PREFIX" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Don’t prefix IV to cipher blocks </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-typedefs">Typedefs</p>
<dl class="c type">
<dt class="sig sig-object c" id="c.block_op_t">
<span class="target" id="group__crypto__cipher_1ga584073236a507f736442dedab87b1e17"></span><span class="k"><span class="pre">typedef</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">block_op_t</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.cipher_ctx" title="cipher_ctx"><span class="n"><span class="pre">cipher_ctx</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.cipher_pkt" title="cipher_pkt"><span class="n"><span class="pre">cipher_pkt</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">pkt</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#c.block_op_t" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="c type">
<dt class="sig sig-object c" id="c.cbc_op_t">
<span class="target" id="group__crypto__cipher_1gaa74d09d409b42b29c4c7045dc77552d2"></span><span class="k"><span class="pre">typedef</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">cbc_op_t</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.cipher_ctx" title="cipher_ctx"><span class="n"><span class="pre">cipher_ctx</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.cipher_pkt" title="cipher_pkt"><span class="n"><span class="pre">cipher_pkt</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">pkt</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">iv</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#c.cbc_op_t" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="c type">
<dt class="sig sig-object c" id="c.ctr_op_t">
<span class="target" id="group__crypto__cipher_1gad1ed48328ca31f8ce2dd7e0a166cacba"></span><span class="k"><span class="pre">typedef</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">ctr_op_t</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.cipher_ctx" title="cipher_ctx"><span class="n"><span class="pre">cipher_ctx</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.cipher_pkt" title="cipher_pkt"><span class="n"><span class="pre">cipher_pkt</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">pkt</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctr</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#c.ctr_op_t" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="c type">
<dt class="sig sig-object c" id="c.ccm_op_t">
<span class="target" id="group__crypto__cipher_1ga55e4d15dde1a5134c695ce0c31dabaf7"></span><span class="k"><span class="pre">typedef</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">ccm_op_t</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.cipher_ctx" title="cipher_ctx"><span class="n"><span class="pre">cipher_ctx</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.cipher_aead_pkt" title="cipher_aead_pkt"><span class="n"><span class="pre">cipher_aead_pkt</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">pkt</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">nonce</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#c.ccm_op_t" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="c type">
<dt class="sig sig-object c" id="c.gcm_op_t">
<span class="target" id="group__crypto__cipher_1gad27577142dd49308b2470253a41bd09d"></span><span class="k"><span class="pre">typedef</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">gcm_op_t</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.cipher_ctx" title="cipher_ctx"><span class="n"><span class="pre">cipher_ctx</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.cipher_aead_pkt" title="cipher_aead_pkt"><span class="n"><span class="pre">cipher_aead_pkt</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">pkt</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">nonce</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#c.gcm_op_t" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="c type">
<dt class="sig sig-object c" id="c.crypto_completion_cb">
<span class="target" id="group__crypto__cipher_1ga5bca6057c7fe56b3c6de4399e78e5389"></span><span class="k"><span class="pre">typedef</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">crypto_completion_cb</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.cipher_pkt" title="cipher_pkt"><span class="n"><span class="pre">cipher_pkt</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">completed</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">status</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#c.crypto_completion_cb" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-enums">Enums</p>
<dl class="c enum">
<dt class="sig sig-object c" id="c.cipher_algo">
<span class="target" id="group__crypto__cipher_1gaa43d9907b508cb28c649aaa524d84424"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cipher_algo</span></span></span><a class="headerlink" href="#c.cipher_algo" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Cipher Algorithm </p>
<p><em>Values:</em></p>
<dl class="c enumerator">
<dt class="sig sig-object c" id="c.cipher_algo.CRYPTO_CIPHER_ALGO_AES">
<span class="target" id="group__crypto__cipher_1ggaa43d9907b508cb28c649aaa524d84424aed0c05202ecbb1496f84ec6c383ddcf0"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">CRYPTO_CIPHER_ALGO_AES</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1</span></span><a class="headerlink" href="#c.cipher_algo.CRYPTO_CIPHER_ALGO_AES" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

</dd></dl>

<dl class="c enum">
<dt class="sig sig-object c" id="c.cipher_op">
<span class="target" id="group__crypto__cipher_1ga1db3a5604bff0669672af4457aaaee21"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cipher_op</span></span></span><a class="headerlink" href="#c.cipher_op" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Cipher Operation </p>
<p><em>Values:</em></p>
<dl class="c enumerator">
<dt class="sig sig-object c" id="c.cipher_op.CRYPTO_CIPHER_OP_DECRYPT">
<span class="target" id="group__crypto__cipher_1gga1db3a5604bff0669672af4457aaaee21a1e1205f695285034b4889ac19a191617"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">CRYPTO_CIPHER_OP_DECRYPT</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#c.cipher_op.CRYPTO_CIPHER_OP_DECRYPT" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="c enumerator">
<dt class="sig sig-object c" id="c.cipher_op.CRYPTO_CIPHER_OP_ENCRYPT">
<span class="target" id="group__crypto__cipher_1gga1db3a5604bff0669672af4457aaaee21a71bf6ee186bab1729e24e37c119d0019"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">CRYPTO_CIPHER_OP_ENCRYPT</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1</span></span><a class="headerlink" href="#c.cipher_op.CRYPTO_CIPHER_OP_ENCRYPT" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

</dd></dl>

<dl class="c enum">
<dt class="sig sig-object c" id="c.cipher_mode">
<span class="target" id="group__crypto__cipher_1gaeedaf8017f8d6518f7dedef365bbae43"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cipher_mode</span></span></span><a class="headerlink" href="#c.cipher_mode" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Possible cipher mode options.</p>
<p>More to be added as required. </p>
<p><em>Values:</em></p>
<dl class="c enumerator">
<dt class="sig sig-object c" id="c.cipher_mode.CRYPTO_CIPHER_MODE_ECB">
<span class="target" id="group__crypto__cipher_1ggaeedaf8017f8d6518f7dedef365bbae43a30ffc1c7c1489f938ed8c567a4fb885e"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">CRYPTO_CIPHER_MODE_ECB</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1</span></span><a class="headerlink" href="#c.cipher_mode.CRYPTO_CIPHER_MODE_ECB" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="c enumerator">
<dt class="sig sig-object c" id="c.cipher_mode.CRYPTO_CIPHER_MODE_CBC">
<span class="target" id="group__crypto__cipher_1ggaeedaf8017f8d6518f7dedef365bbae43a98034da3b89ae5c47749c59a3b15bbfd"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">CRYPTO_CIPHER_MODE_CBC</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">2</span></span><a class="headerlink" href="#c.cipher_mode.CRYPTO_CIPHER_MODE_CBC" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="c enumerator">
<dt class="sig sig-object c" id="c.cipher_mode.CRYPTO_CIPHER_MODE_CTR">
<span class="target" id="group__crypto__cipher_1ggaeedaf8017f8d6518f7dedef365bbae43a58823b401487d57d62a067d71bd2e9d2"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">CRYPTO_CIPHER_MODE_CTR</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">3</span></span><a class="headerlink" href="#c.cipher_mode.CRYPTO_CIPHER_MODE_CTR" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="c enumerator">
<dt class="sig sig-object c" id="c.cipher_mode.CRYPTO_CIPHER_MODE_CCM">
<span class="target" id="group__crypto__cipher_1ggaeedaf8017f8d6518f7dedef365bbae43a5116e1683b8c9c26582863a65128ce3b"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">CRYPTO_CIPHER_MODE_CCM</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">4</span></span><a class="headerlink" href="#c.cipher_mode.CRYPTO_CIPHER_MODE_CCM" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

<dl class="c enumerator">
<dt class="sig sig-object c" id="c.cipher_mode.CRYPTO_CIPHER_MODE_GCM">
<span class="target" id="group__crypto__cipher_1ggaeedaf8017f8d6518f7dedef365bbae43a2f0de7c8f0b9c1a8ac7343ca3ca72c12"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">CRYPTO_CIPHER_MODE_GCM</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">5</span></span><a class="headerlink" href="#c.cipher_mode.CRYPTO_CIPHER_MODE_GCM" title="Permalink to this definition">¶</a><br /></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="c function">
<dt class="sig sig-object c" id="c.cipher_query_hwcaps">
<span class="target" id="group__crypto__cipher_1ga76fed4c6f39182b5d8b77775b1c7f4e0"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cipher_query_hwcaps</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="../drivers/index.html#c.device" title="device"><span class="n"><span class="pre">device</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">dev</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.cipher_query_hwcaps" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Query the crypto hardware capabilities. </p>
<p>This API is used by the app to query the capabilities supported by the crypto device. Based on this the app can specify a subset of the supported options to be honored for a session during <a class="reference internal" href="#group__crypto__cipher_1ga0720700438ba5819aa826aa37f0c4227"><span class="std std-ref">cipher_begin_session()</span></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dev</strong> – Pointer to the device structure for the driver instance.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>bitmask of supported options. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.cipher_begin_session">
<span class="target" id="group__crypto__cipher_1ga0720700438ba5819aa826aa37f0c4227"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cipher_begin_session</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="../drivers/index.html#c.device" title="device"><span class="n"><span class="pre">device</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">dev</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.cipher_ctx" title="cipher_ctx"><span class="n"><span class="pre">cipher_ctx</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">enum</span></span><span class="w"> </span><a class="reference internal" href="#c.cipher_algo" title="cipher_algo"><span class="n"><span class="pre">cipher_algo</span></span></a><span class="w"> </span><span class="n"><span class="pre">algo</span></span>, <span class="k"><span class="pre">enum</span></span><span class="w"> </span><a class="reference internal" href="#c.cipher_mode" title="cipher_mode"><span class="n"><span class="pre">cipher_mode</span></span></a><span class="w"> </span><span class="n"><span class="pre">mode</span></span>, <span class="k"><span class="pre">enum</span></span><span class="w"> </span><a class="reference internal" href="#c.cipher_op" title="cipher_op"><span class="n"><span class="pre">cipher_op</span></span></a><span class="w"> </span><span class="n"><span class="pre">optype</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.cipher_begin_session" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Setup a crypto session. </p>
<p>Initializes one time parameters, like the session key, algorithm and cipher mode which may remain constant for all operations in the session. The state may be cached in hardware and/or driver data state variables.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dev</strong> – Pointer to the device structure for the driver instance. </p></li>
<li><p><strong>ctx</strong> – Pointer to the context structure. Various one time parameters like key, keylength, etc. are supplied via this structure. The structure documentation specifies which fields are to be populated by the app before making this call. </p></li>
<li><p><strong>algo</strong> – The crypto algorithm to be used in this session. e.g AES </p></li>
<li><p><strong>mode</strong> – The cipher mode to be used in this session. e.g CBC, CTR </p></li>
<li><p><strong>optype</strong> – Whether we should encrypt or decrypt in this session</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>0 on success, negative errno code on fail. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.cipher_free_session">
<span class="target" id="group__crypto__cipher_1gaa818a3de1f2d6319cd21bf6b7caf7cbb"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cipher_free_session</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="../drivers/index.html#c.device" title="device"><span class="n"><span class="pre">device</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">dev</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.cipher_ctx" title="cipher_ctx"><span class="n"><span class="pre">cipher_ctx</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.cipher_free_session" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Cleanup a crypto session. </p>
<p>Clears the hardware and/or driver state of a previous session.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dev</strong> – Pointer to the device structure for the driver instance. </p></li>
<li><p><strong>ctx</strong> – Pointer to the crypto context structure of the session to be freed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>0 on success, negative errno code on fail. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.cipher_callback_set">
<span class="target" id="group__crypto__cipher_1ga27804359f0457d98ea506d5088464622"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cipher_callback_set</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="../drivers/index.html#c.device" title="device"><span class="n"><span class="pre">device</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">dev</span></span>, <a class="reference internal" href="#c.crypto_completion_cb" title="crypto_completion_cb"><span class="n"><span class="pre">crypto_completion_cb</span></span></a><span class="w"> </span><span class="n"><span class="pre">cb</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.cipher_callback_set" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Registers an async crypto op completion callback with the driver. </p>
<p>The application can register an async crypto op completion callback handler to be invoked by the driver, on completion of a prior request submitted via crypto_do_op(). Based on crypto device hardware semantics, this is likely to be invoked from an ISR context.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dev</strong> – Pointer to the device structure for the driver instance. </p></li>
<li><p><strong>cb</strong> – Pointer to application callback to be called by the driver.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>0 on success, -ENOTSUP if the driver does not support async op, negative errno code on other error. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.cipher_block_op">
<span class="target" id="group__crypto__cipher_1ga05a2569f8d404593e053ce69817a457e"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cipher_block_op</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.cipher_ctx" title="cipher_ctx"><span class="n"><span class="pre">cipher_ctx</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.cipher_pkt" title="cipher_pkt"><span class="n"><span class="pre">cipher_pkt</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">pkt</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.cipher_block_op" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Perform single-block crypto operation (ECB cipher mode). This should not be overloaded to operate on multiple blocks for security reasons. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – Pointer to the crypto context of this op. </p></li>
<li><p><strong>pkt</strong> – Structure holding the input/output buffer pointers.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>0 on success, negative errno code on fail. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.cipher_cbc_op">
<span class="target" id="group__crypto__cipher_1ga2c4ac483eb4e11110be939e669040700"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cipher_cbc_op</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.cipher_ctx" title="cipher_ctx"><span class="n"><span class="pre">cipher_ctx</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.cipher_pkt" title="cipher_pkt"><span class="n"><span class="pre">cipher_pkt</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">pkt</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">iv</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.cipher_cbc_op" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Perform Cipher Block Chaining (CBC) crypto operation. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – Pointer to the crypto context of this op. </p></li>
<li><p><strong>pkt</strong> – Structure holding the input/output buffer pointers. </p></li>
<li><p><strong>iv</strong> – Initialization Vector (IV) for the operation. Same IV value should not be reused across multiple operations (within a session context) for security.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>0 on success, negative errno code on fail. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.cipher_ctr_op">
<span class="target" id="group__crypto__cipher_1gaeffb9d5dd85bf135eb2cca6d47cb373c"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cipher_ctr_op</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.cipher_ctx" title="cipher_ctx"><span class="n"><span class="pre">cipher_ctx</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.cipher_pkt" title="cipher_pkt"><span class="n"><span class="pre">cipher_pkt</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">pkt</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">iv</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.cipher_ctr_op" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Perform Counter (CTR) mode crypto operation. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – Pointer to the crypto context of this op. </p></li>
<li><p><strong>pkt</strong> – Structure holding the input/output buffer pointers. </p></li>
<li><p><strong>iv</strong> – Initialization Vector (IV) for the operation. We use a split counter formed by appending IV and ctr. Consequently ivlen = keylen - ctrlen. ‘ctrlen’ is specified during session setup through the ‘ctx.mode_params.ctr_params.ctr_len’ parameter. IV should not be reused across multiple operations (within a session context) for security. The non-IV part of the split counter is transparent to the caller and is fully managed by the crypto provider.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>0 on success, negative errno code on fail. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.cipher_ccm_op">
<span class="target" id="group__crypto__cipher_1ga4886e7e1cc2fcff411066875b35b8b45"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cipher_ccm_op</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.cipher_ctx" title="cipher_ctx"><span class="n"><span class="pre">cipher_ctx</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.cipher_aead_pkt" title="cipher_aead_pkt"><span class="n"><span class="pre">cipher_aead_pkt</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">pkt</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">nonce</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.cipher_ccm_op" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Perform Counter with CBC-MAC (CCM) mode crypto operation. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – Pointer to the crypto context of this op. </p></li>
<li><p><strong>pkt</strong> – Structure holding the input/output, Assosciated Data (AD) and auth tag buffer pointers. </p></li>
<li><p><strong>nonce</strong> – Nonce for the operation. Same nonce value should not be reused across multiple operations (within a session context) for security.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>0 on success, negative errno code on fail. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.cipher_gcm_op">
<span class="target" id="group__crypto__cipher_1ga3706b034252e40b818a782c28ba5e485"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cipher_gcm_op</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.cipher_ctx" title="cipher_ctx"><span class="n"><span class="pre">cipher_ctx</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ctx</span></span>, <span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.cipher_aead_pkt" title="cipher_aead_pkt"><span class="n"><span class="pre">cipher_aead_pkt</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">pkt</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">nonce</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.cipher_gcm_op" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Perform Galois/Counter Mode (GCM) crypto operation. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> – Pointer to the crypto context of this op. </p></li>
<li><p><strong>pkt</strong> – Structure holding the input/output, Associated Data (AD) and auth tag buffer pointers. </p></li>
<li><p><strong>nonce</strong> – Nonce for the operation. Same nonce value should not be reused across multiple operations (within a session context) for security.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>0 on success, negative errno code on fail. </p>
</dd>
</dl>
</dd></dl>

</div>
<dl class="c struct">
<dt class="sig sig-object c" id="c.crypto_driver_api">
<span class="target" id="structcrypto__driver__api"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">crypto_driver_api</span></span></span><a class="headerlink" href="#c.crypto_driver_api" title="Permalink to this definition">¶</a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;cipher.h&gt;</em></div>
</dd></dl>

<dl class="c struct">
<dt class="sig sig-object c" id="c.cipher_ops">
<span class="target" id="structcipher__ops"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cipher_ops</span></span></span><a class="headerlink" href="#c.cipher_ops" title="Permalink to this definition">¶</a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;cipher_structs.h&gt;</em></div>
</dd></dl>

<dl class="c struct">
<dt class="sig sig-object c" id="c.ccm_params">
<span class="target" id="structccm__params"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ccm_params</span></span></span><a class="headerlink" href="#c.ccm_params" title="Permalink to this definition">¶</a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;cipher_structs.h&gt;</em></div>
</dd></dl>

<dl class="c struct">
<dt class="sig sig-object c" id="c.ctr_params">
<span class="target" id="structctr__params"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ctr_params</span></span></span><a class="headerlink" href="#c.ctr_params" title="Permalink to this definition">¶</a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;cipher_structs.h&gt;</em></div>
</dd></dl>

<dl class="c struct">
<dt class="sig sig-object c" id="c.gcm_params">
<span class="target" id="structgcm__params"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gcm_params</span></span></span><a class="headerlink" href="#c.gcm_params" title="Permalink to this definition">¶</a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;cipher_structs.h&gt;</em></div>
</dd></dl>

<dl class="c struct">
<dt class="sig sig-object c" id="c.cipher_ctx">
<span class="target" id="structcipher__ctx"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cipher_ctx</span></span></span><a class="headerlink" href="#c.cipher_ctx" title="Permalink to this definition">¶</a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;cipher_structs.h&gt;</em></div>
<p>Structure encoding session parameters.</p>
<p>Refer to comments for individual fields to know the contract in terms of who fills what and when w.r.t begin_session() call. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="c var">
<dt class="sig sig-object c" id="c.cipher_ctx.ops">
<span class="target" id="structcipher__ctx_1ae3eb86d5be42450b761f89114723b682"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.cipher_ops" title="cipher_ops"><span class="n"><span class="pre">cipher_ops</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ops</span></span></span><a class="headerlink" href="#c.cipher_ctx.ops" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Place for driver to return function pointers to be invoked per cipher operation. To be populated by crypto driver on return from begin_session() based on the algo/mode chosen by the app. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.cipher_ctx.key">
<span class="target" id="structcipher__ctx_1a94aaf97ca644ede6b3f1aca165dd1ec0"></span><span class="k"><span class="pre">union</span></span><span class="w"> </span><a class="reference internal" href="#c.cipher_ctx" title="cipher_ctx"><span class="n"><span class="pre">cipher_ctx</span></span></a><span class="p"><span class="pre">.</span></span><span class="n"><span class="pre">[anonymous]</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">key</span></span></span><a class="headerlink" href="#c.cipher_ctx.key" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>To be populated by the app before calling begin_session() </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.cipher_ctx.device">
<span class="target" id="structcipher__ctx_1a44842ea8ece2aaea4d757137cdb67b52"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.cipher_ctx.device" title="device"><span class="n"><span class="pre">device</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">device</span></span></span><a class="headerlink" href="#c.cipher_ctx.device" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The device driver instance this crypto context relates to. Will be populated by the begin_session() API. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.cipher_ctx.drv_sessn_state">
<span class="target" id="structcipher__ctx_1a624cf985cf35b3aa8681c3892fd67429"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">drv_sessn_state</span></span></span><a class="headerlink" href="#c.cipher_ctx.drv_sessn_state" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>If the driver supports multiple simultaneously crypto sessions, this will identify the specific driver state this crypto session relates to. Since dynamic memory allocation is not possible, it is suggested that at build time drivers allocate space for the max simultaneous sessions they intend to support. To be populated by the driver on return from begin_session(). </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.cipher_ctx.app_sessn_state">
<span class="target" id="structcipher__ctx_1a0439c7f7c300a59296d353e76132c028"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">app_sessn_state</span></span></span><a class="headerlink" href="#c.cipher_ctx.app_sessn_state" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Place for the user app to put info relevant stuff for resuming when completion callback happens for async ops. Totally managed by the app. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.cipher_ctx.mode_params">
<span class="target" id="structcipher__ctx_1ae39bf087a95913630046f99b5db54e63"></span><span class="k"><span class="pre">union</span></span><span class="w"> </span><a class="reference internal" href="#c.cipher_ctx" title="cipher_ctx"><span class="n"><span class="pre">cipher_ctx</span></span></a><span class="p"><span class="pre">.</span></span><span class="n"><span class="pre">[anonymous]</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mode_params</span></span></span><a class="headerlink" href="#c.cipher_ctx.mode_params" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Cypher mode parameters, which remain constant for all ops in a session. To be populated by the app before calling begin_session(). </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.cipher_ctx.keylen">
<span class="target" id="structcipher__ctx_1a10dbfc431a748118c186099c249ed5e4"></span><span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">keylen</span></span></span><a class="headerlink" href="#c.cipher_ctx.keylen" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Cryptographic keylength in bytes. To be populated by the app before calling begin_session() </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.cipher_ctx.flags">
<span class="target" id="structcipher__ctx_1a5745811b9b08e6df51f9b8f8b14ceae7"></span><span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">flags</span></span></span><a class="headerlink" href="#c.cipher_ctx.flags" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>How certain fields are to be interpreted for this session. (A bitmask of CAP_* below.) To be populated by the app before calling begin_session(). An app can obtain the capability flags supported by a hw/driver by calling <a class="reference internal" href="#group__crypto__cipher_1ga76fed4c6f39182b5d8b77775b1c7f4e0"><span class="std std-ref">cipher_query_hwcaps()</span></a>. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="c struct">
<dt class="sig sig-object c" id="c.cipher_pkt">
<span class="target" id="structcipher__pkt"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cipher_pkt</span></span></span><a class="headerlink" href="#c.cipher_pkt" title="Permalink to this definition">¶</a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;cipher_structs.h&gt;</em></div>
<p>Structure encoding IO parameters of one cryptographic operation like encrypt/decrypt.</p>
<p>The fields which has not been explicitly called out has to be filled up by the app before making the cipher_xxx_op() call. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="c var">
<dt class="sig sig-object c" id="c.cipher_pkt.in_buf">
<span class="target" id="structcipher__pkt_1a56d2de56d9efc153032eb7f6503748ba"></span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">in_buf</span></span></span><a class="headerlink" href="#c.cipher_pkt.in_buf" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Start address of input buffer </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.cipher_pkt.in_len">
<span class="target" id="structcipher__pkt_1ac5c98e7edafb4b61e01f707c785afbea"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">in_len</span></span></span><a class="headerlink" href="#c.cipher_pkt.in_len" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Bytes to be operated upon </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.cipher_pkt.out_buf">
<span class="target" id="structcipher__pkt_1ab95bae428d3d3c80b1b8ee6ea03a05d0"></span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">out_buf</span></span></span><a class="headerlink" href="#c.cipher_pkt.out_buf" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Start of the output buffer, to be allocated by the application. Can be NULL for in-place ops. To be populated with contents by the driver on return from op / async callback. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.cipher_pkt.out_buf_max">
<span class="target" id="structcipher__pkt_1a6e51f941334e87cc966f5a37e783d1fc"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">out_buf_max</span></span></span><a class="headerlink" href="#c.cipher_pkt.out_buf_max" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Size of the out_buf area allocated by the application. Drivers should not write past the size of output buffer. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.cipher_pkt.out_len">
<span class="target" id="structcipher__pkt_1abc9588a5f84f9daa13ce4aec965f0a91"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">out_len</span></span></span><a class="headerlink" href="#c.cipher_pkt.out_len" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>To be populated by driver on return from cipher_xxx_op() and holds the size of the actual result. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.cipher_pkt.ctx">
<span class="target" id="structcipher__pkt_1a26fb877d705580648da03ce95264d100"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.cipher_ctx" title="cipher_ctx"><span class="n"><span class="pre">cipher_ctx</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">ctx</span></span></span><a class="headerlink" href="#c.cipher_pkt.ctx" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Context this packet relates to. This can be useful to get the session details, especially for async ops. Will be populated by the cipher_xxx_op() API based on the ctx parameter. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="c struct">
<dt class="sig sig-object c" id="c.cipher_aead_pkt">
<span class="target" id="structcipher__aead__pkt"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cipher_aead_pkt</span></span></span><a class="headerlink" href="#c.cipher_aead_pkt" title="Permalink to this definition">¶</a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;cipher_structs.h&gt;</em></div>
<p>Structure encoding IO parameters in AEAD (Authenticated Encryption with Associated Data) scenario like in CCM.</p>
<p>App has to furnish valid contents prior to making <a class="reference internal" href="#group__crypto__cipher_1ga4886e7e1cc2fcff411066875b35b8b45"><span class="std std-ref">cipher_ccm_op()</span></a> call. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="c var">
<dt class="sig sig-object c" id="c.cipher_aead_pkt.ad">
<span class="target" id="structcipher__aead__pkt_1a1b00939c8409041b8202ae90ee01a41c"></span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">ad</span></span></span><a class="headerlink" href="#c.cipher_aead_pkt.ad" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Start address for Associated Data. This has to be supplied by app. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.cipher_aead_pkt.ad_len">
<span class="target" id="structcipher__aead__pkt_1a2964d6ffbe02b7088be9a2d5c21a2f9c"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ad_len</span></span></span><a class="headerlink" href="#c.cipher_aead_pkt.ad_len" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Size of Associated Data. This has to be supplied by the app. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.cipher_aead_pkt.tag">
<span class="target" id="structcipher__aead__pkt_1a3c7a3e72c7d21ec574dd777ac0bdf3c4"></span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">tag</span></span></span><a class="headerlink" href="#c.cipher_aead_pkt.tag" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Start address for the auth hash. For an encryption op this will be populated by the driver when it returns from cipher_ccm_op call. For a decryption op this has to be supplied by the app. </p>
</dd></dl>

</div>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
          </div>

          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; <a href="../../copyright.html">Copyright</a> 2015-2021 Zephyr Project members and individual contributors.
      <span class="lastupdated">Last updated on Feb 21, 2022.
      </span></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>