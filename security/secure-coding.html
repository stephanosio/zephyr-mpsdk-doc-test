<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Secure Coding &mdash; Zephyr Project Documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
      <link rel="stylesheet" href="../_static/tabs.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.png"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script type="module" src="../_static/js/dark-mode-toggle.min.mjs"></script>
        <script src="https://www.googletagmanager.com/gtag/js?id=UA-831873-47"></script>
        <script src="../_static/js/ga-tracker.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="next" title="Sensor Device Threat Model" href="sensor-threat.html" />
    <link rel="prev" title="Security Vulnerability Reporting" href="reporting.html" />
  <meta name="color-scheme" content="dark light">
  
  <link rel="stylesheet" href="../_static/css/light.css" type="text/css" media="(prefers-color-scheme: light)"/>
  <link rel="stylesheet" href="../_static/css/dark.css" type="text/css" media="(prefers-color-scheme: dark)"/>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html">
            <img src="../_static/logo.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                3.0.99
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
  
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Zephyr Project</span>
      v: latest
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        <dt>Document Release Versions</dt>
        
          <dd><a href="/">latest</a></dd>
        
          <dd><a href="/3.0.0/">3.0.0</a></dd>
        
          <dd><a href="/2.7.0/">2.7.0</a></dd>
        
          <dd><a href="/2.6.0/">2.6.0</a></dd>
        
          <dd><a href="/2.5.0/">2.5.0</a></dd>
        
          <dd><a href="/2.4.0/">2.4.0</a></dd>
        
          <dd><a href="/2.3.0/">2.3.0</a></dd>
        
          <dd><a href="/1.14.1/">1.14.1</a></dd>
        
      </dl>
      <dl>
        <dt>Downloads</dt>
        
        <dd><a href="/latest/zephyr.pdf">PDF</a></dd>
      </dl>
      <dl>
        <dt>zephyrproject.org Links</dt>
          <dd>
            <a href="https://www.zephyrproject.org/">Project Home</a>
          </dd>
          <dd>
            <a href="https://github.com/zephyrproject-rtos/sdk-ng/releases">SDK</a>
          </dd>
          <dd>
            <a href="https://github.com/zephyrproject-rtos/zephyr/releases">Releases</a>
          </dd>
      </dl>
    </div>
  </div>
  
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/index.html">Getting Started Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contribute/index.html">Contribution Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development_process/index.html">Development and Contribution Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/build/index.html">Build and Configuration Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../application/index.html">Application Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/index.html">User and Developer Guides</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Security</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="security-overview.html">Zephyr Security Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="reporting.html">Security Vulnerability Reporting</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Secure Coding</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction-and-scope">Introduction and Scope</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">Secure Coding</a></li>
<li class="toctree-l3"><a class="reference internal" href="#secure-development-knowledge">Secure development knowledge</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#secure-designer">Secure designer</a></li>
<li class="toctree-l4"><a class="reference internal" href="#vulnerability-knowledge">Vulnerability Knowledge</a></li>
<li class="toctree-l4"><a class="reference internal" href="#zephyr-security-subcommittee">Zephyr Security Subcommittee</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#code-review">Code Review</a></li>
<li class="toctree-l3"><a class="reference internal" href="#issues-and-bug-tracking">Issues and Bug Tracking</a></li>
<li class="toctree-l3"><a class="reference internal" href="#modifications-to-this-document">Modifications to This Document</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="sensor-threat.html">Sensor Device Threat Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="hardening-tool.html">Hardening Tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="vulnerabilities.html">Vulnerabilities</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../samples/index.html">Samples and Demos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../boards/index.html">Supported Boards</a></li>
<li class="toctree-l1"><a class="reference internal" href="../releases/index.html">Release Notes</a></li>
</ul>

  
  <div class="toctree-wrapper compound">
    <p class="caption"><span class="caption-text">Reference</span></p>
    <ul>
      
      <li class="toctree-l1">
        <a class="reference internal" href="/latest/doxygen/html/index.html">API</a>
      </li>
      
      <li class="toctree-l1">
        <a class="reference internal" href="/latest/kconfig.html">Kconfig Options</a>
      </li>
      
      <li class="toctree-l1">
        <a class="reference internal" href="/latest/reference/devicetree/bindings.html">Devicetree Bindings</a>
      </li>
      
    </ul>
  </div>
  

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Zephyr Project</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
  <!-- Docs / Latest -->
  
  

  <li><a href="../index.html">Docs / Latest</a> &raquo;</li>
  
     <li><a href="index.html">Security</a> &raquo;</li>
  
  <li>Secure Coding</li>


  <li class="wy-breadcrumbs-aside">
    <dark-mode-toggle id="dark-mode-toggle" appearance="toggle" permanent="true"/>
  </li>
  <li class="wy-breadcrumbs-aside">
      
      
        <a href="https://github.com/zephyrproject-rtos/zephyr/blob/main/doc/security/secure-coding.rst" class="fa fa-github"> Open on GitHub</a>
      
    
  </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
  
    <div class="wy-alert wy-alert-danger">
     This is the documentation for the latest (main) development branch of
     Zephyr. If you are looking for the documentation of previous releases, use
     the drop-down menu on the left and select the desired version.
    </div>
  
  
           <div itemprop="articleBody">
             
  <div class="section" id="secure-coding">
<span id="secure-code"></span><h1>Secure Coding<a class="headerlink" href="#secure-coding" title="Permalink to this headline">Â¶</a></h1>
<p>Traditionally, microcontroller-based systems have not placed much
emphasis on security.
They have usually been thought of as isolated, disconnected
from the world, and not very vulnerable, just because of the
difficulty in accessing them.  The Internet of Things has changed
this.  Now, code running on small microcontrollers often has access to
the internet, or at least to other devices (that may themselves have
vulnerabilities).  Given the volume they are often deployed at,
uncontrolled access can be devastating <a class="footnote-reference brackets" href="#attackf" id="id1">1</a>.</p>
<p>This document describes the requirements and process for ensuring
security is addressed within the Zephyr project.  All code submitted
should comply with these principles.</p>
<p>Much of this document comes from <a class="reference internal" href="security-citations.html#ciibpb" id="id2"><span>[CIIBPB]</span></a>.</p>
<div class="section" id="introduction-and-scope">
<h2>Introduction and Scope<a class="headerlink" href="#introduction-and-scope" title="Permalink to this headline">Â¶</a></h2>
<p>This document covers guidelines for the <a class="reference external" href="https://www.zephyrproject.org/">Zephyr Project</a>, from a
security perspective.  Many of the ideas contained herein are captured
from other open source efforts.</p>
<p>We begin with an overview of secure design as it relates to
Zephyr.  This is followed by
a section on <a class="reference internal" href="#secure-development-knowledge">Secure development knowledge</a>, which
gives basic requirements that a developer working on the project will
need to have.  This section gives references to other security
documents, and full details of how to write secure software are beyond
the scope of this document.  This section also describes
vulnerability knowledge that at least one of the primary developers
should have.  This knowledge will be necessary for the review process
described below this.</p>
<p>Following this is a description of the review process used to
incorporate changes into the Zephyr codebase.  This is followed by
documentation about how security-sensitive issues are handled by the
project.</p>
<p>Finally, the document covers how changes are to be made to this
document.</p>
</div>
<div class="section" id="id3">
<h2>Secure Coding<a class="headerlink" href="#id3" title="Permalink to this headline">Â¶</a></h2>
<p>Designing an open software system such as Zephyr to be secure requires
adhering to a defined set of design standards. In <a class="reference internal" href="security-citations.html#salt75" id="id4"><span>[SALT75]</span></a>, the following,
widely accepted principles for protection mechanisms are defined to
help prevent security violations and limit their impact:</p>
<ul class="simple">
<li><p><strong>Open design</strong> as a design guideline incorporates the maxim that
protection mechanisms cannot be kept secret on any system in
widespread use. Instead of relying on secret, custom-tailored
security measures, publicly accepted cryptographic algorithms and
well established cryptographic libraries shall be used.</p></li>
<li><p><strong>Economy of mechanism</strong> specifies that the underlying design of a
system shall be kept as simple and small as possible. In the context
of the Zephyr project, this can be realized, e.g., by modular code
<a class="reference internal" href="security-citations.html#paul09" id="id5"><span>[PAUL09]</span></a> and abstracted APIs.</p></li>
<li><p><strong>Complete mediation</strong> requires that each access to every object and
process needs to be authenticated first. Mechanisms to store access
conditions shall be avoided if possible.</p></li>
<li><p><strong>Fail-safe defaults</strong> defines that access is restricted by default
and permitted only in specific conditions defined by the system
protection scheme, e.g., after successful authentication.
Furthermore, default settings for services shall be chosen in a way
to provide maximum security.  This corresponds to the âSecure by
Defaultâ paradigm <a class="reference internal" href="security-citations.html#ms12" id="id6"><span>[MS12]</span></a>.</p></li>
<li><p><strong>Separation of privilege</strong> is the principle that two conditions or
more need to be satisfied before access is granted. In the context
of the Zephyr project, this could encompass split keys <a class="reference internal" href="security-citations.html#paul09" id="id7"><span>[PAUL09]</span></a>.</p></li>
<li><p><strong>Least privilege</strong> describes an access model in which each user,
program, and thread, shall have the smallest possible subset
of permissions in the system required to perform their task. This
positive security model aims to minimize the attack surface of the
system.</p></li>
<li><p><strong>Least common mechanism</strong> specifies that mechanisms common to more
than one user or process shall not be shared if not strictly
required. The example given in <a class="reference internal" href="security-citations.html#salt75" id="id8"><span>[SALT75]</span></a> is a function that should be
implemented as a shared library executed by each user and not as a
supervisor procedure shared by all users.</p></li>
<li><p><strong>Psychological acceptability</strong> requires that security features are
easy to use by the developers in order to ensure their usage and the
correctness of its application.</p></li>
</ul>
<p>In addition to these general principles, the following points are
specific to the development of a secure RTOS:</p>
<ul class="simple">
<li><p><strong>Complementary Security/Defense in Depth</strong>: do not rely on a single
threat mitigation approach. In case of the complementary security
approach, parts of the threat mitigation are performed by the
underlying platform. In case such mechanisms are not provided by the
platform, or are not trusted, a defense in depth <a class="reference internal" href="security-citations.html#ms12" id="id9"><span>[MS12]</span></a> paradigm
shall be used.</p></li>
<li><p><strong>Less commonly used services off by default</strong>: to reduce the
exposure of the system to potential attacks, features or services
shall not be enabled by default if they are only rarely used (a
threshold of 80% is given in <a class="reference internal" href="security-citations.html#ms12" id="id10"><span>[MS12]</span></a>). For the Zephyr project, this can
be realized using the configuration management. Each functionality
and module shall be represented as a configuration option and needs
to be explicitly enabled. Then, all features, protocols, and drivers
not required for a particular use case can be disabled. The user
shall be notified if low-level options and APIs are enabled but not
used by the application.</p></li>
<li><p><strong>Change management</strong>: to guarantee a traceability of changes to the
system, each change shall follow a specified process including a
change request, impact analysis, ratification, implementation, and
validation phase. In each stage, appropriate documentation shall be
provided. All commits shall be related to a bug report or change
request in the issue tracker. Commits without a valid reference
shall be denied.</p></li>
</ul>
</div>
<div class="section" id="secure-development-knowledge">
<h2>Secure development knowledge<a class="headerlink" href="#secure-development-knowledge" title="Permalink to this headline">Â¶</a></h2>
<div class="section" id="secure-designer">
<h3>Secure designer<a class="headerlink" href="#secure-designer" title="Permalink to this headline">Â¶</a></h3>
<p>The Zephyr project must have at least one primary developer who knows
how to design secure software.</p>
<p>This requires understanding the following design principles,
including the 8 principles from <a class="reference internal" href="security-citations.html#salt75" id="id11"><span>[SALT75]</span></a>:</p>
<ul class="simple">
<li><p>economy of mechanism (keep the design as simple and small as
practical, e.g., by adopting sweeping simplifications)</p></li>
<li><p>fail-safe defaults (access decisions shall deny by default, and
projectsâ installation shall be secure by default)</p></li>
<li><p>complete mediation (every access that might be limited must be
checked for authority and be non-bypassable)</p></li>
</ul>
<ul class="simple">
<li><p>open design (security mechanisms should not depend on attacker
ignorance of its design, but instead on more easily protected and
changed information like keys and passwords)</p></li>
<li><p>separation of privilege (ideally, access to important objects should
depend on more than one condition, so that defeating one protection
system wonât enable complete access. For example, multi-factor
authentication, such as requiring both a password and a hardware
token, is stronger than single-factor authentication)</p></li>
<li><p>least privilege (processes should operate with the least privilege
necessary)</p></li>
<li><p>least common mechanism (the design should minimize the mechanisms
common to more than one user and depended on by all users, e.g.,
directories for temporary files)</p></li>
<li><p>psychological acceptability (the human interface must be designed
for ease of use - designing for âleast astonishmentâ can help)</p></li>
<li><p>limited attack surface (the set of the
different points where an attacker can try to enter or extract data)</p></li>
<li><p>input validation with whitelists (inputs should typically be checked
to determine if they are valid before they are accepted; this
validation should use whitelists (which only accept known-good
values), not blacklists (which attempt to list known-bad values)).</p></li>
</ul>
</div>
<div class="section" id="vulnerability-knowledge">
<h3>Vulnerability Knowledge<a class="headerlink" href="#vulnerability-knowledge" title="Permalink to this headline">Â¶</a></h3>
<p>A âprimary developerâ in a project is anyone who is familiar with the
projectâs code base, is comfortable making changes to it, and is
acknowledged as such by most other participants in the project. A
primary developer would typically make a number of contributions over
the past year (via code, documentation, or answering questions).
Developers would typically be considered primary developers if they
initiated the project (and have not left the project more than three
years ago), have the option of receiving information on a private
vulnerability reporting channel (if there is one), can accept commits
on behalf of the project, or perform final releases of the project
software. If there is only one developer, that individual is the
primary developer.</p>
<p>At least one of the primary developers <strong>must</strong> know of common kinds of
errors that lead to vulnerabilities in this kind of software, as well
as at least one method to counter or mitigate each of them.</p>
<p>Examples (depending on the type of software) include SQL
injection, OS injection, classic buffer overflow, cross-site
scripting, missing authentication, and missing authorization. See the
<a class="reference external" href="http://cwe.mitre.org/top25/">CWE/SANS top 25</a> or <a class="reference external" href="https://www.owasp.org/index.php/Category:OWASP_Top_Ten_Project">OWASP Top 10</a> for commonly used lists.</p>
</div>
<div class="section" id="zephyr-security-subcommittee">
<h3>Zephyr Security Subcommittee<a class="headerlink" href="#zephyr-security-subcommittee" title="Permalink to this headline">Â¶</a></h3>
<p>There shall be a âZephyr Security Subcommitteeâ, responsible for
enforcing this guideline, monitoring reviews, and improving these
guidelines.</p>
<p>This team will be established according to the Zephyr Project charter.</p>
</div>
</div>
<div class="section" id="code-review">
<h2>Code Review<a class="headerlink" href="#code-review" title="Permalink to this headline">Â¶</a></h2>
<p>The Zephyr project shall use a code review system that all changes are
required to go through.  Each change shall be reviewed by at least one
primary developer that is not the author of the change.  This
developer shall determine if this change affects the security of the
system (based on their general understanding of security), and if so,
shall request the developer with vulnerability knowledge, or the
secure designer to also review the code.  Any of these individuals
shall have the ability to block the change from being merged into the
mainline code until the security issues have been addressed.</p>
</div>
<div class="section" id="issues-and-bug-tracking">
<h2>Issues and Bug Tracking<a class="headerlink" href="#issues-and-bug-tracking" title="Permalink to this headline">Â¶</a></h2>
<p>The Zephyr project shall have an issue tracking system (such as <a class="reference external" href="https://www.github.com">GitHub</a>)
that can be used to record and track defects that are found in the
system.</p>
<p>Because security issues are often sensitive, this issue tracking
system shall have a field to indicate a security issue.  Setting this
field shall result in the issue only being visible to the Zephyr Security
Subcommittee. In addition, there shall be a
field to allow the Zephyr Security Subcommittee to add additional users that will
have visibility to a given issue.</p>
<p>This embargo, or limited visibility, shall only be for a fixed
duration, with a default being a project-decided value.  However,
because security considerations are often external to the Zephyr
project itself, it may be necessary to increase this embargo time.
The time necessary shall be clearly annotated in the issue itself.</p>
<p>The list of issues shall be reviewed at least once a month by the
Zephyr Security Subcommittee.  This review should focus on
tracking the fixes, determining if any external parties need to be
notified or involved, and determining when to lift the embargo on the
issue.  The embargo should <strong>not</strong> be lifted via an automated means, but
the review team should avoid unnecessary delay in lifting issues that
have been resolved.</p>
</div>
<div class="section" id="modifications-to-this-document">
<h2>Modifications to This Document<a class="headerlink" href="#modifications-to-this-document" title="Permalink to this headline">Â¶</a></h2>
<p>Changes to this document shall be reviewed by the Zephyr Security Subcommittee,
and approved by consensus.</p>
<dl class="footnote brackets">
<dt class="label" id="attackf"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>An <a class="reference external" href="http://www.theverge.com/2016/10/21/13362354/dyn-dns-ddos-attack-cause-outage-status-explained">attack</a> resulted in a significant portion of DNS
infrastructure being taken down.</p>
</dd>
</dl>
</div>
</div>


           </div>
          </div>

          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; <a href="../copyright.html">Copyright</a> 2015-2022 Zephyr Project members and individual contributors.
      <span class="lastupdated">Last updated on Mar 05, 2022.
      </span></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>