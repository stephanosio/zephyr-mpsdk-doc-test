<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sensor Device Threat Model &mdash; Zephyr Project Documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
      <link rel="stylesheet" href="../_static/tabs.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.png"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script type="module" src="../_static/js/dark-mode-toggle.min.mjs"></script>
        <script src="https://www.googletagmanager.com/gtag/js?id=UA-831873-47"></script>
        <script src="../_static/js/ga-tracker.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="next" title="Hardening Tool" href="hardening-tool.html" />
    <link rel="prev" title="Secure Coding" href="secure-coding.html" />
  <meta name="color-scheme" content="dark light">
  
  <link rel="stylesheet" href="../_static/css/light.css" type="text/css" media="(prefers-color-scheme: light)"/>
  <link rel="stylesheet" href="../_static/css/dark.css" type="text/css" media="(prefers-color-scheme: dark)"/>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html">
            <img src="../_static/logo.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                3.0.0-rc3
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
  
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Zephyr Project</span>
      v: latest
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        <dt>Document Release Versions</dt>
        
          <dd><a href="/">latest</a></dd>
        
          <dd><a href="/2.7.0/">2.7.0</a></dd>
        
          <dd><a href="/2.6.0/">2.6.0</a></dd>
        
          <dd><a href="/2.5.0/">2.5.0</a></dd>
        
          <dd><a href="/2.4.0/">2.4.0</a></dd>
        
          <dd><a href="/2.3.0/">2.3.0</a></dd>
        
          <dd><a href="/1.14.1/">1.14.1</a></dd>
        
      </dl>
      <dl>
        <dt>Downloads</dt>
        
        <dd><a href="/latest/zephyr.pdf">PDF</a></dd>
      </dl>
      <dl>
        <dt>zephyrproject.org Links</dt>
          <dd>
            <a href="https://www.zephyrproject.org/">Project Home</a>
          </dd>
          <dd>
            <a href="https://github.com/zephyrproject-rtos/sdk-ng/releases">SDK</a>
          </dd>
          <dd>
            <a href="https://github.com/zephyrproject-rtos/zephyr/releases">Releases</a>
          </dd>
      </dl>
    </div>
  </div>
  
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/index.html">Getting Started Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contribute/index.html">Contribution Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development_process/index.html">Development and Contribution Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/build/index.html">Build and Configuration Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../application/index.html">Application Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/index.html">User and Developer Guides</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Security</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="security-overview.html">Zephyr Security Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="reporting.html">Security Vulnerability Reporting</a></li>
<li class="toctree-l2"><a class="reference internal" href="secure-coding.html">Secure Coding</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Sensor Device Threat Model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#assets">Assets</a></li>
<li class="toctree-l3"><a class="reference internal" href="#communication">Communication</a></li>
<li class="toctree-l3"><a class="reference internal" href="#other-considerations">Other Considerations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#threats">Threats</a></li>
<li class="toctree-l3"><a class="reference internal" href="#notes">Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="hardening-tool.html">Hardening Tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="vulnerabilities.html">Vulnerabilities</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../samples/index.html">Samples and Demos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../boards/index.html">Supported Boards</a></li>
<li class="toctree-l1"><a class="reference internal" href="../releases/index.html">Release Notes</a></li>
</ul>

  
  <div class="toctree-wrapper compound">
    <p class="caption"><span class="caption-text">Reference</span></p>
    <ul>
      
      <li class="toctree-l1">
        <a class="reference internal" href="/latest/doxygen/html/index.html">API</a>
      </li>
      
      <li class="toctree-l1">
        <a class="reference internal" href="/latest/reference/kconfig/index.html">Kconfig Options</a>
      </li>
      
      <li class="toctree-l1">
        <a class="reference internal" href="/latest/reference/devicetree/bindings.html">Devicetree Bindings</a>
      </li>
      
    </ul>
  </div>
  

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Zephyr Project</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
  <!-- Docs / Latest -->
  
  

  <li><a href="../index.html">Docs / Latest</a> &raquo;</li>
  
     <li><a href="index.html">Security</a> &raquo;</li>
  
  <li>Sensor Device Threat Model</li>


  <li class="wy-breadcrumbs-aside">
    <dark-mode-toggle id="dark-mode-toggle" appearance="toggle" permanent="true"/>
  </li>
  <li class="wy-breadcrumbs-aside">
      
      
        <a href="https://github.com/zephyrproject-rtos/zephyr/blob/main/doc/security/sensor-threat.rst" class="fa fa-github"> Open on GitHub</a>
      
    
  </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
  
    <div class="wy-alert wy-alert-danger">
     This is the documentation for the latest (main) development branch of
     Zephyr. If you are looking for the documentation of previous releases, use
     the drop-down menu on the left and select the desired version.
    </div>
  
  
           <div itemprop="articleBody">
             
  <div class="section" id="sensor-device-threat-model">
<span id="sensor-threat"></span><h1>Sensor Device Threat Model<a class="headerlink" href="#sensor-device-threat-model" title="Permalink to this headline">¶</a></h1>
<p>This document describes a threat model for an IoT sensor device.
Spelling out a threat model helps direct development effort, and can
be used to help prioritize these efforts as well.</p>
<p>This device contains a sensor of some type (for example temperature, or a
pressure in a pipe), which sends this data to an SoC running a
microcontroller. This microcontroller connects to a cloud service, and
relays this sensor data to this service. The cloud service is also able
to send configuration data to the device, as well as software update
images. A general diagram can be seen in Figure 1:</p>
<div class="figure align-default" id="id26">
<img alt="../_images/sensor-model.svg" src="../_images/sensor-model.svg" /><p class="caption"><span class="caption-number">Fig. 42 </span><span class="caption-text">Figure 1. Sensor General Diagram</span><a class="headerlink" href="#id26" title="Permalink to this image">¶</a></p>
</div>
<p>In this sensor device, the sensor connects with the SoC via an SPI bus,
and the SoC has a network interface that it uses to communicate with the
cloud service. The particulars of these interfaces can impact the threat
model in unexpected ways, and variants on this will need to be
considered (for example, using a separate network interface SoC
connected via some type of bus).</p>
<p>This model also focuses on communicating via the MQTT-over-TLS protocol,
as this seems to be in wide use <a class="footnote-reference brackets" href="#id23" id="id1">1</a>.</p>
<div class="section" id="assets">
<h2>Assets<a class="headerlink" href="#assets" title="Permalink to this headline">¶</a></h2>
<p>One aspect of the threat model to consider are assets involved in the
operation of the device. The following list enumerates the assets
included in this model:</p>
<ol class="arabic">
<li><p><strong>The bootloader</strong>. This is a small code/data image contained in
on-device flash that is the first code to run. In order to establish
a root of trust, this image must be immutable. This model assumes
that the SoC provides a mechanism to protect a region of the flash
from future writes, and that this will be done after this image is
programmed into the device, early in production <a class="reference internal" href="#th-imboot" id="id2"><span>[th-imboot]</span></a>.</p></li>
<li><p><strong>The application firmware image</strong>. This asset consists of the
remainder of the firmware run by the microcontroller. The distinction
is made because this part of the image will need to be updated
periodically as security vulnerabilities are discovered. Requirements
for updates to this image are:</p>
<ol class="loweralpha simple">
<li><p>The image shall only be replaced with an authorized image
<a class="reference internal" href="#th-authrepl" id="id3"><span>[th-authrepl]</span></a>.</p></li>
<li><p>When an authorized replacement image is available, the update
shall be done in a timely manner <a class="reference internal" href="#th-timely-update" id="id4"><span>[th-timely-update]</span></a>.</p></li>
<li><p>The image update shall be seen as atomic, meaning that when the
image is run, the flash shall contain either the update image in
its entirety, or the old image in its entirety
<a class="reference internal" href="#th-atomic-update" id="id5"><span>[th-atomic-update]</span></a>.</p></li>
</ol>
</li>
<li><p><strong>Root certificate list</strong>. In order to authenticate the cloud service
(server), the IoT device must have a list of root certificates that
are allowed to sign the certificate on the server. For cloud-provider
based services, this list will generally be provided by the service
provider. Because the root certificates can expire, and possibly be
revoked, this list will need to be periodically updated
<a class="reference internal" href="#th-root-certs" id="id6"><span>[th-root-certs]</span></a>, <a class="reference internal" href="#th-root-check" id="id7"><span>[th-root-check]</span></a>.</p></li>
<li><p><strong>Client secrets</strong>. To authenticate the client to the service, the
client must possess some kind of secret. This is generally a private
key, usually either an RSA key or an EC private key. When
establishing communication with the server, the device will use
this secret either as part of the TLS establishment, or to sign a
message used in the communication.</p>
<p>This secret is generally generated by the service provider, or by
software running elsewhere, and must be securely installed on the
device. Policy may dictate that this secret be replaced
periodically, which will require a way to update the client secret.
Typically, the service will allow two or three active keys to allow
this update to proceed while the old key is used.</p>
<p>These secrets must be protected from read, and the smallest amount
of code necessary shall have access to them. <a class="reference internal" href="#th-secret-storage" id="id8"><span>[th-secret-storage]</span></a></p>
</li>
<li><p><strong>Current date/time</strong>. TLS certificate verification requires
knowledge of the current date and time in order to determine if the
current time falls within the certificate’s current validity time.
Also, token based client authentication will generally require the
client to sign a message containing a time window that the token is
valid. Certificate validation requires the device’s notion of date and
time to be accurate within a day or so. Token generation generally
requires the time to be accurate within 5-10 minutes.</p>
<p>It may be possible to approximate secure time by querying an
external time server.  Secure NTP is possibly beyond the
capabilities of an IoT device.  The main risks of having incorrect
time are denial of service (the device rejects valid certificates),
and the generation of tokens with invalid times.  It could be
possible to trick the device into generating tokens that are valid in
the future, but the attacker would also have to spoof the server’s
certificate to be able to intercept this. <a class="reference internal" href="#th-time" id="id9"><span>[th-time]</span></a></p>
</li>
<li><p><strong>Sensor data</strong>. The data received from the sensor itself, and
delivered to the service shall be delivered without modification or
tampering.</p></li>
<li><p><strong>Device configuration</strong>. Various configuration data, such as the
hostname of the service to connect to, the address of a time server,
frequency and parameters of when sensor data is sent to the service,
and other need to be kept by the device. This configuration data will
need to be updated periodically as the configuration changes. Updates
should be allowed only from authorized parties. <a class="reference internal" href="#th-conf" id="id10"><span>[th-conf]</span></a></p></li>
<li><p><strong>Logs</strong>. In order to assist with analysis of security issues, the
device shall log information about security-pertinent events. IoT
devices generally have limited storage, and as such, these logs need
to be carefully selected. It may also be possible to send these log
events to the cloud service where they can be stored in a more
resource-available environment. Types of events that should be logged
include:</p>
<ol class="loweralpha simple">
<li><p><strong>Firmware image updates</strong>. The system should log the download of
new images, and when an image is successfully updated.</p></li>
<li><p><strong>Client secret changes</strong>. Changes and new client secrets should be
logged.</p></li>
<li><p><strong>Changes to the device configuration</strong>.</p></li>
</ol>
<p><a class="reference internal" href="#th-logs" id="id11"><span>[th-logs]</span></a></p>
</li>
</ol>
</div>
<div class="section" id="communication">
<h2>Communication<a class="headerlink" href="#communication" title="Permalink to this headline">¶</a></h2>
<p>In addition to assets, the threat model also considers the locations
where data or assets are communicated between entities of the system.</p>
<ol class="arabic">
<li><p><strong>Flash contents</strong>. The flash device contains several regions. The
contents of flash can be modified programmatically by the SoC’s CPU.</p>
<ol class="loweralpha">
<li><p><strong>The bootloader</strong>. As described in the Assets section, the
bootloader is a small section of the flash device containing the
code initially run. This section shall be written early in the
lifecycle of the device, and the flash device then configured to
permanently disallow modification of this section. This
configuration should also prevent modification via external
interfaces, such as JTAG or SWD debuggers.</p>
<p>The bootloader is responsible for verifying the signature of the
application image as well as updating the application image from
the update image when an update is needed.</p>
<p>The bootloader shall verify the signature of the update image
before installing it.</p>
<p>The bootloader shall only accept an update image with a newer
version number than the current image.</p>
</li>
<li><p><strong>The application image</strong>. The application image contains the code
executed during normal operation of the device. Before running
this image, the bootloader shall verify a digital signature of the
image, to avoid running an image that has been tampered with. The
flash/system shall be configured such that after the bootloader
has completed, the CPU will be unable to write to the application
image.</p></li>
<li><p><strong>The update image</strong>. This is an area of flash that holds a new
version of the application image. This image will be downloaded
and stored by the application during normal operation. When this
has completed, the application can trigger a reboot, and the
bootloader can install the new image.</p></li>
<li><p><strong>Secret storage</strong>. An area of the flash will be used to store
client secrets. This area is written and read by a subset of the
application image. The application shall be configured to
protect this area from both reads and writes by code that does
not need to have access to it, giving consideration to possible
exploits found within a majority of the application code.
Revealing the contents of the secrets would allow the attacker
to spoof this device.</p>
<p>Initial secrets shall be placed in the device during a
provisioning activity, distinct from normal operation of the
device. Later updates can be made under the direction of
communication received over a secured channel to the service.</p>
</li>
<li><p><strong>Configuration storage</strong>. There shall be an area to store other
configuration information. On resource-constrained devices, it is
allowed for this to be stored in the same region as the secret
storage, however, this adds additional code that has access to the
secret storage area, and as such, more code that must be
scrutinized.</p></li>
<li><p><strong>Log storage</strong>. The device may have an area of flash where log
events can be written.</p></li>
</ol>
</li>
<li><p><strong>Sensor/Actuator interface</strong>. In this design, the sensor or actuator
communicates with the SoC via a bus, such as SPI. The hardware design
shall be made to make intercepting this bus difficult for an attack.
Required techniques depend on the sensitivity and use of the sensor
data, and can range from having the sensor mounted on the same PCB as
the MCU to epoxy potting the entire device.</p></li>
<li><p><strong>Communication with cloud service</strong>. Communication between the
device, and the cloud service will be done over the general
internet. As such, it shall be assumed that an attacker can
arbitrarily intercept this channel and, for example, return spoofed
DNS results or attempt man-in-the-middle attacks
against communication with cloud services.</p>
<p>The device shall use TLS for all communication with the cloud
service <a class="reference internal" href="#th-all-tls" id="id12"><span>[th-all-tls]</span></a>. The TLS stack shall be configured to use only cipher suites
that are generally considered secure <a class="footnote-reference brackets" href="#id24" id="id13">2</a>, including forward
secrecy. The communication shall be secured by the following:</p>
<ol class="loweralpha simple">
<li><p><strong>Cipher suite selection</strong>. The device shall only allow
communication with generally agreed secure cipher suites
<a class="reference internal" href="#th-tls-ciphers" id="id14"><span>[th-tls-ciphers]</span></a>.</p></li>
<li><p><strong>Server certificate verification</strong>. The server presented by the
server shall be verified <a class="reference internal" href="#th-root-check" id="id15"><span>[th-root-check]</span></a>.</p>
<ol class="lowerroman simple">
<li><p><strong>Naming</strong>. The certificate shall name the host and service
the cloud service server is providing.
<a class="reference external" href="https://tools.ietf.org/html/rfc6125">RFC6125</a> describes
best practices for this. It is permissible for the device to
require the certificate to be more restrictive than as
described in this RFC, provided the service can use a
certificate that can comply.</p></li>
<li><p><strong>Path validation</strong>. The device shall verify that the
certificate chain has a valid signature path from a root
certificate contained within the device, to the certificate
presented by the service.
<a class="reference external" href="https://tools.ietf.org/html/rfc4158">RFC4158</a> describes
this is general. The device is permitted to require a more
restricted path, provided the server certificate used
complies with this restriction.</p></li>
<li><p><strong>Validity period</strong>. The validity period of all presented
certificates shall be checked against the device’s best
notion of the current time.</p></li>
</ol>
</li>
<li><p><strong>Client authentication</strong>. The client shall authenticate itself to
the service using a secret known only to that particular device.
There are several options, and the technique used is generally
mandated by the particular service provider being used
<a class="reference internal" href="#th-tls-client-auth" id="id16"><span>[th-tls-client-auth]</span></a>.</p>
<ol class="lowerroman simple">
<li><p><strong>TLS client certificates</strong>. The TLS protocol allows the
client to present a certificate, and assert its knowledge of
the secret described by that certificate. Generally, these
certificates will be stored within the service provider. These
certificates can be self-signed, or signed by a CA. Since the
service provider maintains a list of valid certificates
(mapping them to a device identity), having these certificates
signed by a CA does not add any additional security, but may
be useful in the management of these certificates.</p></li>
<li><p><strong>Token-based authentication</strong>. It is also possible for the
client to authenticate itself using the <em>password</em> field of
the MQTT CONNECT packet. However, the secret itself must not
be transmitted in this packet. Instead, a token-based
protocol, such as
<a class="reference external" href="https://tools.ietf.org/html/rfc7519">RFC7519</a>‘s JSON Web
Token (JWT) can be used. These tokens will generally have a
small validity period (e.g. 1 hour), to prevent them from
being reused if they are intercepted. The token shall not be
sent until the device has verified the identity of the server.</p></li>
</ol>
</li>
<li><p><strong>Random/Entropy source</strong>. Cryptograph communication requires the
generation of secure pseudorandom numbers. The device shall use a
modern, accepted cryptographic random-bit generator to generate
these random numbers. It shall use either a Non-Deterministic
Random Bit Generator (True RBG) implemented in hardware within the
SoC, or a Deterministic Random Bit Generator (Pseudo RBG) seeded
by an entropy source within the SoC.  Please see NIST SP 800-90A
for information on approved RBGs and NIST SP 800-90B for
information on testing a device’s entropy source <a class="reference internal" href="#th-entropy" id="id17"><span>[th-entropy]</span></a>.</p></li>
</ol>
</li>
<li><p><strong>Communication with the time service</strong>. Ideally, the device shall
contain hardware that maintains a secure time. However, most SoCs in
use do not have support for this, and it will be necessary to consult
an external time service.
<a class="reference external" href="https://tools.ietf.org/html/rfc4330">RFC4330</a> and referenced RFCs
describe the Simple Network Time Protocol that can be used to query
the current time from a network time server.</p></li>
<li><p><strong>Device lifecycle</strong>. An IoT device will have a lifecycle from
production to destruction and disposal of the device. Aspects of this
lifecycle that impact security include initial provisioning, normal
operation, re-provisioning, and destruction.</p>
<ol class="loweralpha simple">
<li><p><strong>Initial provisioning</strong>. During the initial provisioning stage,
it is necessary to program the bootloader, an initial application
image, a device secret, and initial configuration data
<a class="reference internal" href="#th-initial-provision" id="id18"><span>[th-initial-provision]</span></a>. In
addition, the bootloader flash protection shall be installed. Of
this information, only the device secret needs to differ per
device. This secret shall be securely maintained, and destroyed in
all locations outside of the device once it has been programmed
<a class="reference internal" href="#th-initial-secret" id="id19"><span>[th-initial-secret]</span></a>.</p></li>
<li><p><strong>Normal operation</strong>. Normal operation includes the behavior
described by the rest of this document.</p></li>
<li><p><strong>Re-provisioning</strong>. Sometimes it is necessary to re-provision a
device, such as for a different application. One way to do this is
to keep the same device secret, and replace the configuration
data, as well as the cloud service data associated with the
device. It is also possible to program a new device secret, but if
this is done it shall be done securely, and the new secret
destroyed externally once programmed into the device
<a class="reference internal" href="#th-reprovision" id="id20"><span>[th-reprovision]</span></a>.</p></li>
<li><p><strong>Destruction</strong>. To prevent the device secret from being used to
spoof the device, upon decommissioning, the secret for a
particular device shall be rendered ineffective
<a class="reference internal" href="#th-destruction" id="id21"><span>[th-destruction]</span></a>. Possibilities include:</p>
<ol class="lowerroman simple">
<li><p>Hardware destruction of the device.</p></li>
<li><p>Securely wiping the flash area containing the
secret <a class="footnote-reference brackets" href="#id25" id="id22">3</a>.</p></li>
<li><p>Removing the device identity and certificate from the
service.</p></li>
</ol>
</li>
</ol>
</li>
</ol>
</div>
<div class="section" id="other-considerations">
<h2>Other Considerations<a class="headerlink" href="#other-considerations" title="Permalink to this headline">¶</a></h2>
<p>In addition to the above, network connected devices generally will need
a way to configure them to connect to the network environment they are
placed in. There are numerous ways of doing this, and it is important
for these configuration methods to not circumvent the security
requirements described above.</p>
</div>
<div class="section" id="threats">
<h2>Threats<a class="headerlink" href="#threats" title="Permalink to this headline">¶</a></h2>
<dl class="citation">
<dt class="label" id="th-imboot"><span class="brackets"><a class="fn-backref" href="#id2">th-imboot</a></span></dt>
<dd><p>Must boot with an immutable bootloader.</p>
</dd>
<dt class="label" id="th-authrepl"><span class="brackets"><a class="fn-backref" href="#id3">th-authrepl</a></span></dt>
<dd><p>Application image shall only be replaced with an
authorized image.</p>
</dd>
<dt class="label" id="th-timely-update"><span class="brackets"><a class="fn-backref" href="#id4">th-timely-update</a></span></dt>
<dd><p>Application updates shall be done in a timely manner.</p>
</dd>
<dt class="label" id="th-atomic-update"><span class="brackets"><a class="fn-backref" href="#id5">th-atomic-update</a></span></dt>
<dd><p>Application updates shall be atomic.</p>
</dd>
<dt class="label" id="th-root-certs"><span class="brackets"><a class="fn-backref" href="#id6">th-root-certs</a></span></dt>
<dd><p>TLS must have a list of trusted root certificates.</p>
</dd>
<dt class="label" id="th-root-check"><span class="brackets">th-root-check</span><span class="fn-backref">(<a href="#id7">1</a>,<a href="#id15">2</a>)</span></dt>
<dd><p>TLS must verify root certificate from server is valid.</p>
</dd>
<dt class="label" id="th-secret-storage"><span class="brackets"><a class="fn-backref" href="#id8">th-secret-storage</a></span></dt>
<dd><p>There must be a mechanism to securely store client secrets.  The
least amount of code necessary shall have access to these secrets.</p>
</dd>
<dt class="label" id="th-time"><span class="brackets"><a class="fn-backref" href="#id9">th-time</a></span></dt>
<dd><p>System must have moderately accurate notion of the current
date/time.</p>
</dd>
<dt class="label" id="th-conf"><span class="brackets"><a class="fn-backref" href="#id10">th-conf</a></span></dt>
<dd><p>The system must receive, and keep configuration data.</p>
</dd>
<dt class="label" id="th-logs"><span class="brackets"><a class="fn-backref" href="#id11">th-logs</a></span></dt>
<dd><p>The system must log security-related events, and either store them
locally, or send to a service.</p>
</dd>
<dt class="label" id="th-all-tls"><span class="brackets"><a class="fn-backref" href="#id12">th-all-tls</a></span></dt>
<dd><p>All communications with the cloud service shall use TLS.</p>
</dd>
<dt class="label" id="th-tls-ciphers"><span class="brackets"><a class="fn-backref" href="#id14">th-tls-ciphers</a></span></dt>
<dd><p>TLS shall be configured to allow only generally agreed cipher
suites (including forward secrecy).</p>
</dd>
<dt class="label" id="th-tls-client-auth"><span class="brackets"><a class="fn-backref" href="#id16">th-tls-client-auth</a></span></dt>
<dd><p>The device shall authenticate itself with the cloud provider using
one of the methods described.</p>
</dd>
<dt class="label" id="th-entropy"><span class="brackets"><a class="fn-backref" href="#id17">th-entropy</a></span></dt>
<dd><p>The TLS layer shall use a modern, accepted cryptographic random-bit
generator seeded by an entropy source within the SoC.</p>
</dd>
<dt class="label" id="th-initial-provision"><span class="brackets"><a class="fn-backref" href="#id18">th-initial-provision</a></span></dt>
<dd><p>The device shall have a per-device secret loaded before deployment.</p>
</dd>
<dt class="label" id="th-initial-secret"><span class="brackets"><a class="fn-backref" href="#id19">th-initial-secret</a></span></dt>
<dd><p>The initial secret shall be securely maintained, and destroyed in
any external location as soon as the device is provisioned.</p>
</dd>
<dt class="label" id="th-reprovision"><span class="brackets"><a class="fn-backref" href="#id20">th-reprovision</a></span></dt>
<dd><p>Reprovisioning a device shall be done securely.</p>
</dd>
<dt class="label" id="th-destruction"><span class="brackets"><a class="fn-backref" href="#id21">th-destruction</a></span></dt>
<dd><p>Upon decommissioning, the device secret shall be rendered
ineffective.</p>
</dd>
</dl>
</div>
<div class="section" id="notes">
<h2>Notes<a class="headerlink" href="#notes" title="Permalink to this headline">¶</a></h2>
<dl class="footnote brackets">
<dt class="label" id="id23"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>See <a class="reference external" href="https://www.slideshare.net/kartben/iot-developer-survey-2018">https://www.slideshare.net/kartben/iot-developer-survey-2018</a>. As
of this writing, the three major cloud IoT service providers, AWS
IoT, Google Cloud IoT, and Microsoft Azure IoT all provide MQTT over
TLS. Some feedback has suggested that some find difficulty with UDP
protocols and routing issues on various networks.</p>
</dd>
<dt class="label" id="id24"><span class="brackets"><a class="fn-backref" href="#id13">2</a></span></dt>
<dd><p>As new exploits are discovered, what is considered secure can
change.
Organizations such as <a class="reference external" href="https://www.ssllabs.com/">https://www.ssllabs.com/</a> provide information on
current ideas of how TLS must be configured to be secure.</p>
</dd>
<dt class="label" id="id25"><span class="brackets"><a class="fn-backref" href="#id22">3</a></span></dt>
<dd><p>Note that merely erasing this flash area is unlikely to be
sufficient.</p>
</dd>
</dl>
</div>
</div>


           </div>
          </div>

          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; <a href="../copyright.html">Copyright</a> 2015-2021 Zephyr Project members and individual contributors.
      <span class="lastupdated">Last updated on Feb 21, 2022.
      </span></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>