<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Zephyr Security Overview &mdash; Zephyr Project Documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
      <link rel="stylesheet" href="../_static/tabs.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.png"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script type="module" src="../_static/js/dark-mode-toggle.min.mjs"></script>
        <script src="https://www.googletagmanager.com/gtag/js?id=UA-831873-47"></script>
        <script src="../_static/js/ga-tracker.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="next" title="Security Vulnerability Reporting" href="reporting.html" />
    <link rel="prev" title="Security" href="index.html" />
  <meta name="color-scheme" content="dark light">
  
  <link rel="stylesheet" href="../_static/css/light.css" type="text/css" media="(prefers-color-scheme: light)"/>
  <link rel="stylesheet" href="../_static/css/dark.css" type="text/css" media="(prefers-color-scheme: dark)"/>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html">
            <img src="../_static/logo.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                3.0.99
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
  
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Zephyr Project</span>
      v: latest
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        <dt>Document Release Versions</dt>
        
          <dd><a href="/">latest</a></dd>
        
          <dd><a href="/3.0.0/">3.0.0</a></dd>
        
          <dd><a href="/2.7.0/">2.7.0</a></dd>
        
          <dd><a href="/2.6.0/">2.6.0</a></dd>
        
          <dd><a href="/2.5.0/">2.5.0</a></dd>
        
          <dd><a href="/2.4.0/">2.4.0</a></dd>
        
          <dd><a href="/2.3.0/">2.3.0</a></dd>
        
          <dd><a href="/1.14.1/">1.14.1</a></dd>
        
      </dl>
      <dl>
        <dt>Downloads</dt>
        
        <dd><a href="/latest/zephyr.pdf">PDF</a></dd>
      </dl>
      <dl>
        <dt>zephyrproject.org Links</dt>
          <dd>
            <a href="https://www.zephyrproject.org/">Project Home</a>
          </dd>
          <dd>
            <a href="https://github.com/zephyrproject-rtos/sdk-ng/releases">SDK</a>
          </dd>
          <dd>
            <a href="https://github.com/zephyrproject-rtos/zephyr/releases">Releases</a>
          </dd>
      </dl>
    </div>
  </div>
  
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/index.html">Getting Started Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contribute/index.html">Contribution Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development_process/index.html">Development and Contribution Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/build/index.html">Build and Configuration Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../application/index.html">Application Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/index.html">User and Developer Guides</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Security</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Zephyr Security Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction">Introduction</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#overview-and-scope">Overview and Scope</a></li>
<li class="toctree-l4"><a class="reference internal" href="#intended-audience">Intended Audience</a></li>
<li class="toctree-l4"><a class="reference internal" href="#nomenclature">Nomenclature</a></li>
<li class="toctree-l4"><a class="reference internal" href="#security-document-update">Security Document Update</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#current-security-definition">Current Security Definition</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#security-functionality">Security Functionality</a></li>
<li class="toctree-l4"><a class="reference internal" href="#quality-assurance">Quality Assurance</a></li>
<li class="toctree-l4"><a class="reference internal" href="#execution-protection">Execution Protection</a></li>
<li class="toctree-l4"><a class="reference internal" href="#system-level-security-ecosystem">System Level Security (Ecosystem, …)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#secure-development-process">Secure Development Process</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#system-architecture">System Architecture</a></li>
<li class="toctree-l4"><a class="reference internal" href="#secure-coding">Secure Coding</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id9">Quality Assurance</a></li>
<li class="toctree-l4"><a class="reference internal" href="#release-and-lifecycle-management">Release and Lifecycle Management</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#secure-design">Secure Design</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#security-architecture">Security Architecture</a></li>
<li class="toctree-l4"><a class="reference internal" href="#security-vulnerability-reporting">Security Vulnerability Reporting</a></li>
<li class="toctree-l4"><a class="reference internal" href="#threat-modeling-and-mitigation">Threat Modeling and Mitigation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#vulnerability-analyses">Vulnerability Analyses</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#security-certification">Security Certification</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#generic-certification-process">Generic Certification Process</a></li>
<li class="toctree-l4"><a class="reference internal" href="#certification-options">Certification Options</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="reporting.html">Security Vulnerability Reporting</a></li>
<li class="toctree-l2"><a class="reference internal" href="secure-coding.html">Secure Coding</a></li>
<li class="toctree-l2"><a class="reference internal" href="sensor-threat.html">Sensor Device Threat Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="hardening-tool.html">Hardening Tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="vulnerabilities.html">Vulnerabilities</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../samples/index.html">Samples and Demos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../boards/index.html">Supported Boards</a></li>
<li class="toctree-l1"><a class="reference internal" href="../releases/index.html">Release Notes</a></li>
</ul>

  
  <div class="toctree-wrapper compound">
    <p class="caption"><span class="caption-text">Reference</span></p>
    <ul>
      
      <li class="toctree-l1">
        <a class="reference internal" href="/latest/doxygen/html/index.html">API</a>
      </li>
      
      <li class="toctree-l1">
        <a class="reference internal" href="/latest/kconfig.html">Kconfig Options</a>
      </li>
      
      <li class="toctree-l1">
        <a class="reference internal" href="/latest/reference/devicetree/bindings.html">Devicetree Bindings</a>
      </li>
      
    </ul>
  </div>
  

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Zephyr Project</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
  <!-- Docs / Latest -->
  
  

  <li><a href="../index.html">Docs / Latest</a> &raquo;</li>
  
     <li><a href="index.html">Security</a> &raquo;</li>
  
  <li>Zephyr Security Overview</li>


  <li class="wy-breadcrumbs-aside">
    <dark-mode-toggle id="dark-mode-toggle" appearance="toggle" permanent="true"/>
  </li>
  <li class="wy-breadcrumbs-aside">
      
      
        <a href="https://github.com/zephyrproject-rtos/zephyr/blob/main/doc/security/security-overview.rst" class="fa fa-github"> Open on GitHub</a>
      
    
  </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
  
    <div class="wy-alert wy-alert-danger">
     This is the documentation for the latest (main) development branch of
     Zephyr. If you are looking for the documentation of previous releases, use
     the drop-down menu on the left and select the desired version.
    </div>
  
  
           <div itemprop="articleBody">
             
  <div class="section" id="zephyr-security-overview">
<span id="security-overview"></span><h1>Zephyr Security Overview<a class="headerlink" href="#zephyr-security-overview" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>This document outlines the steps of the Zephyr Security Subcommittee towards a
defined security process that helps developers build more secure
software while addressing security compliance requirements. It presents
the key ideas of the security process and outlines which documents need
to be created. After the process is implemented and all supporting
documents are created, this document is a top-level overview and entry
point.</p>
<div class="section" id="overview-and-scope">
<h3>Overview and Scope<a class="headerlink" href="#overview-and-scope" title="Permalink to this headline">¶</a></h3>
<p>We begin with an overview of the Zephyr development process, which
mainly focuses on security functionality.</p>
<p>In subsequent sections, the individual parts of the process are treated
in detail. As depicted in Figure 1, these main steps are:</p>
<ol class="arabic simple">
<li><p><strong>Secure Development:</strong> Defines the system architecture and
development process that ensures adherence to relevant coding
principles and quality assurance procedures.</p></li>
<li><p><strong>Secure Design:</strong> Defines security procedures and implement measures
to enforce them. A security architecture of the system and
relevant sub-modules is created, threats are identified, and
countermeasures designed. Their correct implementation and the
validity of the threat models are checked by code reviews.
Finally, a process shall be defined for reporting, classifying,
and mitigating security issues..</p></li>
<li><p><strong>Security Certification:</strong> Defines the certifiable part of the
Zephyr RTOS. This includes an evaluation target, its assets, and
how these assets are protected. Certification claims shall be
determined and backed with appropriate evidence.</p></li>
</ol>
<div class="figure align-default" id="id18">
<img alt="../_images/security-process-steps.png" src="../_images/security-process-steps.png" />
<p class="caption"><span class="caption-number">Fig. 40 </span><span class="caption-text">Figure 1. Security Process Steps</span><a class="headerlink" href="#id18" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="intended-audience">
<h3>Intended Audience<a class="headerlink" href="#intended-audience" title="Permalink to this headline">¶</a></h3>
<p>This document is a guideline for the development of a security process
by the Zephyr Security Subcommittee and the Zephyr Technical Steering
Committee. It provides an overview of the Zephyr security process for
(security) engineers and architects.</p>
</div>
<div class="section" id="nomenclature">
<h3>Nomenclature<a class="headerlink" href="#nomenclature" title="Permalink to this headline">¶</a></h3>
<p>In this document, the keywords “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”,
“SHALL NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “MAY”, and
“OPTIONAL” are to be interpreted as described in <a class="reference internal" href="security-citations.html#rfc2119" id="id1"><span>[RFC2119]</span></a>.</p>
<p>These words are used to define absolute requirements (or prohibitions),
highly recommended requirements, and truly optional requirements. As
noted in RFC-2119, “These terms are frequently used to specify behavior
with security implications. The effects on security of not implementing
a MUST or SHOULD, or doing something the specification says MUST NOT or
SHOULD NOT be done may be very subtle. Document authors should take the
time to elaborate the security implications of not following
recommendations or requirements as most implementors will not have had
the benefit of the experience and discussion that produced the
specification.”</p>
</div>
<div class="section" id="security-document-update">
<h3>Security Document Update<a class="headerlink" href="#security-document-update" title="Permalink to this headline">¶</a></h3>
<p>This document is a living document. As new requirements, features, and
changes are identified, they will be added to this document through the
following process:</p>
<ol class="arabic simple">
<li><p>Changes will be submitted from the interested party(ies) via pull
requests to the Zephyr documentation repository.</p></li>
<li><p>The Zephyr Security Subcommittee will review these changes and provide feedback
or acceptance of the changes.</p></li>
<li><p>Once accepted, these changes will become part of the document.</p></li>
</ol>
</div>
</div>
<div class="section" id="current-security-definition">
<h2>Current Security Definition<a class="headerlink" href="#current-security-definition" title="Permalink to this headline">¶</a></h2>
<p>This section recapitulates the current status of secure development
within the Zephyr RTOS. Currently, focus is put on functional security
and code quality assurance, although additional security features are
scoped.</p>
<p>The three major security measures currently implemented are:</p>
<ul class="simple">
<li><p><strong>Security</strong> <strong>Functionality</strong> with a focus on cryptographic
algorithms and protocols. Support for cryptographic hardware is
scoped for future releases.The Zephyr runtime architecture is a
monolithic binary and removes the need for dynamic loaders ,
thereby reducing the exposed attack surface.</p></li>
<li><p><strong>Quality Assurance</strong> is driven by using a development process that
requires all code to be reviewed before being committed to the
common repository. Furthermore, the reuse of proven building
blocks such as network stacks increases the overall quality level
and guarantees stable APIs. Static code analyses are provided by
Coverity Scan.</p></li>
<li><p><strong>Execution Protection</strong> including thread separation, stack and
memory protection is currently available in the upstream
Zephyr RTOS starting with version 1.9.0 (stack protection).  Memory
protection and thread separation was added in version 1.10.0 for X86
and in version 1.11.0 for ARM and ARC.</p></li>
</ul>
<p>These topics are discussed in more detail in the following subsections.</p>
<div class="section" id="security-functionality">
<h3>Security Functionality<a class="headerlink" href="#security-functionality" title="Permalink to this headline">¶</a></h3>
<p>The security functionality in Zephyr hinges mainly on the inclusion of
cryptographic algorithms, and on its monolithic system design.</p>
<p>The cryptographic features are provided through a set of cryptographic
libraries. Applications can choose TinyCrypt2 or mbedTLS based on their
needs. TinyCrypt2 supports key cryptographic algorithms required by the
connectivity stacks. Tinycrypt2, however, only provides a limited set of
algorithms. mbedTLS supports a wider range of algorithms, but at the
cost of additional requirements such as malloc support. Applications can
choose the solution that matches their individual requirements. Future
work may include APIs to abstract the underlying crypto library choice.</p>
<p>APIs for vendor specific cryptographic IPs in both hardware and software
are planned, including secure key storage in the form of secure access
modules (SAMs), Trusted Platform Modules (TPMs), and
Trusted Execution Environments (TEEs).</p>
<p>The security architecture is based on a monolithic design where the
Zephyr kernel and all applications are compiled into a single static
binary. System calls are implemented as function calls without requiring
context switches. Static linking eliminates the potential for
dynamically loading malicious code.</p>
<p>Additional protection features are available in later releases.  Stack
protection mechanisms are provided to protect against stack overruns.
In addition, applications can take advantage of thread separation
features to split the system into privileged and unprivileged execution
environments.  Memory protection features provide the capability to
partition system resources (memory, peripheral address space, etc) and
assign resources to individual threads or groups of threads.  Stack,
thread execution level, and memory protection constraints are enforced
at the time of context switch.</p>
</div>
<div class="section" id="quality-assurance">
<h3>Quality Assurance<a class="headerlink" href="#quality-assurance" title="Permalink to this headline">¶</a></h3>
<p>The Zephyr project uses an automated quality assurance process. The goal
is to have a process including mandatory code reviews, feature and issue
management/tracking, and static code analyses.</p>
<p>Code reviews are documented and enforced using a voting system before
getting checked into the repository by the responsible subsystem’s
maintainer. The main goals of the code review are:</p>
<ul class="simple">
<li><p>Verifying correct functionality of the implementation</p></li>
<li><p>Increasing the readability and maintainability of the contributed
source code</p></li>
<li><p>Ensuring appropriate usage of string and memory functions</p></li>
<li><p>Validation of the user input</p></li>
<li><p>Reviewing the security relevant code for potential issues</p></li>
</ul>
<p>The current coding principles focus mostly on coding styles and
conventions. Functional correctness is ensured by the build system and
the experience of the reviewer. Especially for security relevant code,
concrete and detailed guidelines need to be developed and aligned with
the developers (see: <a class="reference internal" href="secure-coding.html#secure-code"><span class="std std-ref">Secure Coding</span></a>).</p>
<p>Static code analyses are run on the Zephyr code tree on a regular basis
using the open source Coverity Scan tool. Coverity Scan now includes
complexity analysis.</p>
<p>Bug and issue tracking and management is performed using Jira. The term
“survivability” was coined to cover pro-active security tasks such as
security issue categorization and management. Initial effort has been
started on the definition of vulnerability categorization and mitigation
processes within Jira.</p>
<p>Issues determined by Coverity should have more stringent reviews before
they are closed as non issues (at least another person educated in
security processes need to agree on non-issue before closing).</p>
<p>A security subcommittee has been formed to develop a security process in
more detail; this document is part of that process.</p>
</div>
<div class="section" id="execution-protection">
<h3>Execution Protection<a class="headerlink" href="#execution-protection" title="Permalink to this headline">¶</a></h3>
<p>Execution protection is supported and can be categorized into the
following tasks:</p>
<ul class="simple">
<li><p><strong>Memory separation:</strong> Memory will be partitioned into regions and
assigned attributes based on the owner of that region of memory.
Threads will only have access to regions they control.</p></li>
<li><p><strong>Stack protection:</strong> Stack guards would provide mechanisms for
detecting and trapping stack overruns. Individual threads should
only have access to their own stacks.</p></li>
<li><p><strong>Thread separation:</strong> Individual threads should only have access to
their own memory resources. As threads are scheduled, only memory
resources owned by that thread will be accessible. Topics such as
program flow protection and other measures for tamper resistance
are currently not in scope.</p></li>
</ul>
</div>
<div class="section" id="system-level-security-ecosystem">
<h3>System Level Security (Ecosystem, …)<a class="headerlink" href="#system-level-security-ecosystem" title="Permalink to this headline">¶</a></h3>
<p>System level security encompasses a wide variety of categories. Some
examples of these would be:</p>
<ul class="simple">
<li><p>Secure/trusted boot</p></li>
<li><p>Over the air (OTA) updates</p></li>
<li><p>External Communication</p></li>
<li><p>Device authentication</p></li>
<li><p>Access control of onboard resources</p>
<ul>
<li><p>Flash updating</p></li>
<li><p>Secure storage</p></li>
<li><p>Peripherals</p></li>
</ul>
</li>
<li><p>Root of trust</p></li>
<li><p>Reduction of attack surface</p></li>
</ul>
<p>Some of these categories are interconnected and rely on multiple pieces
to be in place to produce a full solution for the application.</p>
</div>
</div>
<div class="section" id="secure-development-process">
<h2>Secure Development Process<a class="headerlink" href="#secure-development-process" title="Permalink to this headline">¶</a></h2>
<p>The development of secure code shall adhere to certain criteria. These
include coding guidelines and development processes that can be roughly
separated into two categories related to software quality and related to
software security. Furthermore, a system architecture document shall be
created and kept up-to-date with future development.</p>
<div class="section" id="system-architecture">
<h3>System Architecture<a class="headerlink" href="#system-architecture" title="Permalink to this headline">¶</a></h3>
<div class="figure align-default" id="id19">
<img alt="../_images/security-zephyr-system-architecture.png" src="../_images/security-zephyr-system-architecture.png" />
<p class="caption"><span class="caption-number">Fig. 41 </span><span class="caption-text">Figure 2: Zephyr System Architecture</span><a class="headerlink" href="#id19" title="Permalink to this image">¶</a></p>
</div>
<p>A high-level schematic of the Zephyr system architecture is given in
Figure 2. It separates the architecture into an OS part (<em>kernel + OS
Services</em>) and a user-specific part (<em>Application Services</em>). The OS
part itself contains low-level, platform specific drivers and the
generic implementation of I/O APIs, file systems, kernel-specific
functions, and the cryptographic library.</p>
<p>A document describing the system architecture and design choices shall
be created and kept up to date with future development. This document
shall include the base architecture of the Zephyr OS and an overview of
important submodules. For each of the modules, a dedicated architecture
document shall be created and evaluated against the implementation.
These documents shall serve as an entry point to new developers and as a
basis for the security architecture. Please refer to the
<a class="reference internal" href="../reference/index.html#api-reference"><span class="std std-ref">Zephyr subsystem documentation</span></a> for
detailed information.</p>
</div>
<div class="section" id="secure-coding">
<h3>Secure Coding<a class="headerlink" href="#secure-coding" title="Permalink to this headline">¶</a></h3>
<p>Designing an open software system such as Zephyr to be secure requires
adhering to a defined set of design standards. These standards are
included in the Zephyr Project documentation, specifically in its
<a class="reference internal" href="secure-coding.html#secure-code"><span class="std std-ref">Secure Coding</span></a> section. In <a class="reference internal" href="security-citations.html#salt75" id="id2"><span>[SALT75]</span></a>, the following, widely
accepted principles for protection mechanisms are defined to prevent
security violations and limit their impact:</p>
<ul class="simple">
<li><p><strong>Open design</strong> as a design principle incorporates the maxim that
protection mechanisms cannot be kept secret on any system in
widespread use. Instead of relying on secret, custom-tailored
security measures, publicly accepted cryptographic algorithms and
well established cryptographic libraries shall be used.</p></li>
<li><p><strong>Economy of mechanism</strong> specifies that the underlying design of a
system shall be kept as simple and small as possible. In the
context of the Zephyr project, this can be realized, e.g., by
modular code <a class="reference internal" href="security-citations.html#paul09" id="id3"><span>[PAUL09]</span></a> and abstracted APIs.</p></li>
<li><p><strong>Complete mediation</strong> requires that each access to every object and
process needs to be authenticated first. Mechanisms to store
access conditions shall be avoided if possible.</p></li>
<li><p><strong>Fail-safe defaults</strong> defines that access is restricted by default
and permitted only in specific conditions defined by the system
protection scheme, e.g., after successful authentication.
Furthermore, default settings for services shall be chosen in a
way to provide maximum security. This corresponds to the “Secure
by Default” paradigm <a class="reference internal" href="security-citations.html#ms12" id="id4"><span>[MS12]</span></a>.</p></li>
<li><p><strong>Separation of privilege</strong> is the principle that two conditions or
more need to be satisfied before access is granted. In the
context of the Zephyr project, this could encompass split keys
<a class="reference internal" href="security-citations.html#paul09" id="id5"><span>[PAUL09]</span></a>.</p></li>
<li><p><strong>Least privilege</strong> describes an access model in which each user,
program and thread shall have the smallest possible
subset of permissions in the system required to perform their
task. This positive security model aims to minimize the attack
surface of the system.</p></li>
<li><p><strong>Least common mechanism</strong> specifies that mechanisms common to more
than one user or process shall not be shared if not strictly
required. The example given in <a class="reference internal" href="security-citations.html#salt75" id="id6"><span>[SALT75]</span></a> is a function that should
be implemented as a shared library executed by each user and not
as a supervisor procedure shared by all users.</p></li>
<li><p><strong>Psychological acceptability</strong> requires that security features are
easy to use by the developers in order to ensure its usage and
the correctness of its application.</p></li>
</ul>
<p>In addition to these general principles, the following points are
specific to the development of a secure RTOS:</p>
<ul class="simple">
<li><p><strong>Complementary Security/Defense in Depth:</strong> do not rely on a single
threat mitigation approach. In case of the complementary security
approach, parts of the threat mitigation are performed by the
underlying platform. In case such mechanisms are not provided by
the platform, or are not trusted, a defense in depth <a class="reference internal" href="security-citations.html#ms12" id="id7"><span>[MS12]</span></a>
paradigm shall be used.</p></li>
<li><p><strong>Less commonly used services off by default</strong>: to reduce the
exposure of the system to potential attacks, features or services
shall not be enabled by default if they are only rarely used (a
threshold of 80% is given in <a class="reference internal" href="security-citations.html#ms12" id="id8"><span>[MS12]</span></a>). For the Zephyr project,
this can be realized using the configuration management. Each
functionality and module shall be represented as a configuration
option and needs to be explicitly enabled. Then, all features,
protocols, and drivers not required for a particular use case can
be disabled. The user shall be notified if low-level options and
APIs are enabled but not used by the application.</p></li>
<li><p><strong>Change management:</strong> to guarantee a traceability of changes to the
system, each change shall follow a specified process including a
change request, impact analysis, ratification, implementation,
and validation phase. In each stage, appropriate documentation
shall be provided. All commits shall be related to a bug report
or change request in the issue tracker. Commits without a valid
reference shall be denied.</p></li>
</ul>
<p>Based on these design principles and commonly accepted best practices, a
secure development guide shall be developed, published, and implemented
into the Zephyr development process. Further details on this are given
in the <a class="reference internal" href="#secure-design">Secure Design</a> section.</p>
</div>
<div class="section" id="id9">
<h3>Quality Assurance<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h3>
<p>The quality assurance part encompasses the following criteria:</p>
<ul class="simple">
<li><p><strong>Adherence to the Coding Conventions</strong> with respect to coding style,
naming schemes of modules, functions, variables, and so forth.
This increases the readability of the Zephyr code base and eases
the code review. These coding conventions are enforced by
automated scripts prior to check-in.</p></li>
<li><p><strong>Adherence to Deployment Guidelines</strong> is required to ensure
consistent releases with a well-documented feature set and a
trackable list of security issues.</p></li>
<li><p><strong>Code Reviews</strong> ensure the functional correctness of the code base
and shall be performed on each proposed code change prior to
check-in. Code reviews shall be performed by at least one
independent reviewer other than the author(s) of the code change.
These reviews shall be performed by the subsystem maintainers and
developers on a functional level and are to be distinguished from
security reviews as laid out in the <a class="reference internal" href="#secure-design">Secure Design</a> section.
Refer to the <a class="reference internal" href="../development_process/index.html#development-model"><span class="std std-ref">Development and Contribution Process</span></a> documentation for more information.</p></li>
<li><p><strong>Static Code Analysis</strong> tools efficiently detect common coding
mistakes in large code bases. All code shall be analyzed using an
appropriate tool prior to merges into the main repository. This
is not per individual commit, but is to be run on some interval
on specific branches. It is mandatory to remove all findings or
waive potential false-positives before each release.
Waivers shall be documented centrally and
in the form of a comment inside the source code itself. The
documentation shall include the employed tool and its version,
the date of the analysis, the branch and parent revision number,
the reason for the waiver, the author of the respective code, and
the approver(s) of the waiver. This shall as a minimum run on the
main release branch and on the security branch. It shall be
ensured that each release has zero issues with regard to static
code analysis (including waivers).
Refer to the <a class="reference internal" href="../development_process/index.html#development-model"><span class="std std-ref">Development and Contribution Process</span></a> documentation for more information.</p></li>
<li><p><strong>Complexity Analyses</strong> shall be performed as part of the development
process and metrics such as cyclomatic complexity shall be
evaluated. The main goal is to keep the code as simple as
possible.</p></li>
<li><p><strong>Automation:</strong> the review process and checks for coding rule
adherence are a mandatory part of the precommit checks. To
ensure consistent application, they shall be automated as part of
the precommit procedure. Prior to merging large pieces of code
in from subsystems, in addition to review process and coding rule
adherence, all static code analysis must have been run and issues
resolved.</p></li>
</ul>
</div>
<div class="section" id="release-and-lifecycle-management">
<h3>Release and Lifecycle Management<a class="headerlink" href="#release-and-lifecycle-management" title="Permalink to this headline">¶</a></h3>
<p>Lifecycle management contains several aspects:</p>
<ul class="simple">
<li><p><strong>Device management</strong> encompasses the possibility to update the
operating system and/or security related sub-systems of Zephyr
enabled devices in the field.</p></li>
<li><p><strong>Lifecycle management:</strong> system stages shall be defined and
documented along with the transactions between the stages in a
system state diagram. For security reasons, this shall include
locking of the device in case an attack has been detected, and a
termination if the end of life is reached.</p></li>
<li><p><strong>Release management</strong> describes the process of defining the release
cycle, documenting releases, and maintaining a record of known
vulnerabilities and mitigations. Especially for certification
purposes the integrity of the release needs to be ensured in a
way that later manipulation (e.g. inserting of backdoors, etc.)
can be easily detected.</p></li>
<li><p><strong>Rights management and NDAs:</strong> if required by the chosen
certification, the confidentiality and integrity of the system
needs to be ensured by an appropriate rights management (e.g.
separate source code repository) and non-disclosure agreements
between the relevant parties. In case of a repository shared
between several parties, measures shall be taken that no
malicious code is checked in.</p></li>
</ul>
<p>These points shall be evaluated with respect to their impact on the
development process employed for the Zephyr project.</p>
</div>
</div>
<div class="section" id="secure-design">
<h2>Secure Design<a class="headerlink" href="#secure-design" title="Permalink to this headline">¶</a></h2>
<p>In order to obtain a certifiable system or product, the security process
needs to be clearly defined and its application needs to be monitored
and driven. This process includes the development of security related
modules in all of its stages and the management of reported security
issues. Furthermore, threat models need to be created for currently
known and future attack vectors, and their impact on the system needs to
be investigated and mitigated. Please refer to the
<a class="reference internal" href="secure-coding.html#secure-code"><span class="std std-ref">Secure Coding</span></a> outlined in the Zephyr project documentation
for detailed information.</p>
<p>The software security process includes:</p>
<ul class="simple">
<li><p><strong>Adherence to the Secure Development Coding</strong> is mandatory to
avoid that individual components breach the system security and
to minimize the vulnerability of individual modules. While this
can be partially achieved by automated tests, it is inevitable to
investigate the correct implementation of security features such
as countermeasures manually in security-critical modules.</p></li>
<li><p><strong>Security Reviews</strong> shall be performed by a security architect in
preparation of each security-targeted release and each time a
security-related module of the Zephyr project is changed. This
process includes the validation of the effectiveness of
implemented security measures, the adherence to the global
security strategy and architecture, and the preparation of audits
towards a security certification if required.</p></li>
<li><p><strong>Security Issue Management</strong> encompasses the evaluation of potential
system vulnerabilities and their mitigation as described in
<a class="reference internal" href="reporting.html#reporting"><span class="std std-ref">Security Issue Management</span></a>.</p></li>
</ul>
<p>These criteria and tasks need to be integrated into the development
process for secure software and shall be automated wherever possible. On
system level, and for each security related module of the secure branch
of Zephyr, a directly responsible security architect shall be defined to
guide the secure development process.</p>
<div class="section" id="security-architecture">
<h3>Security Architecture<a class="headerlink" href="#security-architecture" title="Permalink to this headline">¶</a></h3>
<p>The general guidelines above shall be accompanied by an architectural
security design on system- and module-level. The high level
considerations include</p>
<ul class="simple">
<li><p>The identification of <strong>security and compliance requirements</strong></p></li>
<li><p><strong>Functional security</strong> such as the use of cryptographic functions
whenever applicable</p></li>
<li><p>Design of <strong>countermeasures</strong> against known attack vectors</p></li>
<li><p>Recording of security relevant <strong>auditable events</strong></p></li>
<li><p>Support for <strong>Trusted Platform Modules (TPM)</strong> and
<strong>Trusted Execution Environments (TEE)</strong></p></li>
<li><p>Mechanisms to allow for <strong>in-the-field</strong> <strong>updates</strong> of devices using
Zephyr</p></li>
<li><p>Task scheduler and separation</p></li>
</ul>
<p>The security architecture development is based on assets derived from
the structural overview of the overall system architecture. Based on
this, the individual steps include:</p>
<ol class="arabic simple">
<li><p><strong>Identification of assets</strong> such as user data, authentication and
encryption keys, key generation data (obtained from RNG),
security relevant status information.</p></li>
<li><p><strong>Identification of threats</strong> against the assets such as breaches of
confidentiality, manipulation of user data, etc.</p></li>
<li><p><strong>Definition of requirements</strong> regarding security and protection of
the assets, e.g. countermeasures or memory protection schemes.</p></li>
</ol>
<p>The security architecture shall be harmonized with the existing system
architecture and implementation to determine potential deviations and
mitigate existing weaknesses. Newly developed sub-modules that are
integrated into the secure branch of the Zephyr project shall provide
individual documents describing their security architecture.
Additionally, their impact on the system level security shall be
considered and documented.</p>
</div>
<div class="section" id="security-vulnerability-reporting">
<h3>Security Vulnerability Reporting<a class="headerlink" href="#security-vulnerability-reporting" title="Permalink to this headline">¶</a></h3>
<p>Please see <a class="reference internal" href="reporting.html#reporting"><span class="std std-ref">Security Vulnerability Reporting</span></a> for information on reporting security
vulnerabilities.</p>
</div>
<div class="section" id="threat-modeling-and-mitigation">
<h3>Threat Modeling and Mitigation<a class="headerlink" href="#threat-modeling-and-mitigation" title="Permalink to this headline">¶</a></h3>
<p>The modeling of security threats against the Zephyr RTOS is required for
the development of an accurate security architecture and for most
certification schemes. The first step of this process is the definition
of assets to be protected by the system. The next step then models how
these assets are protected by the system and which threats against them
are present. After a threat has been identified, a corresponding threat
model is created. This model contains the asset and system
vulnerabilities, as well as the description of the potential exploits of
these vulnerabilities. Additionally, the impact on the asset, the module
it resides in, and the overall system is to be estimated. This threat
model is then considered in the module and system security architecture
and appropriate counter-measures are defined to mitigate the threat or
limit the impact of exploits.</p>
<p>In short, the threat modeling process can be separated into these steps
(adapted from <a class="reference internal" href="security-citations.html#owasp" id="id10"><span>[OWASP]</span></a>):</p>
<ol class="arabic simple">
<li><p>Definition of assets</p></li>
<li><p>Application decomposition and creation of appropriate data flow
diagrams (DFDs)</p></li>
<li><p>Threat identification and categorization using the <a class="reference internal" href="security-citations.html#stride09" id="id11"><span>[STRIDE09]</span></a> and
<a class="reference internal" href="security-citations.html#cvss" id="id12"><span>[CVSS]</span></a> approaches</p></li>
<li><p>Determination of countermeasures and other mitigation approaches</p></li>
</ol>
<p>This procedure shall be carried out during the design phase of modules
and before major changes of the module or system architecture.
Additionally, new models shall be created or existing ones shall be
updated whenever new vulnerabilities or exploits are discovered. During
security reviews, the threat models and the mitigation techniques shall
be evaluated by the responsible security architect.</p>
<p>From these threat models and mitigation techniques tests shall be
derived that prove the effectiveness of the countermeasures. These tests
shall be integrated into the continuous integration workflow to ensure
that the security is not impaired by regressions.</p>
</div>
<div class="section" id="vulnerability-analyses">
<h3>Vulnerability Analyses<a class="headerlink" href="#vulnerability-analyses" title="Permalink to this headline">¶</a></h3>
<p>In order to find weak spots in the software implementation,
vulnerability analyses (VA) shall be performed. Of special interest are
investigations on cryptographic algorithms, critical OS tasks, and
connectivity protocols.</p>
<p>On a pure software level, this encompasses</p>
<ul class="simple">
<li><p><strong>Penetration testing</strong> of the RTOS on a particular hardware
platform, which involves testing the respective Zephyr OS
configuration and hardware as one system.</p></li>
<li><p><strong>Side channel attacks</strong> (timing invariance, power invariance, etc.)
should be considered. For instance, ensuring <strong>timing
invariance</strong> of the cryptographic algorithms and modules is
required to reduce the attack surface. This applies to both the
software implementations and when using cryptographic hardware.</p></li>
<li><p><strong>Fuzzing tests</strong> shall be performed on both exposed APIs and
protocols.</p></li>
</ul>
<p>The list given above serves primarily illustration purposes. For each
module and for the complete Zephyr system (in general on a particular
hardware platform), a suitable VA plan shall be created and executed.
The findings of these analyses shall be considered in the security issue
management process, and learnings shall be formulated as guidelines and
incorporated into the secure coding guide.</p>
<p>If possible (as in case of fuzzing analyses), these tests shall be
integrated into the continuous integration process.</p>
</div>
</div>
<div class="section" id="security-certification">
<h2>Security Certification<a class="headerlink" href="#security-certification" title="Permalink to this headline">¶</a></h2>
<p>One goal of creating a secure branch of the Zephyr RTOS is to create a
certifiable system or certifiable submodules thereof. The certification
scope and scheme is yet to be decided. However, many certification such
as Common Criteria <a class="reference internal" href="security-citations.html#ccitse12" id="id13"><span>[CCITSE12]</span></a> require evidence that the evaluation
claims are indeed fulfilled, so a general certification process is
outlined in the following. Based on the final choices for the
certification scheme and evaluation level, this process needs to be
refined.</p>
<div class="section" id="generic-certification-process">
<h3>Generic Certification Process<a class="headerlink" href="#generic-certification-process" title="Permalink to this headline">¶</a></h3>
<p>In general, the steps towards a certification or precertification
(compare <a class="reference internal" href="security-citations.html#micr16" id="id14"><span>[MICR16]</span></a>) are:</p>
<ol class="arabic simple">
<li><p>The <strong>definition of assets</strong> to be protected within the Zephyr RTOS.
Potential candidates are confidential information such as
cryptographic keys, user data such as communication logs, and
potentially IP of the vendor or manufacturer.</p></li>
<li><p>Developing a <strong>threat model</strong> and <strong>security architecture</strong> to
protect the assets against exploits of vulnerabilities of the
system. As a complete threat model includes the overall product
including the hardware platform, this might be realized by a
split model containing a precertified secure branch of Zephyr
which the vendor could use to certify their Zephyr-enabled
product.</p></li>
<li><p>Formulating an <strong>evaluation target</strong> that includes the
<strong>certification claims</strong> on the security of the assets to be
evaluated and certified, as well as assumptions on the operating
conditions.</p></li>
<li><p>Providing <strong>proof</strong> that the claims are fulfilled. This includes
consistent documentation of the security development process,
etc.</p></li>
</ol>
<p>These steps are partially covered in previous sections as well. In
contrast to these sections, the certification process only requires to
consider those components that shall be covered by the certification.
The security architecture, for example, considers assets on system level
and might include items not relevant for the certification.</p>
</div>
<div class="section" id="certification-options">
<h3>Certification Options<a class="headerlink" href="#certification-options" title="Permalink to this headline">¶</a></h3>
<p>For the security certification as such, the following options can be
pursued:</p>
<ol class="arabic simple">
<li><p><strong>Abstract precertification of Zephyr as a pure software system:</strong>
this option requires assumptions on the underlying hardware
platform and the final application running on top of Zephyr. If
these assumptions are met by the hardware and the application, a
full certification can be more easily achieved. This option is
the most flexible approach but puts the largest burden on the
product vendor.</p></li>
<li><p><strong>Certification of Zephyr on specific hardware platform without a
specific application in mind:</strong> this scenario describes the
enablement of a secure platform running the Zephyr RTOS. The
hardware manufacturer certifies the platform under defined
assumptions on the application. If these are met, the final
product can be certified with little effort.</p></li>
<li><p><strong>Certification of an actual product:</strong> in this case, a full product
including a specific hardware, the Zephyr RTOS, and an
application is certified.</p></li>
</ol>
<p>In all three cases, the certification scheme (e.g. FIPS 140-2 <a class="reference internal" href="security-citations.html#nist02" id="id15"><span>[NIST02]</span></a>
or Common Criteria <a class="reference internal" href="security-citations.html#ccitse12" id="id16"><span>[CCITSE12]</span></a>), the scope of the certification
(main-stream Zephyr, security branch, or certain modules), and the
certification/assurance level need to be determined.</p>
<p>In case of partial certifications (options 1 and 2), assumptions on
hardware and/or software are required for certifications. These can
include <a class="reference internal" href="security-citations.html#ghs10" id="id17"><span>[GHS10]</span></a></p>
<ul class="simple">
<li><p><strong>Appropriate physical security</strong> of the hardware platform and its
environment.</p></li>
<li><p><strong>Sufficient protection of storage and timing channels</strong>  on
the hardware platform itself and all connected devices. (No mentioning of
remote connections.)</p></li>
<li><p>Only <strong>trusted/assured applications</strong> running on the device</p></li>
<li><p>The device and its software stack is configured and operated by
<strong>properly trained and trusted individuals</strong> with no malicious
intent.</p></li>
</ul>
<p>These assumptions shall be part of the security claim and evaluation
target documents.</p>
</div>
</div>
</div>


           </div>
          </div>

          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; <a href="../copyright.html">Copyright</a> 2015-2022 Zephyr Project members and individual contributors.
      <span class="lastupdated">Last updated on Mar 05, 2022.
      </span></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>