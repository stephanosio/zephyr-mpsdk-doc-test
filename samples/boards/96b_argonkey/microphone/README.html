<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ArgonKey Board Microphone &mdash; Zephyr Project Documentation</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/custom.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/tabs.css" type="text/css" />
    <link rel="shortcut icon" href="../../../../_static/favicon.png"/>
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script type="module" src="../../../../_static/js/dark-mode-toggle.min.mjs"></script>
        <script src="https://www.googletagmanager.com/gtag/js?id=UA-831873-47"></script>
        <script src="../../../../_static/js/ga-tracker.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="copyright" title="Copyright" href="../../../../copyright.html" />
    <link rel="next" title="ArgonKey Board Sensors" href="../sensors/README.html" />
    <link rel="prev" title="Board-specific samples" href="../../boards.html" />
  <meta name="color-scheme" content="dark light">
  
  <link rel="stylesheet" href="../../../../_static/css/light.css" type="text/css" media="(prefers-color-scheme: light)"/>
  <link rel="stylesheet" href="../../../../_static/css/dark.css" type="text/css" media="(prefers-color-scheme: dark)"/>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../../index.html">
            <img src="../../../../_static/logo.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                3.0.99
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
  
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Zephyr Project</span>
      v: latest
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        <dt>Document Release Versions</dt>
        
          <dd><a href="/">latest</a></dd>
        
          <dd><a href="/3.0.0/">3.0.0</a></dd>
        
          <dd><a href="/2.7.0/">2.7.0</a></dd>
        
          <dd><a href="/2.6.0/">2.6.0</a></dd>
        
          <dd><a href="/2.5.0/">2.5.0</a></dd>
        
          <dd><a href="/2.4.0/">2.4.0</a></dd>
        
          <dd><a href="/2.3.0/">2.3.0</a></dd>
        
          <dd><a href="/1.14.1/">1.14.1</a></dd>
        
      </dl>
      <dl>
        <dt>Downloads</dt>
        
        <dd><a href="/latest/zephyr.pdf">PDF</a></dd>
      </dl>
      <dl>
        <dt>zephyrproject.org Links</dt>
          <dd>
            <a href="https://www.zephyrproject.org/">Project Home</a>
          </dd>
          <dd>
            <a href="https://github.com/zephyrproject-rtos/sdk-ng/releases">SDK</a>
          </dd>
          <dd>
            <a href="https://github.com/zephyrproject-rtos/zephyr/releases">Releases</a>
          </dd>
      </dl>
    </div>
  </div>
  
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../getting_started/index.html">Getting Started Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../contribute/index.html">Contribution Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../development_process/index.html">Development and Contribution Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../guides/build/index.html">Build and Configuration Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../application/index.html">Application Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../reference/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../guides/index.html">User and Developer Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../security/index.html">Security</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../index.html">Samples and Demos</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../classic.html">Classic Samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../basic/basic.html">Basic Samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../userspace/index.html">Userspace Samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../subsys/subsys.html">Various Subsystems Samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../net/net.html">Networking Samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../bluetooth/bluetooth.html">Bluetooth samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../sensor/sensor.html">Sensor Samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../arch/index.html">Architecture Dependent Samples</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../boards.html">Board-specific samples</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">ArgonKey Board Microphone</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#requirements">Requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="#references">References</a></li>
<li class="toctree-l4"><a class="reference internal" href="#building-and-running">Building and Running</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../sensors/README.html">ArgonKey Board Sensors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../arc_secure_services/README.html">ARC Secure Service</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../bbc_microbit/display/README.html">BBC micro:bit display</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../bbc_microbit/line_follower_robot/README.html">BBC micro:bit line-follower robot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../bbc_microbit/microbit.html">BBC micro:bit Samples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../bbc_microbit/pong/README.html">BBC micro:bit pong game</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../bbc_microbit/sound/README.html">BBC micro:bit sound</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../esp32/spiram_test/README.html">Espressif ESP32 SPIRAM test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../esp32/wifi_station/README.html">Espressif ESP32 WiFi Station</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../google_kukui/README.html">Kukui general features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../intel_s1000_crb/audio/README.html">Sue Creek 2-Way Audio Sample Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../intel_s1000_crb/dmic/README.html">Intel® S1000 Digital Microphone Sample Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../intel_s1000_crb/i2s/README.html">Intel® S1000 I2S Audio Sample Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../intel_s1000_crb/intel_s1000_crb.html">Intel® S1000 Customer Reference Board Samples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../mec15xxevb_assy6853/mec15xxevb_assy6853.html">MEC15xxEVB Reference Board Samples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../mec15xxevb_assy6853/power_management/README.html">MEC15xx sample board test application</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../nrf/battery/README.html">Battery Voltage Measurement</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../nrf/clock_skew/README.html">nRF5x Clock Skew Demo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../nrf/dynamic_pinctrl/README.html">Dynamic Pin Control (nRF)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../nrf/ieee802154/802154_rpmsg/README.html">nRF IEEE 802.15.4: Serialization RPMsg</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../nrf/mesh/onoff-app/README.html">Bluetooth: Mesh OnOff Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../nrf/mesh/onoff_level_lighting_vnd_app/README.html">Bluetooth: Mesh Generic OnOff, Generic Level, Lighting &amp; Vendor Models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../nrf/nrf53_sync_rtc/README.html">Synchronized RTC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../nrf/nrf_led_matrix/README.html">nRF LED matrix sample</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../nrf/nrfx/README.html">nrfx use example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../nrf/nrfx_prs/README.html">nrfx peripheral resource sharing example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../nrf/system_off/README.html">nRF5x System Off demo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../reel_board/mesh_badge/README.html">Mesh Badge</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../sensortile_box/README.html">ST SensorTile.box</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../stm32/backup_sram/README.html">STM32 Backup SRAM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../stm32/ccm/README.html">STM32 CCM example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../stm32/power_mgmt/blinky/README.html">STM32 PM Blinky</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../stm32/power_mgmt/stm32wb_ble/README.html">STM32: PM BLE Power Management (STM32WB)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ti/cc13x2_cc26x2/system_off/README.html">cc13x2_cc26x2 System Off demo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../up_squared/gpio_counter/README.html">UP Squared GPIO Counter</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../drivers/drivers.html">Driver Samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../application_development/application_development.html">Application development samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../shields/shields.html">Shields Samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../posix/posix.html">POSIX Subsystem Samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../kernel/index.html">Various Kernel and Scheduler Samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tfm_integration/tfm_integration.html">TF-M Integration Samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tfm_integration/tfm_integration.html#trusted-firmware-m-tf-m">Trusted Firmware-M (TF-M)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../modules/index.html">External Module Samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../compression/compression.html">Compression Samples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../boards/index.html">Supported Boards</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../releases/index.html">Release Notes</a></li>
</ul>

  
  <div class="toctree-wrapper compound">
    <p class="caption"><span class="caption-text">Reference</span></p>
    <ul>
      
      <li class="toctree-l1">
        <a class="reference internal" href="/latest/doxygen/html/index.html">API</a>
      </li>
      
      <li class="toctree-l1">
        <a class="reference internal" href="/latest/kconfig.html">Kconfig Options</a>
      </li>
      
      <li class="toctree-l1">
        <a class="reference internal" href="/latest/reference/devicetree/bindings.html">Devicetree Bindings</a>
      </li>
      
    </ul>
  </div>
  

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Zephyr Project</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
  <!-- Docs / Latest -->
  
  

  <li><a href="../../../../index.html">Docs / Latest</a> &raquo;</li>
  
     <li><a href="../../../index.html">Samples and Demos</a> &raquo;</li>
  
     <li><a href="../../boards.html">Board-specific samples</a> &raquo;</li>
  
  <li>ArgonKey Board Microphone</li>


  <li class="wy-breadcrumbs-aside">
    <dark-mode-toggle id="dark-mode-toggle" appearance="toggle" permanent="true"/>
  </li>
  <li class="wy-breadcrumbs-aside">
      
      
        <a href="https://github.com/zephyrproject-rtos/zephyr/blob/main//samples/boards/96b_argonkey/microphone/README.rst" class="fa fa-github"> Open on GitHub</a>
      
    
  </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
  
    <div class="wy-alert wy-alert-danger">
     This is the documentation for the latest (main) development branch of
     Zephyr. If you are looking for the documentation of previous releases, use
     the drop-down menu on the left and select the desired version.
    </div>
  
  
           <div itemprop="articleBody">
             
  <div class="section" id="argonkey-board-microphone">
<span id="argonkey-microphone"></span><h1>ArgonKey Board Microphone<a class="headerlink" href="#argonkey-board-microphone" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>This sample provides an example of how to acquire audio through
the on-board MP34DT05 microphone. The microphone generates a PDM
stream which is acquired through I2S. The PDM stream is then
converted to PCM using the OpenPDMFilter library, which is available
in source code in this sample.</p>
</div>
<div class="section" id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h2>
<p>This sample requires the ArgonKey board plus a USB to TTL 1V8 serial
cable to get the output audio stream. The board can be powered
in either one of the following two ways:</p>
<ul class="simple">
<li><p>mezzanine mode, plugging the ArgonKey to HiKey board thru its 96Board
low-speed connector</p></li>
<li><p>standalone mode, supplying 5V directly on P1 connector</p></li>
</ul>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="../../../../boards/arm/96b_argonkey/doc/index.html#b-argonkey"><span class="std std-ref">96Boards Argonkey</span></a></p></li>
</ul>
</div>
<div class="section" id="building-and-running">
<h2>Building and Running<a class="headerlink" href="#building-and-running" title="Permalink to this headline">¶</a></h2>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">west build -b 96b_argonkey samples/boards/96b_argonkey/microphone</span>
<span class="go">west build -t run</span>
</pre></div>
</div>
<div class="section" id="sample-output">
<h3>Sample Output<a class="headerlink" href="#sample-output" title="Permalink to this headline">¶</a></h3>
<p>The example acquires 5s of audio and prints out the PCM stream on COM port.
A USB to TTL 1V8 serial cable may be attached to the low speed connector on
the back of the board on P3.5 (TX) and P3.7 (RX).</p>
<p>As soon as the acquisition starts the green LED glows. At the end of the
acquisition both the green and red LEDs go on and the PCM stream is sent
on COM port. When the output is completed the green LED goes off and the red
LED stays on. The process can be reiterated by pressing the RST button.</p>
<ul class="simple">
<li><p>audio acquisition starts:     GRN on  - RED off</p></li>
<li><p>audio acquisition ends:       GRN on  - RED on</p></li>
<li><p>audio output ends:            GRN off - RED on</p></li>
</ul>
<p>The characteristics of the PCM audio are hardcoded in the example:</p>
<ul class="simple">
<li><p>16KHz sample rate</p></li>
<li><p>16 bits per sample</p></li>
<li><p>1 channel (mono), as only 1 microphone is available</p></li>
</ul>
<p>Five seconds of acquisition at a 16KHz sampling rate yields 80,000 16-bit samples.
The microphone PDM requested clock should lead the MP34DT05 driver to select an
oversampling/decimation factor equal to 128, resulting in a 2.048MHz bit clock.</p>
<p>See pcm and pdm configuration in file <a class="reference external" href="https://github.com/zephyrproject-rtos/zephyr/blob/main/samples/boards/96b_argonkey/microphone/src/main.c">samples/boards/96b_argonkey/microphone/src/main.c</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is possible to change the AUDIO_FREQ to 32000 acquiring only 2500 ms. In this
case the oversampling/decimation factor will be 64.</p>
</div>
<p>At the end of the acquisition the PCM data will be printed on the terminal
emulator in either binary or ASCII format. The output is controlled by
following macro, off by default, in <a class="reference external" href="https://github.com/zephyrproject-rtos/zephyr/blob/main/samples/boards/96b_argonkey/microphone/src/main.c">samples/boards/96b_argonkey/microphone/src/main.c</a>:</p>
<ul class="simple">
<li><p><code class="xref c c-macro docutils literal notranslate"><span class="pre">PCM_OUTPUT_IN_ASCII</span></code></p></li>
</ul>
<div class="section" id="binary-pcm-output">
<h4>Binary PCM Output<a class="headerlink" href="#binary-pcm-output" title="Permalink to this headline">¶</a></h4>
<p>The ttyUSB0 port must be configured in raw mode to avoid having
characters ‘cooked’ out.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">stty -F /dev/ttyUSB0 115200 raw</span>
<span class="go">cat /dev/ttyUSB0 &gt; /tmp/sound.raw</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The “cat /dev/ttyUSB0 &gt; /tmp/sound.raw” command should be launched after the audio
acquisition starts (after green led glows) to avoid initial boot messages to enter in the file,
and before audio acquisition ends (before red led glows).</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In case the character 0x0a is interpreted as NL and an 0x0d (CR) is added,
you may need to remove it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dos2unix</span> <span class="o">-</span><span class="n">f</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">sound</span><span class="o">.</span><span class="n">raw</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="ascii-pcm-output">
<h4>ASCII PCM Output<a class="headerlink" href="#ascii-pcm-output" title="Permalink to this headline">¶</a></h4>
<p>It is also possible to recompile and to have PCM output in ASCII, which needs
to be converted to binary later on. The output format is the following:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ArgonKey test!!</span>
<span class="go">-- start</span>
<span class="go">0xfbe0,</span>
<span class="go">0xfbf0,</span>
<span class="go">0xfc0c,</span>
<span class="go">0xfc24,</span>
<span class="go">0xfc3c,</span>
<span class="go">0xfc4c,</span>
<span class="go">0xfc68,</span>
<span class="go">0xfc48,</span>

<span class="go">[...]</span>

<span class="go">0xfb98,</span>
<span class="go">0xfb98,</span>
<span class="go">0xfbb8,</span>
<span class="go">0xfbac,</span>
<span class="go">0xfbc4,</span>
<span class="go">0xfbe8,</span>
<span class="go">0xfbf4,</span>
<span class="go">-- end</span>
</pre></div>
</div>
</div>
<div class="section" id="play-pcm-audio">
<h4>Play PCM Audio<a class="headerlink" href="#play-pcm-audio" title="Permalink to this headline">¶</a></h4>
<p>Now that we have a binary PCM file (say sound.raw), you can use,
for example, the audacity open source editor/player to load and play it.
Use the ‘Import-&gt;Raw Data’ menu to load the sound.raw file as
signed 16 bit PCM, Little Endian, mono format &#64;16KHz.</p>
</div>
</div>
</div>
</div>


           </div>
          </div>

          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; <a href="../../../../copyright.html">Copyright</a> 2015-2022 Zephyr Project members and individual contributors.
      <span class="lastupdated">Last updated on Mar 05, 2022.
      </span></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>