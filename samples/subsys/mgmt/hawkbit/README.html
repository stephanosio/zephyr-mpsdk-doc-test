<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Hawkbit Direct Device Integration API sample &mdash; Zephyr Project Documentation</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/custom.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/tabs.css" type="text/css" />
    <link rel="shortcut icon" href="../../../../_static/favicon.png"/>
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script type="module" src="../../../../_static/js/dark-mode-toggle.min.mjs"></script>
        <script src="https://www.googletagmanager.com/gtag/js?id=UA-831873-47"></script>
        <script src="../../../../_static/js/ga-tracker.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="copyright" title="Copyright" href="../../../../copyright.html" />
    <link rel="next" title="SMP Server Sample" href="../mcumgr/smp_svr/README.html" />
    <link rel="prev" title="Management Samples" href="../mgmt.html" />
  <meta name="color-scheme" content="dark light">
  
  <link rel="stylesheet" href="../../../../_static/css/light.css" type="text/css" media="(prefers-color-scheme: light)"/>
  <link rel="stylesheet" href="../../../../_static/css/dark.css" type="text/css" media="(prefers-color-scheme: dark)"/>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../../index.html">
            <img src="../../../../_static/logo.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                3.0.99
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
  
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Zephyr Project</span>
      v: latest
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        <dt>Document Release Versions</dt>
        
          <dd><a href="/">latest</a></dd>
        
          <dd><a href="/3.0.0/">3.0.0</a></dd>
        
          <dd><a href="/2.7.0/">2.7.0</a></dd>
        
          <dd><a href="/2.6.0/">2.6.0</a></dd>
        
          <dd><a href="/2.5.0/">2.5.0</a></dd>
        
          <dd><a href="/2.4.0/">2.4.0</a></dd>
        
          <dd><a href="/2.3.0/">2.3.0</a></dd>
        
          <dd><a href="/1.14.1/">1.14.1</a></dd>
        
      </dl>
      <dl>
        <dt>Downloads</dt>
        
        <dd><a href="/latest/zephyr.pdf">PDF</a></dd>
      </dl>
      <dl>
        <dt>zephyrproject.org Links</dt>
          <dd>
            <a href="https://www.zephyrproject.org/">Project Home</a>
          </dd>
          <dd>
            <a href="https://github.com/zephyrproject-rtos/sdk-ng/releases">SDK</a>
          </dd>
          <dd>
            <a href="https://github.com/zephyrproject-rtos/zephyr/releases">Releases</a>
          </dd>
      </dl>
    </div>
  </div>
  
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../getting_started/index.html">Getting Started Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../contribute/index.html">Contribution Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../development_process/index.html">Development and Contribution Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../guides/build/index.html">Build and Configuration Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../application/index.html">Application Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../reference/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../guides/index.html">User and Developer Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../security/index.html">Security</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../index.html">Samples and Demos</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../classic.html">Classic Samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../basic/basic.html">Basic Samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../userspace/index.html">Userspace Samples</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../subsys.html">Various Subsystems Samples</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../canbus/canbus.html">Controller Area Network (CAN) Bus Samples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../console/console.html">Console Samples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cpp/cpp.html">C++ Samples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../debug/index.html">Debug Samples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../display/display.html">Display Samples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../fs/fs.html">FS Samples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ipc/ipc.html">IPC Samples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../logging/logging.html">Logging Sample</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../mgmt.html">Management Samples</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">Hawkbit Direct Device Integration API sample</a></li>
<li class="toctree-l4"><a class="reference internal" href="../mcumgr/smp_svr/README.html">SMP Server Sample</a></li>
<li class="toctree-l4"><a class="reference internal" href="../osdp/README.html">Open Supervised Device Protocol (OSDP)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../updatehub/README.html">UpdateHub embedded Firmware Over-The-Air (FOTA) sample</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../modbus/modbus.html">Modbus Samples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../nvs/README.html">NVS: Non-Volatile Storage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../portability/portability.html">Portability Samples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../settings/README.html">Settings sample</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../shell/shell.html">Shell System Samples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../task_wdt/README.html">Task Watchdog Sample</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../usb/usb.html">USB device support samples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../video/video.html">Video Samples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../net/net.html">Networking Samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../bluetooth/bluetooth.html">Bluetooth samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../sensor/sensor.html">Sensor Samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../arch/index.html">Architecture Dependent Samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../boards/boards.html">Board-specific samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../drivers/drivers.html">Driver Samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../application_development/application_development.html">Application development samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../shields/shields.html">Shields Samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../posix/posix.html">POSIX Subsystem Samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../kernel/index.html">Various Kernel and Scheduler Samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tfm_integration/tfm_integration.html">TF-M Integration Samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tfm_integration/tfm_integration.html#trusted-firmware-m-tf-m">Trusted Firmware-M (TF-M)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../modules/index.html">External Module Samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../compression/compression.html">Compression Samples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../boards/index.html">Supported Boards</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../releases/index.html">Release Notes</a></li>
</ul>

  
  <div class="toctree-wrapper compound">
    <p class="caption"><span class="caption-text">Reference</span></p>
    <ul>
      
      <li class="toctree-l1">
        <a class="reference internal" href="/latest/doxygen/html/index.html">API</a>
      </li>
      
      <li class="toctree-l1">
        <a class="reference internal" href="/latest/kconfig.html">Kconfig Options</a>
      </li>
      
      <li class="toctree-l1">
        <a class="reference internal" href="/latest/reference/devicetree/bindings.html">Devicetree Bindings</a>
      </li>
      
    </ul>
  </div>
  

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Zephyr Project</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
  <!-- Docs / Latest -->
  
  

  <li><a href="../../../../index.html">Docs / Latest</a> &raquo;</li>
  
     <li><a href="../../../index.html">Samples and Demos</a> &raquo;</li>
  
     <li><a href="../../subsys.html">Various Subsystems Samples</a> &raquo;</li>
  
     <li><a href="../mgmt.html">Management Samples</a> &raquo;</li>
  
  <li>Hawkbit Direct Device Integration API sample</li>


  <li class="wy-breadcrumbs-aside">
    <dark-mode-toggle id="dark-mode-toggle" appearance="toggle" permanent="true"/>
  </li>
  <li class="wy-breadcrumbs-aside">
      
      
        <a href="https://github.com/zephyrproject-rtos/zephyr/blob/main//samples/subsys/mgmt/hawkbit/README.rst" class="fa fa-github"> Open on GitHub</a>
      
    
  </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
  
    <div class="wy-alert wy-alert-danger">
     This is the documentation for the latest (main) development branch of
     Zephyr. If you are looking for the documentation of previous releases, use
     the drop-down menu on the left and select the desired version.
    </div>
  
  
           <div itemprop="articleBody">
             
  <div class="section" id="hawkbit-direct-device-integration-api-sample">
<span id="hawkbit-api-sample"></span><h1>Hawkbit Direct Device Integration API sample<a class="headerlink" href="#hawkbit-direct-device-integration-api-sample" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>The hawkbit update server provides REST resources which are consumed by the
device to retrieve software update tasks. This API is based on HTTP standards
and a polling mechanism.</p>
<p>This sample shows how to use Hawkbit DDI API in both a polling and manual
update mode.</p>
<p>Polling mode run automatically on a predefined period, probing the server
for updates and installing them without requiring user intervention. You can
access the sample source code for this hawkbit_polling.</p>
<p>Manual mode requires the user to call the server probe and then, if there is
an available update, it will install the update. You can access the sample
source code for this mode hawkbit_manual</p>
</div>
<div class="section" id="caveats">
<h2>Caveats<a class="headerlink" href="#caveats" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>The Zephyr port of <code class="docutils literal notranslate"><span class="pre">Hawkbit</span></code> is configured to run on a
<a class="reference internal" href="../../../../boards/arm/frdm_k64f/doc/index.html#frdm-k64f"><span class="std std-ref">Freedom-K64F</span></a> MCU by default. The application should
build and run for other platforms with support internet connection. Some
platforms need some modification. Overlay files would be needed to support
BLE 6lowpan, 802.15.4 or OpenThread configurations as well as the
understanding that most other connectivity options would require an edge
gateway of some sort (Border Router, etc).</p></li>
<li><p>The MCUboot bootloader is required for <code class="docutils literal notranslate"><span class="pre">Hawkbit</span></code> to function properly.
More information about the Device Firmware Upgrade subsystem and MCUboot
can be found in <a class="reference internal" href="../../../../guides/device_mgmt/dfu.html#mcuboot"><span class="std std-ref">MCUboot</span></a>.</p></li>
</ul>
</div>
<div class="section" id="building-and-running">
<h2>Building and Running<a class="headerlink" href="#building-and-running" title="Permalink to this headline">¶</a></h2>
<p>The below steps describe how to build and run the <code class="docutils literal notranslate"><span class="pre">Hawkbit</span></code> sample in
Zephyr. Where examples are given, it is assumed the sample is being build for
the Freedom-K64F Development Kit (<code class="docutils literal notranslate"><span class="pre">BOARD=frdm_k64f</span></code>).</p>
<div class="section" id="step-1-build-mcuboot">
<h3>Step 1: Build MCUboot<a class="headerlink" href="#step-1-build-mcuboot" title="Permalink to this headline">¶</a></h3>
<p>Build MCUboot by following the instructions in the <a class="reference internal" href="../../../../guides/device_mgmt/dfu.html#mcuboot"><span class="std std-ref">MCUboot</span></a> documentation
page.</p>
</div>
<div class="section" id="step-2-flash-mcuboot">
<h3>Step 2: Flash MCUboot<a class="headerlink" href="#step-2-flash-mcuboot" title="Permalink to this headline">¶</a></h3>
<p>Flash the resulting image file to the 0x0 address of the flash memory. This can
be done by,</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">west flash</span>
</pre></div>
</div>
</div>
<div class="section" id="step-3-start-the-hawkbit-docker">
<h3>Step 3: Start the Hawkbit Docker<a class="headerlink" href="#step-3-start-the-hawkbit-docker" title="Permalink to this headline">¶</a></h3>
<p>By default, the hawkbit application is set to run on http at port:8080.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">sudo docker run -p 8080:8080 hawkbit/hawkbit-update-server:latest \</span>
<span class="go">--hawkbit.dmf.rabbitmq.enabled=false \</span>
<span class="go">--hawkbit.server.ddi.security.authentication.anonymous.enabled=true</span>
</pre></div>
</div>
<p>This will start the hawkbit server on the host system.Opening your browser to
the server URL, <code class="docutils literal notranslate"><span class="pre">&lt;your-ip-address&gt;:8080</span></code>, and logging into the server using
<code class="docutils literal notranslate"><span class="pre">admin</span></code> as the login and password by default.</p>
</div>
<div class="section" id="step-4-build-hawkbit">
<h3>Step 4: Build Hawkbit<a class="headerlink" href="#step-4-build-hawkbit" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">Hawkbit</span></code> can be built for the frdm_k64f as follows:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp"># </span>From the root of the zephyr repository
<span class="go">west build -b frdm_k64f samples/net/hawkbit -- -DCONF_FILE=&quot;prj.conf&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="step-5-sign-and-confirm-the-first-image">
<span id="hawkbit-sample-sign"></span><h3>Step 5: Sign and confirm the first image<a class="headerlink" href="#step-5-sign-and-confirm-the-first-image" title="Permalink to this headline">¶</a></h3>
<p>From this section onwards you use a binary (<code class="docutils literal notranslate"><span class="pre">.bin</span></code>) image format.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">west sign -t imgtool -- --key \</span>
<span class="go">~/zephyrproject/bootloader/mcuboot/root-rsa-2048.pem --confirm \</span>
<span class="go">--version 1.0.0</span>
</pre></div>
</div>
<p>The command above creates a signed and confirmed image file called
<code class="file docutils literal notranslate"><span class="pre">zephyr.signed.confirmed.bin</span></code> in the build directory. It’s important for
the first image to be confirmed as MCUboot isn’t able to confirm an image that
is flashed using a hardware tool, and Hawkbit will reboot to trigger a firmware
swap if it isn’t able to confirm the running image on init.</p>
</div>
<div class="section" id="step-6-flash-the-first-image">
<h3>Step 6: Flash the first image<a class="headerlink" href="#step-6-flash-the-first-image" title="Permalink to this headline">¶</a></h3>
<p>Upload the <code class="file docutils literal notranslate"><span class="pre">zephyr.signed.confirmed.bin</span></code> file from Step 5 to image slot-0
of your board.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">west flash --bin-file build/zephyr/zephyr.signed.confirmed.bin</span>
</pre></div>
</div>
<p>Once the image is flashed and booted, the sample will print the image build
time to the console. After it connects to the internet, in hawkbit server UI,
you should see the the frdm_k64f show up in the Targets pane. It’s time to
upload a firmware binary to the server, and update it using this UI.</p>
</div>
<div class="section" id="step-7-building-and-signing-the-test-image">
<h3>Step 7: Building and signing the test image<a class="headerlink" href="#step-7-building-and-signing-the-test-image" title="Permalink to this headline">¶</a></h3>
<p>The easiest way to test the functionality of Hawkbit is to repeat step 4 to
build the sample again, so that the build time will be different. Then, similar
to step 5, sign the image and assign it a different version number but without
confirming it like so:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">west sign -t imgtool -- --key \</span>
<span class="go">~/zephyrproject/bootloader/mcuboot/root-rsa-2048.pem \</span>
<span class="go">--version 1.0.1</span>
</pre></div>
</div>
<p>The command above creates a signed image file called
<code class="file docutils literal notranslate"><span class="pre">zephyr.signed.bin</span></code> in the build directory.</p>
<p>Upload the signed image to the server. Click Upload icon in left pane of UI and
create a new Software Module with type Apps (<code class="docutils literal notranslate"><span class="pre">name:hawkbit,version:1.0.1</span></code>).
Then upload the signed image to the server with Upload file Icon.</p>
<p>Click on distribution icon in the left pane of UI and create a new Distribution
with type Apps only (<code class="docutils literal notranslate"><span class="pre">name:frdm_k64f_update,version:1.0.1</span></code>). Assign the
<code class="docutils literal notranslate"><span class="pre">hawkbit</span></code> software module to the created distribution. Click on Deployment
icon in the left pane of UI and assign the <code class="docutils literal notranslate"><span class="pre">frdm_k64f_update</span></code> distribution to
the target <code class="docutils literal notranslate"><span class="pre">frdm_k64f</span></code>.</p>
</div>
<div class="section" id="step-8-run-the-update">
<h3>Step 8: Run the update<a class="headerlink" href="#step-8-run-the-update" title="Permalink to this headline">¶</a></h3>
<p>Back in the terminal session that you used for debugging the board, type the
following command:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">hawkbit run</span>
</pre></div>
</div>
<p>And then wait. The board will ping the server, check if there are any new
updates, and then download the update you’ve just created. If everyting goes
fine the message <code class="docutils literal notranslate"><span class="pre">Image</span> <span class="pre">flashed</span> <span class="pre">successfully,</span> <span class="pre">you</span> <span class="pre">can</span> <span class="pre">reboot</span> <span class="pre">now</span></code> will be
printed on the terminal.</p>
</div>
<div class="section" id="step-9-reboot-the-system">
<h3>Step 9: Reboot the system<a class="headerlink" href="#step-9-reboot-the-system" title="Permalink to this headline">¶</a></h3>
<p>In the terminal you used for debugging the board, type the following command:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">kernel reboot cold</span>
</pre></div>
</div>
<p>Your board will reboot and then start with the new image. After rebooting, the
board will print a different image build time then automatically ping the server
again and the message <code class="docutils literal notranslate"><span class="pre">No</span> <span class="pre">update</span> <span class="pre">available</span></code> will be printed on the terminal.</p>
</div>
<div class="section" id="step-10-clone-and-build-hawkbit-with-https">
<h3>Step 10: Clone and build hawkbit with https<a class="headerlink" href="#step-10-clone-and-build-hawkbit-with-https" title="Permalink to this headline">¶</a></h3>
<p>Below steps clone and build the hawkbit with self-signed certificate
to support https.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">git clone https://github.com/eclipse/hawkbit.git</span>
<span class="go">cd hawkbit/hawkbit-runtime/hawkbit-update-server/src/main/resources</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Generate the private key</p></li>
</ul>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">openssl genrsa -des3 -out server.key 2048</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Generate the CSR</p></li>
</ul>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">openssl req -new -key server.key -out server.csr</span>
</pre></div>
</div>
<p>Once you run the command, it will prompt you to enter your Country,
State, City, Company name and enter the Comman Name field with
<code class="docutils literal notranslate"><span class="pre">&lt;your-ip-address&gt;</span></code>.</p>
<ul class="simple">
<li><p>Generate the self-signed x509 certificate suitable to use on web server.</p></li>
</ul>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">openssl x509 -req -days 365 -in server.csr -signkey server.key -out server.crt</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Generate pem file from generated server.key and server.crt</p></li>
</ul>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">cat server.key &gt; server.pem</span>
<span class="go">cat server.crt &gt;&gt; server.pem</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Generate .pkcs12 file</p></li>
</ul>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">openssl pkcs12 -export -in server.pem -out keystore.pkcs12</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Following command imports a .p12 into pkcs12 Java keystore</p></li>
</ul>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">keytool -importkeystore -srckeystore keystore.pkcs12 -srcstoretype pkcs12 \</span>
<span class="go">-destkeystore hb-pass.jks -deststoretype pkcs12 \</span>
<span class="go">-alias 1 -deststorepass &lt;password_of_p12&gt;</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Edit the hawkbit application.properties file</p></li>
</ul>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">vi application.properties</span>
</pre></div>
</div>
<p>Change authentication security from false to true.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">hawkbit.server.ddi.security.authentication.anonymous.enabled=true</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Enter the https details at last</p></li>
</ul>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">server.hostname=localhost</span>
<span class="go">server.port=8443</span>
<span class="go">hawkbit.artifact.url.protocols.download-http.protocol=https</span>
<span class="go">hawkbit.artifact.url.protocols.download-http.port=8443</span>

<span class="go">security.require-ssl=true</span>
<span class="go">server.use-forward-headers=true</span>

<span class="go">server.ssl.key-store=  &lt;hb-pass.jks file location&gt;</span>
<span class="go">server.ssl.key-store-type=JKS</span>
<span class="go">server.ssl.key-password= &lt;password_of_key&gt;</span>
<span class="go">server.ssl.key-store-password= &lt;password_of_key_store&gt;</span>

<span class="go">server.ssl.protocol=TLS</span>
<span class="go">server.ssl.enabled-protocols=TLSv1.2</span>
<span class="go">server.ssl.ciphers=TLS_RSA_WITH_AES_256_CBC_SHA256,</span>
<span class="go">                   TLS_RSA_WITH_AES_256_CBC_SHA</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Start Compile</p></li>
</ul>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">cd ~/hawkbit</span>

<span class="go">mvn clean install -DskipTests=true</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Once the build is successful, run hawkbit</p></li>
</ul>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">java -jar ./hawkbit-runtime/hawkbit-update-server/target/ \</span>
<span class="go">     hawkbit-update-server-#version#-SNAPSHOT.jar</span>
</pre></div>
</div>
</div>
<div class="section" id="step-11-build-hawkbit-https">
<h3>Step 11: Build Hawkbit HTTPS<a class="headerlink" href="#step-11-build-hawkbit-https" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Convert the server.pem file to self_sign.der and place the der file in
hawkbit/src directory</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">Hawkbit</span> <span class="pre">https</span></code> can be built for the frdm_k64f as follows:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp"># </span>From the root of the zephyr repository
<span class="go">west build -b frdm_k64f samples/net/hawkbit -- -DCONF_FILE=&quot;prj.conf overlay-tls.conf&quot;</span>
</pre></div>
</div>
<p>Repeat the steps from 5 to 9, to update the device over https.</p>
</div>
</div>
</div>


           </div>
          </div>

          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; <a href="../../../../copyright.html">Copyright</a> 2015-2022 Zephyr Project members and individual contributors.
      <span class="lastupdated">Last updated on Mar 05, 2022.
      </span></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>