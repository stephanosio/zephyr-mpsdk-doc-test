<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Network Packet Capture &mdash; Zephyr Project Documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/custom.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/tabs.css" type="text/css" />
    <link rel="shortcut icon" href="../../../_static/favicon.png"/>
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script type="module" src="../../../_static/js/dark-mode-toggle.min.mjs"></script>
        <script src="https://www.googletagmanager.com/gtag/js?id=UA-831873-47"></script>
        <script src="../../../_static/js/ga-tracker.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="copyright" title="Copyright" href="../../../copyright.html" />
    <link rel="next" title="Civetweb sample" href="../civetweb/http_server/README.html" />
    <link rel="prev" title="Networking Samples" href="../net.html" />
  <meta name="color-scheme" content="dark light">
  
  <link rel="stylesheet" href="../../../_static/css/light.css" type="text/css" media="(prefers-color-scheme: light)"/>
  <link rel="stylesheet" href="../../../_static/css/dark.css" type="text/css" media="(prefers-color-scheme: dark)"/>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html">
            <img src="../../../_static/logo.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                3.0.0-rc3
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
  
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Zephyr Project</span>
      v: latest
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        <dt>Document Release Versions</dt>
        
          <dd><a href="/">latest</a></dd>
        
          <dd><a href="/2.7.0/">2.7.0</a></dd>
        
          <dd><a href="/2.6.0/">2.6.0</a></dd>
        
          <dd><a href="/2.5.0/">2.5.0</a></dd>
        
          <dd><a href="/2.4.0/">2.4.0</a></dd>
        
          <dd><a href="/2.3.0/">2.3.0</a></dd>
        
          <dd><a href="/1.14.1/">1.14.1</a></dd>
        
      </dl>
      <dl>
        <dt>Downloads</dt>
        
        <dd><a href="/latest/zephyr.pdf">PDF</a></dd>
      </dl>
      <dl>
        <dt>zephyrproject.org Links</dt>
          <dd>
            <a href="https://www.zephyrproject.org/">Project Home</a>
          </dd>
          <dd>
            <a href="https://github.com/zephyrproject-rtos/sdk-ng/releases">SDK</a>
          </dd>
          <dd>
            <a href="https://github.com/zephyrproject-rtos/zephyr/releases">Releases</a>
          </dd>
      </dl>
    </div>
  </div>
  
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started/index.html">Getting Started Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contribute/index.html">Contribution Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../development_process/index.html">Development and Contribution Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../guides/build/index.html">Build and Configuration Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../application/index.html">Application Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../reference/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../guides/index.html">User and Developer Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../security/index.html">Security</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Samples and Demos</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../classic.html">Classic Samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../basic/basic.html">Basic Samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../userspace/index.html">Userspace Samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../subsys/subsys.html">Various Subsystems Samples</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../net.html">Networking Samples</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Network Packet Capture</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#requirements">Requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="#building-and-running">Building and Running</a></li>
<li class="toctree-l4"><a class="reference internal" href="#network-configuration">Network Configuration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../civetweb/http_server/README.html">Civetweb sample</a></li>
<li class="toctree-l3"><a class="reference internal" href="../civetweb/websocket_server/README.html">Civetweb WebSocket Server sample</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cloud/google_iot_mqtt/README.html">Google IOT MQTT Sample</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cloud/mqtt_azure/README.html">MQTT Azure Sample</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cloud/tagoio_http_post/README.html">TagoIO IoT Cloud HTTP Sample</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dhcpv4_client/README.html">Sample DHCPv4 client application</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dns_resolve/README.html">DNS Resolve Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dsa/README.html">DSA Sample Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="../eth_native_posix/README.html">Native Posix Ethernet</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gptp/README.html">gPTP Sample Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gsm_modem/README.html">Generic GSM Modem Sample</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ipv4_autoconf/README.html">IPv4 autoconf client application</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lldp/README.html">LLDP Sample Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lwm2m_client/README.html">LwM2M client</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mdns_responder/README.html">mDNS Responder Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mqtt_publisher/README.html">MQTT Publisher</a></li>
<li class="toctree-l3"><a class="reference internal" href="../openthread/coprocessor/README.html">OpenThread Co-Processor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../promiscuous_mode/README.html">Promiscuous Mode Sample Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sockets/big_http_download/README.html">Socket Big HTTP Download Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sockets/can/README.html">Socket CAN</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sockets/coap_client/README.html">CoAP client</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sockets/coap_server/README.html">CoAP Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sockets/dumb_http_server/README.html">Socket Dumb HTTP Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sockets/dumb_http_server_mt/README.html">Socket Multithreaded Dumb HTTP Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sockets/echo/README.html">Socket Echo Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sockets/echo_async/README.html">Asynchronous Socket Echo Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sockets/echo_async_select/README.html">Asynchronous Socket Echo Server Using select()</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sockets/echo_client/README.html">Socket Echo Client</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sockets/echo_server/README.html">Socket Echo Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sockets/http_client/README.html">Socket HTTP Client</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sockets/http_get/README.html">Socket HTTP GET Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sockets/net_mgmt/README.html">Network Management Socket</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sockets/packet/README.html">Packet socket sample</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sockets/sntp_client/README.html">SNTP client sample</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sockets/socketpair/README.html">Socketpair Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sockets/tcp/README.html">TCP Sample for TTCN-3 based Sanity Check</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sockets/txtime/README.html">SO_TXTIME sample</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sockets/websocket_client/README.html">Socket Websocket Client</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stats/README.html">Network Statistics Sample Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="../syslog_net/README.html">Syslog net Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="../telnet/README.html">Sample TELNET console application</a></li>
<li class="toctree-l3"><a class="reference internal" href="../virtual/README.html">Virtual Network Interface Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="../vlan/README.html">Virtual LAN Sample Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="../wifi/README.html">Wi-Fi sample</a></li>
<li class="toctree-l3"><a class="reference internal" href="../wpan_serial/README.html">802.15.4 “serial-radio” sample</a></li>
<li class="toctree-l3"><a class="reference internal" href="../wpanusb/README.html">wpanusb sample</a></li>
<li class="toctree-l3"><a class="reference internal" href="../zperf/README.html">zperf: Network Traffic Generator</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../bluetooth/bluetooth.html">Bluetooth samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sensor/sensor.html">Sensor Samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../arch/index.html">Architecture Dependent Samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../boards/boards.html">Board-specific samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../drivers/drivers.html">Driver Samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../application_development/application_development.html">Application development samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../shields/shields.html">Shields Samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../posix/posix.html">POSIX Subsystem Samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../kernel/index.html">Various Kernel and Scheduler Samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tfm_integration/tfm_integration.html">TF-M Integration Samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tfm_integration/tfm_integration.html#trusted-firmware-m-tf-m">Trusted Firmware-M (TF-M)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../modules/index.html">External Module Samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../compression/compression.html">Compression Samples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../boards/index.html">Supported Boards</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../releases/index.html">Release Notes</a></li>
</ul>

  
  <div class="toctree-wrapper compound">
    <p class="caption"><span class="caption-text">Reference</span></p>
    <ul>
      
      <li class="toctree-l1">
        <a class="reference internal" href="/latest/doxygen/html/index.html">API</a>
      </li>
      
      <li class="toctree-l1">
        <a class="reference internal" href="/latest/reference/kconfig/index.html">Kconfig Options</a>
      </li>
      
      <li class="toctree-l1">
        <a class="reference internal" href="/latest/reference/devicetree/bindings.html">Devicetree Bindings</a>
      </li>
      
    </ul>
  </div>
  

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Zephyr Project</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
  <!-- Docs / Latest -->
  
  

  <li><a href="../../../index.html">Docs / Latest</a> &raquo;</li>
  
     <li><a href="../../index.html">Samples and Demos</a> &raquo;</li>
  
     <li><a href="../net.html">Networking Samples</a> &raquo;</li>
  
  <li>Network Packet Capture</li>


  <li class="wy-breadcrumbs-aside">
    <dark-mode-toggle id="dark-mode-toggle" appearance="toggle" permanent="true"/>
  </li>
  <li class="wy-breadcrumbs-aside">
      
      
        <a href="https://github.com/zephyrproject-rtos/zephyr/blob/main//samples/net/capture/README.rst" class="fa fa-github"> Open on GitHub</a>
      
    
  </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
  
    <div class="wy-alert wy-alert-danger">
     This is the documentation for the latest (main) development branch of
     Zephyr. If you are looking for the documentation of previous releases, use
     the drop-down menu on the left and select the desired version.
    </div>
  
  
           <div itemprop="articleBody">
             
  <div class="section" id="network-packet-capture">
<span id="net-capture-sample"></span><h1>Network Packet Capture<a class="headerlink" href="#network-packet-capture" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>This application will setup the device so that net-shell can be used
to enable network packet capture. The captured packets are sent to
remote host via IPIP tunnel. The tunnel can be configured to be in the
same connection as what we are capturing packets or it can be a separate
bearer. For example if you are capturing network traffic for interface 1,
then the remote host where the captured packets are sent can also be reached
via interface 1 or via some other network interface if the device has
multiple network interfaces connected.</p>
</div>
<div class="section" id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="../../../guides/networking/networking_with_host.html#networking-with-host"><span class="std std-ref">Networking with the host system</span></a></p></li>
</ul>
</div>
<div class="section" id="building-and-running">
<h2>Building and Running<a class="headerlink" href="#building-and-running" title="Permalink to this headline">¶</a></h2>
<p>Build the sample application like this:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">west build -b &lt;board to use&gt; samples/net/capture -- -DCONF_FILE=&lt;config file to use&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="network-configuration">
<h2>Network Configuration<a class="headerlink" href="#network-configuration" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">net-tools</span></code> project contains <code class="docutils literal notranslate"><span class="pre">net-setup.sh</span></code> script that can be used to setup
the tunneling.</p>
<p>In terminal #1, type:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">./net-setup.sh -c zeth-tunnel.conf</span>
</pre></div>
</div>
<p>The script will create following network interfaces:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">zeth: flags=4099&lt;UP,BROADCAST,MULTICAST&gt;  mtu 1500</span>
<span class="go">     inet 192.0.2.2  netmask 255.255.255.255  broadcast 0.0.0.0</span>
<span class="go">     inet6 2001:db8::2  prefixlen 128  scopeid 0x0&lt;global&gt;</span>
<span class="go">     ether 00:00:5e:00:53:ff  txqueuelen 1000  (Ethernet)</span>
<span class="go">     RX packets 0  bytes 0 (0.0 B)</span>
<span class="go">     RX errors 0  dropped 0  overruns 0  frame 0</span>
<span class="go">     TX packets 0  bytes 0 (0.0 B)</span>
<span class="go">     TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span>

<span class="go">zeth-ip6ip: flags=209&lt;UP,POINTOPOINT,RUNNING,NOARP&gt;  mtu 1480</span>
<span class="go">     inet6 2001:db8:200::2  prefixlen 64  scopeid 0x0&lt;global&gt;</span>
<span class="go">     inet6 fe80::c000:202  prefixlen 64  scopeid 0x20&lt;link&gt;</span>
<span class="go">     sit  txqueuelen 1000  (IPv6-in-IPv4)</span>
<span class="go">     RX packets 0  bytes 0 (0.0 B)</span>
<span class="go">     RX errors 0  dropped 0  overruns 0  frame 0</span>
<span class="go">     TX packets 0  bytes 0 (0.0 B)</span>
<span class="go">     TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span>

<span class="go">zeth-ip6ip6: flags=209&lt;UP,POINTOPOINT,RUNNING,NOARP&gt;  mtu 1452</span>
<span class="go">     inet6 fe80::486c:eeff:fead:5d11  prefixlen 64  scopeid 0x20&lt;link&gt;</span>
<span class="go">     inet6 2001:db8:100::2  prefixlen 64  scopeid 0x0&lt;global&gt;</span>
<span class="go">     unspec 20-01-0D-B8-00-00-00-00-00-00-00-00-00-00-00-00  txqueuelen 1000  (UNSPEC)</span>
<span class="go">     RX packets 0  bytes 0 (0.0 B)</span>
<span class="go">     RX errors 0  dropped 0  overruns 0  frame 0</span>
<span class="go">     TX packets 0  bytes 0 (0.0 B)</span>
<span class="go">     TX errors 8  dropped 8 overruns 0  carrier 8  collisions 0</span>

<span class="go">zeth-ipip: flags=209&lt;UP,POINTOPOINT,RUNNING,NOARP&gt;  mtu 1480</span>
<span class="go">     inet 198.51.100.2  netmask 255.255.255.0  destination 198.51.100.2</span>
<span class="go">     inet6 fe80::5efe:c000:202  prefixlen 64  scopeid 0x20&lt;link&gt;</span>
<span class="go">     tunnel   txqueuelen 1000  (IPIP Tunnel)</span>
<span class="go">     RX packets 0  bytes 0 (0.0 B)</span>
<span class="go">     RX errors 0  dropped 0  overruns 0  frame 0</span>
<span class="go">     TX packets 0  bytes 0 (0.0 B)</span>
<span class="go">     TX errors 7  dropped 0 overruns 0  carrier 0  collisions 0</span>

<span class="go">zeth-ipip6: flags=209&lt;UP,POINTOPOINT,RUNNING,NOARP&gt;  mtu 1452</span>
<span class="go">     inet 203.0.113.2  netmask 255.255.255.0  destination 203.0.113.2</span>
<span class="go">     inet6 fe80::387b:a6ff:fe56:6cac  prefixlen 64  scopeid 0x20&lt;link&gt;</span>
<span class="go">     unspec 20-01-0D-B8-00-00-00-00-00-00-00-00-00-00-00-00  txqueuelen 1000  (UNSPEC)</span>
<span class="go">     RX packets 0  bytes 0 (0.0 B)</span>
<span class="go">     RX errors 0  dropped 0  overruns 0  frame 0</span>
<span class="go">     TX packets 0  bytes 0 (0.0 B)</span>
<span class="go">     TX errors 7  dropped 7 overruns 0  carrier 0  collisions 0</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">zeth</span></code> is the outer tunnel interface, all the packets go via it.
The other interfaces receive packets depending on the configuration you have
in the Zephyr side.</p>
<div class="section" id="network-capture-configuration">
<h3>Network Capture Configuration<a class="headerlink" href="#network-capture-configuration" title="Permalink to this headline">¶</a></h3>
<p>In Zephyr console, type:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">uart:~$ </span>net iface

<span class="go">Interface 0x807df74 (Virtual) [1]</span>
<span class="go">=================================</span>
<span class="go">Interface is down.</span>

<span class="go">Interface 0x807e040 (Ethernet) [2]</span>
<span class="go">==================================</span>
<span class="go">Link addr : 02:00:5E:00:53:3B</span>
<span class="go">MTU       : 1452</span>
<span class="go">Flags     : AUTO_START,IPv4,IPv6</span>
<span class="go">Ethernet capabilities supported:</span>
<span class="go">IPv6 unicast addresses (max 4):</span>
<span class="go">     fe80::5eff:fe00:533b autoconf preferred infinite</span>
<span class="go">     2001:db8::1 manual preferred infinite</span>
<span class="go">IPv6 multicast addresses (max 4):</span>
<span class="go">     ff02::1</span>
<span class="go">     ff02::1:ff00:533b</span>
<span class="go">     ff02::1:ff00:1</span>
<span class="go">IPv6 prefixes (max 2):</span>
<span class="go">     &lt;none&gt;</span>
<span class="go">IPv6 hop limit           : 64</span>
<span class="go">IPv6 base reachable time : 30000</span>
<span class="go">IPv6 reachable time      : 43300</span>
<span class="go">IPv6 retransmit timer    : 0</span>
<span class="go">IPv4 unicast addresses (max 2):</span>
<span class="go">     192.0.2.1 manual preferred infinite</span>
<span class="go">IPv4 multicast addresses (max 1):</span>
<span class="go">     &lt;none&gt;</span>
<span class="go">IPv4 gateway : 0.0.0.0</span>
<span class="go">IPv4 netmask : 255.255.255.0</span>
</pre></div>
</div>
<p>Next the monitoring is setup so that captured packets are sent as a payload
in IPv6/UDP packets.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">uart:~$ </span>net capture setup <span class="m">192</span>.0.2.2 <span class="m">2001</span>:db8:200::1 <span class="m">2001</span>:db8:200::2
<span class="go">Capture setup done, next enable it by &quot;net capture enable &lt;idx&gt;&quot;</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">net</span> <span class="pre">capture</span></code> command will show current configuration. As we have not
yet enabled capturing, the interface is not yet set.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">uart:~$ </span>net capture
<span class="go">Network packet capture disabled</span>
<span class="go">                Capture  Tunnel</span>
<span class="go">Device          iface    iface   Local                  Peer</span>
<span class="go">NET_CAPTURE0    -        1      [2001:db8:200::1]:4242  [2001:db8:200::2]:4242</span>
</pre></div>
</div>
<p>Next enable network packet capturing for interface 2.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">uart:~$ </span>net capture <span class="nb">enable</span> <span class="m">2</span>
</pre></div>
</div>
<p>The tunneling interface will be UP and the captured packets will be sent to
peer host.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">uart:~$ </span>net iface <span class="m">1</span>

<span class="go">Interface 0x807df74 (Virtual) [1]</span>
<span class="go">=================================</span>
<span class="go">Name      : IPv4 tunnel</span>
<span class="go">Attached  : 2 (Ethernet / 0x807e040)</span>
<span class="go">Link addr : 8E:F9:94:6D:B9:E6</span>
<span class="go">MTU       : 1452</span>
<span class="go">Flags     : POINTOPOINT,NO_AUTO_START,IPv6</span>
<span class="go">IPv6 unicast addresses (max 4):</span>
<span class="go">     fe80::aee6:fbff:fe50:28c0 autoconf preferred infinite</span>
<span class="go">     2001:db8:200::1 manual preferred infinite</span>
<span class="go">IPv6 multicast addresses (max 4):</span>
<span class="go">     &lt;none&gt;</span>
<span class="go">IPv6 prefixes (max 2):</span>
<span class="go">     &lt;none&gt;</span>
<span class="go">IPv6 hop limit           : 64</span>
<span class="go">IPv6 base reachable time : 30000</span>
<span class="go">IPv6 reachable time      : 22624</span>
<span class="go">IPv6 retransmit timer    : 0</span>
<span class="go">IPv4 not enabled for this interface.</span>
</pre></div>
</div>
<p>If you now do this:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">uart:~$ </span>net ping -c <span class="m">1</span> <span class="m">192</span>.0.2.2
</pre></div>
</div>
<p>You should see a ICMPv4 message sent to <code class="docutils literal notranslate"><span class="pre">192.0.2.2</span></code> and also the captured
packet will be sent to <code class="docutils literal notranslate"><span class="pre">192.0.2.2</span></code> in tunnel to <code class="docutils literal notranslate"><span class="pre">2001:db8:200::2</span></code>
address. The UDP port is by default <code class="docutils literal notranslate"><span class="pre">4242</span></code> but that can be changed when
setting the tunnel endpoint address.</p>
<p>The actual captured network packets received at the end of the tunnel will look
like this:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">No.     Time           Source                Destination           Protocol Length Info</span>
<span class="go">     34 106.078538049  192.0.2.1             192.0.2.2             ICMP     94     Echo (ping) request  id=0xdc36, seq=0/0, ttl=64 (reply in 35)</span>

<span class="go">Frame 34: 94 bytes on wire (752 bits), 94 bytes captured (752 bits) on interface zeth-ip6ip, id 0</span>
<span class="go">Raw packet data</span>
<span class="go">Internet Protocol Version 6, Src: 2001:db8:200::1, Dst: 2001:db8:200::2</span>
<span class="go">User Datagram Protocol, Src Port: 4242, Dst Port: 4242</span>
<span class="go">Ethernet II, Src: 02:00:5e:00:53:3b (02:00:5e:00:53:3b), Dst: ICANNIAN_00:53:ff (00:00:5e:00:53:ff)</span>
<span class="go">Internet Protocol Version 4, Src: 192.0.2.1, Dst: 192.0.2.2</span>
<span class="go">Internet Control Message Protocol</span>

<span class="go">No.     Time           Source                Destination           Protocol Length Info</span>
<span class="go">     35 106.098850599  192.0.2.2             192.0.2.1             ICMP     94     Echo (ping) reply    id=0xdc36, seq=0/0, ttl=64 (request in 34)</span>

<span class="go">Frame 35: 94 bytes on wire (752 bits), 94 bytes captured (752 bits) on interface zeth-ip6ip, id 0</span>
<span class="go">Raw packet data</span>
<span class="go">Internet Protocol Version 6, Src: 2001:db8:200::1, Dst: 2001:db8:200::2</span>
<span class="go">User Datagram Protocol, Src Port: 4242, Dst Port: 4242</span>
<span class="go">Ethernet II, Src: ICANNIAN_00:53:ff (00:00:5e:00:53:ff), Dst: 02:00:5e:00:53:3b (02:00:5e:00:53:3b)</span>
<span class="go">Internet Protocol Version 4, Src: 192.0.2.2, Dst: 192.0.2.1</span>
<span class="go">Internet Control Message Protocol</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
          </div>

          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; <a href="../../../copyright.html">Copyright</a> 2015-2021 Zephyr Project members and individual contributors.
      <span class="lastupdated">Last updated on Feb 21, 2022.
      </span></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>