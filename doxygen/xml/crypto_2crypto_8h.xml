<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.9.2" xml:lang="en-US">
  <compounddef id="crypto_2crypto_8h" kind="file" language="C++">
    <compoundname>crypto.h</compoundname>
    <includes local="no">device.h</includes>
    <includes refid="errno_8h" local="no">errno.h</includes>
    <includes refid="util_8h" local="no">sys/util.h</includes>
    <includes refid="____assert_8h" local="no">sys/__assert.h</includes>
    <includes refid="hash_8h" local="no">crypto/hash.h</includes>
    <includes refid="cipher_8h" local="yes">cipher.h</includes>
    <incdepgraph>
      <node id="20">
        <label>cipher.h</label>
        <link refid="cipher_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
      </node>
      <node id="1">
        <label>include/crypto/crypto.h</label>
        <link refid="crypto_2crypto_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="19" relation="include">
        </childnode>
        <childnode refid="20" relation="include">
        </childnode>
      </node>
      <node id="19">
        <label>crypto/hash.h</label>
        <link refid="hash_8h"/>
      </node>
      <node id="15">
        <label>sys/__assert.h</label>
        <link refid="____assert_8h_source"/>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="16" relation="include">
        </childnode>
      </node>
      <node id="4">
        <label>sys/errno_private.h</label>
        <link refid="errno__private_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
      </node>
      <node id="16">
        <label>sys/printk.h</label>
        <link refid="printk_8h"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="18" relation="include">
        </childnode>
      </node>
      <node id="7">
        <label>sys/util.h</label>
        <link refid="util_8h"/>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
      </node>
      <node id="9">
        <label>sys/util_internal.h</label>
        <link refid="util__internal_8h"/>
        <childnode refid="10" relation="include">
        </childnode>
      </node>
      <node id="10">
        <label>util_loops.h</label>
        <link refid="util__loops_8h"/>
      </node>
      <node id="8">
        <label>sys/util_macro.h</label>
        <link refid="util__macro_8h"/>
        <childnode refid="9" relation="include">
        </childnode>
      </node>
      <node id="5">
        <label>toolchain.h</label>
        <link refid="toolchain_8h"/>
      </node>
      <node id="12">
        <label>zephyr/types.h</label>
        <link refid="include_2zephyr_2types_8h"/>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
      </node>
      <node id="3">
        <label>errno.h</label>
        <link refid="errno_8h"/>
        <childnode refid="4" relation="include">
        </childnode>
      </node>
      <node id="18">
        <label>inttypes.h</label>
        <link refid="inttypes_8h"/>
        <childnode refid="14" relation="include">
        </childnode>
      </node>
      <node id="11">
        <label>stdbool.h</label>
        <link refid="stdbool_8h"/>
      </node>
      <node id="14">
        <label>stdint.h</label>
        <link refid="stdint_8h"/>
      </node>
      <node id="2">
        <label>device.h</label>
      </node>
      <node id="17">
        <label>stdarg.h</label>
      </node>
      <node id="13">
        <label>stddef.h</label>
      </node>
      <node id="6">
        <label>syscalls/errno_private.h</label>
      </node>
    </incdepgraph>
    <innerclass refid="structcrypto__driver__api" prot="public">crypto_driver_api</innerclass>
      <sectiondef kind="define">
      <memberdef kind="define" id="group__crypto_1ga821c2629510aad5d591a565767d8abbd" prot="public" static="no">
        <name>CAP_OPAQUE_KEY_HNDL</name>
        <initializer><ref refid="group__sys-util_1ga3a8ea58898cb58fc96013383d39f482c" kindref="member">BIT</ref>(0)</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="include/crypto/crypto.h" line="39" column="9" bodyfile="include/crypto/crypto.h" bodystart="39" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="group__crypto_1ga95fd2a144207a575b2e0d24d5d6bf85a" prot="public" static="no">
        <name>CAP_RAW_KEY</name>
        <initializer><ref refid="group__sys-util_1ga3a8ea58898cb58fc96013383d39f482c" kindref="member">BIT</ref>(1)</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="include/crypto/crypto.h" line="40" column="9" bodyfile="include/crypto/crypto.h" bodystart="40" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="group__crypto_1ga18aeace031f8b9bb4241b44f8b36f056" prot="public" static="no">
        <name>CAP_KEY_LOADING_API</name>
        <initializer><ref refid="group__sys-util_1ga3a8ea58898cb58fc96013383d39f482c" kindref="member">BIT</ref>(2)</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="include/crypto/crypto.h" line="43" column="9" bodyfile="include/crypto/crypto.h" bodystart="43" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="group__crypto_1ga4c00d0513306fbc511fb4828108d37c8" prot="public" static="no">
        <name>CAP_INPLACE_OPS</name>
        <initializer><ref refid="group__sys-util_1ga3a8ea58898cb58fc96013383d39f482c" kindref="member">BIT</ref>(3)</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Whether the output is placed in separate buffer or not </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="include/crypto/crypto.h" line="46" column="9" bodyfile="include/crypto/crypto.h" bodystart="46" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="group__crypto_1ga858150378de8f024e96614a6c2f138a2" prot="public" static="no">
        <name>CAP_SEPARATE_IO_BUFS</name>
        <initializer><ref refid="group__sys-util_1ga3a8ea58898cb58fc96013383d39f482c" kindref="member">BIT</ref>(4)</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="include/crypto/crypto.h" line="47" column="9" bodyfile="include/crypto/crypto.h" bodystart="47" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="group__crypto_1ga469bae7c354d17ba9b22c7ce4d8e076a" prot="public" static="no">
        <name>CAP_SYNC_OPS</name>
        <initializer><ref refid="group__sys-util_1ga3a8ea58898cb58fc96013383d39f482c" kindref="member">BIT</ref>(5)</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>These denotes if the output (completion of a cipher_xxx_op) is conveyed by the op function returning, or it is conveyed by an async notification </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="include/crypto/crypto.h" line="53" column="9" bodyfile="include/crypto/crypto.h" bodystart="53" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="group__crypto_1ga62492a4ce9c9274c78f3a7a915a66983" prot="public" static="no">
        <name>CAP_ASYNC_OPS</name>
        <initializer><ref refid="group__sys-util_1ga3a8ea58898cb58fc96013383d39f482c" kindref="member">BIT</ref>(6)</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="include/crypto/crypto.h" line="54" column="9" bodyfile="include/crypto/crypto.h" bodystart="54" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="group__crypto_1ga6574dce552f5ba3b6f347e260a57d2f5" prot="public" static="no">
        <name>CAP_AUTONONCE</name>
        <initializer><ref refid="group__sys-util_1ga3a8ea58898cb58fc96013383d39f482c" kindref="member">BIT</ref>(7)</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Whether the hardware/driver supports autononce feature </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="include/crypto/crypto.h" line="57" column="9" bodyfile="include/crypto/crypto.h" bodystart="57" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="group__crypto_1ga8fa14517853a8a1c4f134b5772f7d308" prot="public" static="no">
        <name>CAP_NO_IV_PREFIX</name>
        <initializer><ref refid="group__sys-util_1ga3a8ea58898cb58fc96013383d39f482c" kindref="member">BIT</ref>(8)</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Don&apos;t prefix IV to cipher blocks </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="include/crypto/crypto.h" line="60" column="9" bodyfile="include/crypto/crypto.h" bodystart="60" bodyend="-1"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="func">
      <memberdef kind="function" id="group__crypto_1gadb2c24136bb56927bb14d4cfffdd5d80" prot="public" static="yes" const="no" explicit="no" inline="yes" virt="non-virtual">
        <type>int</type>
        <definition>static int crypto_query_hwcaps</definition>
        <argsstring>(const struct device *dev)</argsstring>
        <name>crypto_query_hwcaps</name>
        <param>
          <type>const struct <ref refid="structdevice" kindref="compound">device</ref> *</type>
          <declname>dev</declname>
        </param>
        <briefdescription>
<para>Query the crypto hardware capabilities. </para>
        </briefdescription>
        <detaileddescription>
<para>This API is used by the app to query the capabilities supported by the crypto device. Based on this the app can specify a subset of the supported options to be honored for a session during <ref refid="group__crypto__cipher_1ga0720700438ba5819aa826aa37f0c4227" kindref="member">cipher_begin_session()</ref>.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>dev</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the device structure for the driver instance.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>bitmask of supported options. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="include/crypto/crypto.h" line="108" column="19" bodyfile="include/crypto/crypto.h" bodystart="108" bodyend="127"/>
      </memberdef>
      <memberdef kind="function" id="group__crypto__cipher_1ga0720700438ba5819aa826aa37f0c4227" prot="public" static="yes" const="no" explicit="no" inline="yes" virt="non-virtual">
        <type>int</type>
        <definition>static int cipher_begin_session</definition>
        <argsstring>(const struct device *dev, struct cipher_ctx *ctx, enum cipher_algo algo, enum cipher_mode mode, enum cipher_op optype)</argsstring>
        <name>cipher_begin_session</name>
        <param>
          <type>const struct <ref refid="structdevice" kindref="compound">device</ref> *</type>
          <declname>dev</declname>
        </param>
        <param>
          <type>struct <ref refid="structcipher__ctx" kindref="compound">cipher_ctx</ref> *</type>
          <declname>ctx</declname>
        </param>
        <param>
          <type>enum <ref refid="group__crypto__cipher_1gaa43d9907b508cb28c649aaa524d84424" kindref="member">cipher_algo</ref></type>
          <declname>algo</declname>
        </param>
        <param>
          <type>enum <ref refid="group__crypto__cipher_1gaeedaf8017f8d6518f7dedef365bbae43" kindref="member">cipher_mode</ref></type>
          <declname>mode</declname>
        </param>
        <param>
          <type>enum <ref refid="group__crypto__cipher_1ga1db3a5604bff0669672af4457aaaee21" kindref="member">cipher_op</ref></type>
          <declname>optype</declname>
        </param>
        <briefdescription>
<para>Setup a crypto session. </para>
        </briefdescription>
        <detaileddescription>
<para>Initializes one time parameters, like the session key, algorithm and cipher mode which may remain constant for all operations in the session. The state may be cached in hardware and/or driver data state variables.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>dev</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the device structure for the driver instance. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>ctx</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the context structure. Various one time parameters like key, keylength, etc. are supplied via this structure. The structure documentation specifies which fields are to be populated by the app before making this call. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>algo</parametername>
</parameternamelist>
<parameterdescription>
<para>The crypto algorithm to be used in this session. e.g AES </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>mode</parametername>
</parameternamelist>
<parameterdescription>
<para>The cipher mode to be used in this session. e.g CBC, CTR </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>optype</parametername>
</parameternamelist>
<parameterdescription>
<para>Whether we should encrypt or decrypt in this session</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>0 on success, negative errno code on fail. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="include/crypto/crypto.h" line="159" column="19" bodyfile="include/crypto/crypto.h" bodystart="159" bodyend="188"/>
      </memberdef>
      <memberdef kind="function" id="group__crypto__cipher_1gaa818a3de1f2d6319cd21bf6b7caf7cbb" prot="public" static="yes" const="no" explicit="no" inline="yes" virt="non-virtual">
        <type>int</type>
        <definition>static int cipher_free_session</definition>
        <argsstring>(const struct device *dev, struct cipher_ctx *ctx)</argsstring>
        <name>cipher_free_session</name>
        <param>
          <type>const struct <ref refid="structdevice" kindref="compound">device</ref> *</type>
          <declname>dev</declname>
        </param>
        <param>
          <type>struct <ref refid="structcipher__ctx" kindref="compound">cipher_ctx</ref> *</type>
          <declname>ctx</declname>
        </param>
        <briefdescription>
<para>Cleanup a crypto session. </para>
        </briefdescription>
        <detaileddescription>
<para>Clears the hardware and/or driver state of a previous session.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>dev</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the device structure for the driver instance. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>ctx</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the crypto context structure of the session to be freed.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>0 on success, negative errno code on fail. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="include/crypto/crypto.h" line="201" column="19" bodyfile="include/crypto/crypto.h" bodystart="201" bodyend="209"/>
      </memberdef>
      <memberdef kind="function" id="group__crypto__cipher_1gaaf0add27d9116f584e7bbc2d8f1eb39b" prot="public" static="yes" const="no" explicit="no" inline="yes" virt="non-virtual">
        <type>int</type>
        <definition>static int cipher_callback_set</definition>
        <argsstring>(const struct device *dev, cipher_completion_cb cb)</argsstring>
        <name>cipher_callback_set</name>
        <param>
          <type>const struct <ref refid="structdevice" kindref="compound">device</ref> *</type>
          <declname>dev</declname>
        </param>
        <param>
          <type><ref refid="group__crypto__cipher_1ga062b07459bcc2990535465a7b9044ecd" kindref="member">cipher_completion_cb</ref></type>
          <declname>cb</declname>
        </param>
        <briefdescription>
<para>Registers an async crypto op completion callback with the driver. </para>
        </briefdescription>
        <detaileddescription>
<para>The application can register an async crypto op completion callback handler to be invoked by the driver, on completion of a prior request submitted via cipher_do_op(). Based on crypto device hardware semantics, this is likely to be invoked from an ISR context.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>dev</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the device structure for the driver instance. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>cb</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to application callback to be called by the driver.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>0 on success, -ENOTSUP if the driver does not support async op, negative errno code on other error. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="include/crypto/crypto.h" line="225" column="19" bodyfile="include/crypto/crypto.h" bodystart="225" bodyend="238"/>
      </memberdef>
      <memberdef kind="function" id="group__crypto__cipher_1ga05a2569f8d404593e053ce69817a457e" prot="public" static="yes" const="no" explicit="no" inline="yes" virt="non-virtual">
        <type>int</type>
        <definition>static int cipher_block_op</definition>
        <argsstring>(struct cipher_ctx *ctx, struct cipher_pkt *pkt)</argsstring>
        <name>cipher_block_op</name>
        <param>
          <type>struct <ref refid="structcipher__ctx" kindref="compound">cipher_ctx</ref> *</type>
          <declname>ctx</declname>
        </param>
        <param>
          <type>struct <ref refid="structcipher__pkt" kindref="compound">cipher_pkt</ref> *</type>
          <declname>pkt</declname>
        </param>
        <briefdescription>
<para>Perform single-block crypto operation (ECB cipher mode). This should not be overloaded to operate on multiple blocks for security reasons. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>ctx</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the crypto context of this op. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>pkt</parametername>
</parameternamelist>
<parameterdescription>
<para>Structure holding the input/output buffer pointers.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>0 on success, negative errno code on fail. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="include/crypto/crypto.h" line="249" column="19" bodyfile="include/crypto/crypto.h" bodystart="249" bodyend="257"/>
      </memberdef>
      <memberdef kind="function" id="group__crypto__cipher_1ga2c4ac483eb4e11110be939e669040700" prot="public" static="yes" const="no" explicit="no" inline="yes" virt="non-virtual">
        <type>int</type>
        <definition>static int cipher_cbc_op</definition>
        <argsstring>(struct cipher_ctx *ctx, struct cipher_pkt *pkt, uint8_t *iv)</argsstring>
        <name>cipher_cbc_op</name>
        <param>
          <type>struct <ref refid="structcipher__ctx" kindref="compound">cipher_ctx</ref> *</type>
          <declname>ctx</declname>
        </param>
        <param>
          <type>struct <ref refid="structcipher__pkt" kindref="compound">cipher_pkt</ref> *</type>
          <declname>pkt</declname>
        </param>
        <param>
          <type><ref refid="stdint_8h_1a3cb4a16b0e8d6af0af86d4fd6ba5fd9d" kindref="member">uint8_t</ref> *</type>
          <declname>iv</declname>
        </param>
        <briefdescription>
<para>Perform Cipher Block Chaining (CBC) crypto operation. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>ctx</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the crypto context of this op. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>pkt</parametername>
</parameternamelist>
<parameterdescription>
<para>Structure holding the input/output buffer pointers. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>iv</parametername>
</parameternamelist>
<parameterdescription>
<para>Initialization Vector (IV) for the operation. Same IV value should not be reused across multiple operations (within a session context) for security.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>0 on success, negative errno code on fail. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="include/crypto/crypto.h" line="270" column="19" bodyfile="include/crypto/crypto.h" bodystart="270" bodyend="278"/>
      </memberdef>
      <memberdef kind="function" id="group__crypto__cipher_1gaeffb9d5dd85bf135eb2cca6d47cb373c" prot="public" static="yes" const="no" explicit="no" inline="yes" virt="non-virtual">
        <type>int</type>
        <definition>static int cipher_ctr_op</definition>
        <argsstring>(struct cipher_ctx *ctx, struct cipher_pkt *pkt, uint8_t *iv)</argsstring>
        <name>cipher_ctr_op</name>
        <param>
          <type>struct <ref refid="structcipher__ctx" kindref="compound">cipher_ctx</ref> *</type>
          <declname>ctx</declname>
        </param>
        <param>
          <type>struct <ref refid="structcipher__pkt" kindref="compound">cipher_pkt</ref> *</type>
          <declname>pkt</declname>
        </param>
        <param>
          <type><ref refid="stdint_8h_1a3cb4a16b0e8d6af0af86d4fd6ba5fd9d" kindref="member">uint8_t</ref> *</type>
          <declname>iv</declname>
        </param>
        <briefdescription>
<para>Perform Counter (CTR) mode crypto operation. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>ctx</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the crypto context of this op. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>pkt</parametername>
</parameternamelist>
<parameterdescription>
<para>Structure holding the input/output buffer pointers. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>iv</parametername>
</parameternamelist>
<parameterdescription>
<para>Initialization Vector (IV) for the operation. We use a split counter formed by appending IV and ctr. Consequently ivlen = keylen - ctrlen. &apos;ctrlen&apos; is specified during session setup through the &apos;ctx.mode_params.ctr_params.ctr_len&apos; parameter. IV should not be reused across multiple operations (within a session context) for security. The non-IV part of the split counter is transparent to the caller and is fully managed by the crypto provider.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>0 on success, negative errno code on fail. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="include/crypto/crypto.h" line="297" column="19" bodyfile="include/crypto/crypto.h" bodystart="297" bodyend="305"/>
      </memberdef>
      <memberdef kind="function" id="group__crypto__cipher_1ga4886e7e1cc2fcff411066875b35b8b45" prot="public" static="yes" const="no" explicit="no" inline="yes" virt="non-virtual">
        <type>int</type>
        <definition>static int cipher_ccm_op</definition>
        <argsstring>(struct cipher_ctx *ctx, struct cipher_aead_pkt *pkt, uint8_t *nonce)</argsstring>
        <name>cipher_ccm_op</name>
        <param>
          <type>struct <ref refid="structcipher__ctx" kindref="compound">cipher_ctx</ref> *</type>
          <declname>ctx</declname>
        </param>
        <param>
          <type>struct <ref refid="structcipher__aead__pkt" kindref="compound">cipher_aead_pkt</ref> *</type>
          <declname>pkt</declname>
        </param>
        <param>
          <type><ref refid="stdint_8h_1a3cb4a16b0e8d6af0af86d4fd6ba5fd9d" kindref="member">uint8_t</ref> *</type>
          <declname>nonce</declname>
        </param>
        <briefdescription>
<para>Perform Counter with CBC-MAC (CCM) mode crypto operation. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>ctx</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the crypto context of this op. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>pkt</parametername>
</parameternamelist>
<parameterdescription>
<para>Structure holding the input/output, Assosciated Data (AD) and auth tag buffer pointers. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>nonce</parametername>
</parameternamelist>
<parameterdescription>
<para>Nonce for the operation. Same nonce value should not be reused across multiple operations (within a session context) for security.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>0 on success, negative errno code on fail. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="include/crypto/crypto.h" line="319" column="19" bodyfile="include/crypto/crypto.h" bodystart="319" bodyend="327"/>
      </memberdef>
      <memberdef kind="function" id="group__crypto__cipher_1ga3706b034252e40b818a782c28ba5e485" prot="public" static="yes" const="no" explicit="no" inline="yes" virt="non-virtual">
        <type>int</type>
        <definition>static int cipher_gcm_op</definition>
        <argsstring>(struct cipher_ctx *ctx, struct cipher_aead_pkt *pkt, uint8_t *nonce)</argsstring>
        <name>cipher_gcm_op</name>
        <param>
          <type>struct <ref refid="structcipher__ctx" kindref="compound">cipher_ctx</ref> *</type>
          <declname>ctx</declname>
        </param>
        <param>
          <type>struct <ref refid="structcipher__aead__pkt" kindref="compound">cipher_aead_pkt</ref> *</type>
          <declname>pkt</declname>
        </param>
        <param>
          <type><ref refid="stdint_8h_1a3cb4a16b0e8d6af0af86d4fd6ba5fd9d" kindref="member">uint8_t</ref> *</type>
          <declname>nonce</declname>
        </param>
        <briefdescription>
<para>Perform Galois/Counter Mode (GCM) crypto operation. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>ctx</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the crypto context of this op. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>pkt</parametername>
</parameternamelist>
<parameterdescription>
<para>Structure holding the input/output, Associated Data (AD) and auth tag buffer pointers. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>nonce</parametername>
</parameternamelist>
<parameterdescription>
<para>Nonce for the operation. Same nonce value should not be reused across multiple operations (within a session context) for security.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>0 on success, negative errno code on fail. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="include/crypto/crypto.h" line="341" column="19" bodyfile="include/crypto/crypto.h" bodystart="341" bodyend="349"/>
      </memberdef>
      <memberdef kind="function" id="group__crypto__hash_1ga9b736d047cbfb7530ffa0bc4b64d6ad1" prot="public" static="yes" const="no" explicit="no" inline="yes" virt="non-virtual">
        <type>int</type>
        <definition>static int hash_begin_session</definition>
        <argsstring>(const struct device *dev, struct hash_ctx *ctx, enum hash_algo algo)</argsstring>
        <name>hash_begin_session</name>
        <param>
          <type>const struct <ref refid="structdevice" kindref="compound">device</ref> *</type>
          <declname>dev</declname>
        </param>
        <param>
          <type>struct <ref refid="structhash__ctx" kindref="compound">hash_ctx</ref> *</type>
          <declname>ctx</declname>
        </param>
        <param>
          <type>enum <ref refid="group__crypto__hash_1gaaea88501aa8243eacc8c57ac0914ac7a" kindref="member">hash_algo</ref></type>
          <declname>algo</declname>
        </param>
        <briefdescription>
<para>Setup a hash session. </para>
        </briefdescription>
        <detaileddescription>
<para>Initializes one time parameters, like the algorithm which may remain constant for all operations in the session. The state may be cached in hardware and/or driver data state variables.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>dev</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the device structure for the driver instance. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>ctx</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the context structure. Various one time parameters like session capabilities and algorithm are supplied via this structure. The structure documentation specifies which fields are to be populated by the app before making this call. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>algo</parametername>
</parameternamelist>
<parameterdescription>
<para>The hash algorithm to be used in this session. e.g sha256</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>0 on success, negative errno code on fail. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="include/crypto/crypto.h" line="381" column="19" bodyfile="include/crypto/crypto.h" bodystart="381" bodyend="404"/>
      </memberdef>
      <memberdef kind="function" id="group__crypto__hash_1gadafcd2ad79e0695245c8884b6b282508" prot="public" static="yes" const="no" explicit="no" inline="yes" virt="non-virtual">
        <type>int</type>
        <definition>static int hash_free_session</definition>
        <argsstring>(const struct device *dev, struct hash_ctx *ctx)</argsstring>
        <name>hash_free_session</name>
        <param>
          <type>const struct <ref refid="structdevice" kindref="compound">device</ref> *</type>
          <declname>dev</declname>
        </param>
        <param>
          <type>struct <ref refid="structhash__ctx" kindref="compound">hash_ctx</ref> *</type>
          <declname>ctx</declname>
        </param>
        <briefdescription>
<para>Cleanup a hash session. </para>
        </briefdescription>
        <detaileddescription>
<para>Clears the hardware and/or driver state of a session. <simplesect kind="see"><para><ref refid="group__crypto__hash_1ga9b736d047cbfb7530ffa0bc4b64d6ad1" kindref="member">hash_begin_session</ref></para>
</simplesect>
<parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>dev</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the device structure for the driver instance. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>ctx</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the crypto hash context structure of the session to be freed.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>0 on success, negative errno code on fail. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="include/crypto/crypto.h" line="417" column="19" bodyfile="include/crypto/crypto.h" bodystart="417" bodyend="425"/>
      </memberdef>
      <memberdef kind="function" id="group__crypto__hash_1gaa69bbf41cc150dae0d97b215862729cf" prot="public" static="yes" const="no" explicit="no" inline="yes" virt="non-virtual">
        <type>int</type>
        <definition>static int hash_callback_set</definition>
        <argsstring>(const struct device *dev, hash_completion_cb cb)</argsstring>
        <name>hash_callback_set</name>
        <param>
          <type>const struct <ref refid="structdevice" kindref="compound">device</ref> *</type>
          <declname>dev</declname>
        </param>
        <param>
          <type><ref refid="group__crypto__hash_1ga1f49008c35d9f04b66e587d1b43404bd" kindref="member">hash_completion_cb</ref></type>
          <declname>cb</declname>
        </param>
        <briefdescription>
<para>Registers an async hash completion callback with the driver. </para>
        </briefdescription>
        <detaileddescription>
<para>The application can register an async hash completion callback handler to be invoked by the driver, on completion of a prior request submitted via <ref refid="group__crypto__hash_1ga761e5d0bda9937d7fa4550c876a1c387" kindref="member">hash_compute()</ref>. Based on crypto device hardware semantics, this is likely to be invoked from an ISR context.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>dev</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the device structure for the driver instance. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>cb</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to application callback to be called by the driver.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>0 on success, -ENOTSUP if the driver does not support async op, negative errno code on other error. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="include/crypto/crypto.h" line="441" column="19" bodyfile="include/crypto/crypto.h" bodystart="441" bodyend="454"/>
      </memberdef>
      <memberdef kind="function" id="group__crypto__hash_1ga761e5d0bda9937d7fa4550c876a1c387" prot="public" static="yes" const="no" explicit="no" inline="yes" virt="non-virtual">
        <type>int</type>
        <definition>static int hash_compute</definition>
        <argsstring>(struct hash_ctx *ctx, struct hash_pkt *pkt)</argsstring>
        <name>hash_compute</name>
        <param>
          <type>struct <ref refid="structhash__ctx" kindref="compound">hash_ctx</ref> *</type>
          <declname>ctx</declname>
        </param>
        <param>
          <type>struct <ref refid="structhash__pkt" kindref="compound">hash_pkt</ref> *</type>
          <declname>pkt</declname>
        </param>
        <briefdescription>
<para>Perform a cryptographic hash function. </para>
        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>ctx</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the hash context of this op. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>pkt</parametername>
</parameternamelist>
<parameterdescription>
<para>Structure holding the input/output.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>0 on success, negative errno code on fail. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="include/crypto/crypto.h" line="464" column="19" bodyfile="include/crypto/crypto.h" bodystart="464" bodyend="469"/>
      </memberdef>
      <memberdef kind="function" id="group__crypto__hash_1gaf54ee20fb1ca58764f6f301739c3ba93" prot="public" static="yes" const="no" explicit="no" inline="yes" virt="non-virtual">
        <type>int</type>
        <definition>static int hash_update</definition>
        <argsstring>(struct hash_ctx *ctx, struct hash_pkt *pkt)</argsstring>
        <name>hash_update</name>
        <param>
          <type>struct <ref refid="structhash__ctx" kindref="compound">hash_ctx</ref> *</type>
          <declname>ctx</declname>
        </param>
        <param>
          <type>struct <ref refid="structhash__pkt" kindref="compound">hash_pkt</ref> *</type>
          <declname>pkt</declname>
        </param>
        <briefdescription>
<para>Perform a cryptographic multipart hash operation. </para>
        </briefdescription>
        <detaileddescription>
<para>This function can be called zero or more times, passing a slice of the the data. The hash is calculated using all the given pieces. To calculate the hash call <computeroutput><ref refid="group__crypto__hash_1ga761e5d0bda9937d7fa4550c876a1c387" kindref="member">hash_compute()</ref></computeroutput>.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>ctx</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the hash context of this op. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>pkt</parametername>
</parameternamelist>
<parameterdescription>
<para>Structure holding the input.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>0 on success, negative errno code on fail. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="include/crypto/crypto.h" line="483" column="19" bodyfile="include/crypto/crypto.h" bodystart="483" bodyend="488"/>
      </memberdef>
      </sectiondef>
    <briefdescription>
<para>Crypto Cipher APIs. </para>
    </briefdescription>
    <detaileddescription>
<para>This file contains the Crypto Abstraction layer APIs.</para>
<para>[Experimental] Users should note that the APIs can change as a part of ongoing development. </para>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2"><highlight class="comment"><sp/>*<sp/>Copyright<sp/>(c)<sp/>2016<sp/>Intel<sp/>Corporation.</highlight></codeline>
<codeline lineno="3"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="4"><highlight class="comment"><sp/>*<sp/>SPDX-License-Identifier:<sp/>Apache-2.0</highlight></codeline>
<codeline lineno="5"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight></codeline>
<codeline lineno="17"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>ZEPHYR_INCLUDE_CRYPTO_H_</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="18"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>ZEPHYR_INCLUDE_CRYPTO_H_</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;device.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="errno_8h" kindref="compound">errno.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="22"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="util_8h" kindref="compound">sys/util.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="____assert_8h" kindref="compound">sys/__assert.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="hash_8h" kindref="compound">crypto/hash.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="cipher_8h" kindref="compound">cipher.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="26"><highlight class="normal"></highlight></codeline>
<codeline lineno="34"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>ctx.flags<sp/>values.<sp/>Not<sp/>all<sp/>drivers<sp/>support<sp/>all<sp/>flags.</highlight></codeline>
<codeline lineno="35"><highlight class="comment"><sp/>*<sp/>A<sp/>user<sp/>app<sp/>can<sp/>query<sp/>the<sp/>supported<sp/>hw<sp/>/<sp/>driver</highlight></codeline>
<codeline lineno="36"><highlight class="comment"><sp/>*<sp/>capabilities<sp/>via<sp/>provided<sp/>API<sp/>(crypto_query_hwcaps()),<sp/>and<sp/>choose<sp/>a</highlight></codeline>
<codeline lineno="37"><highlight class="comment"><sp/>*<sp/>supported<sp/>config<sp/>during<sp/>the<sp/>session<sp/>setup.</highlight></codeline>
<codeline lineno="38"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="39" refid="group__crypto_1ga821c2629510aad5d591a565767d8abbd" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>CAP_OPAQUE_KEY_HNDL<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>BIT(0)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="40" refid="group__crypto_1ga95fd2a144207a575b2e0d24d5d6bf85a" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>CAP_RAW_KEY<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>BIT(1)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="41"><highlight class="normal"></highlight></codeline>
<codeline lineno="42"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>TBD<sp/>to<sp/>define<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="43" refid="group__crypto_1ga18aeace031f8b9bb4241b44f8b36f056" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>CAP_KEY_LOADING_API<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>BIT(2)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="44"><highlight class="normal"></highlight></codeline>
<codeline lineno="46" refid="group__crypto_1ga4c00d0513306fbc511fb4828108d37c8" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>CAP_INPLACE_OPS<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>BIT(3)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="47" refid="group__crypto_1ga858150378de8f024e96614a6c2f138a2" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>CAP_SEPARATE_IO_BUFS<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>BIT(4)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="48"><highlight class="normal"></highlight></codeline>
<codeline lineno="53" refid="group__crypto_1ga469bae7c354d17ba9b22c7ce4d8e076a" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>CAP_SYNC_OPS<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>BIT(5)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="54" refid="group__crypto_1ga62492a4ce9c9274c78f3a7a915a66983" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>CAP_ASYNC_OPS<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>BIT(6)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="55"><highlight class="normal"></highlight></codeline>
<codeline lineno="57" refid="group__crypto_1ga6574dce552f5ba3b6f347e260a57d2f5" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>CAP_AUTONONCE<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>BIT(7)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="58"><highlight class="normal"></highlight></codeline>
<codeline lineno="60" refid="group__crypto_1ga8fa14517853a8a1c4f134b5772f7d308" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>CAP_NO_IV_PREFIX<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>BIT(8)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="61"><highlight class="normal"></highlight></codeline>
<codeline lineno="62"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>More<sp/>flags<sp/>to<sp/>be<sp/>added<sp/>as<sp/>necessary<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="63"><highlight class="normal"></highlight></codeline>
<codeline lineno="65" refid="structcrypto__driver__api" refkind="compound"><highlight class="normal">__subsystem<sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structcrypto__driver__api" kindref="compound">crypto_driver_api</ref><sp/>{</highlight></codeline>
<codeline lineno="66" refid="structcrypto__driver__api_1a19859cdd9185f5d333fe6893efc27967" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int<sp/>(*<ref refid="structcrypto__driver__api_1a19859cdd9185f5d333fe6893efc27967" kindref="member">query_hw_caps</ref>)(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structdevice" kindref="compound">device</ref><sp/>*dev);</highlight></codeline>
<codeline lineno="67"><highlight class="normal"></highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Setup<sp/>a<sp/>crypto<sp/>session<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="69" refid="structcrypto__driver__api_1af2ddc3aa1447dbef500715e1ea4dd780" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int<sp/>(*<ref refid="structcrypto__driver__api_1af2ddc3aa1447dbef500715e1ea4dd780" kindref="member">cipher_begin_session</ref>)(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structdevice" kindref="compound">device</ref><sp/>*dev,<sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structcipher__ctx" kindref="compound">cipher_ctx</ref><sp/>*ctx,</highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">enum</highlight><highlight class="normal"><sp/><ref refid="group__crypto__cipher_1gaa43d9907b508cb28c649aaa524d84424" kindref="member">cipher_algo</ref><sp/>algo,<sp/></highlight><highlight class="keyword">enum</highlight><highlight class="normal"><sp/><ref refid="group__crypto__cipher_1gaeedaf8017f8d6518f7dedef365bbae43" kindref="member">cipher_mode</ref><sp/>mode,</highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">enum</highlight><highlight class="normal"><sp/><ref refid="group__crypto__cipher_1ga1db3a5604bff0669672af4457aaaee21" kindref="member">cipher_op</ref><sp/>op_type);</highlight></codeline>
<codeline lineno="72"><highlight class="normal"></highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Tear<sp/>down<sp/>an<sp/>established<sp/>session<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="74" refid="structcrypto__driver__api_1a77f9e6ab2b527c4433ddf5cbcf6b8dca" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int<sp/>(*<ref refid="structcrypto__driver__api_1a77f9e6ab2b527c4433ddf5cbcf6b8dca" kindref="member">cipher_free_session</ref>)(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structdevice" kindref="compound">device</ref><sp/>*dev,<sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structcipher__ctx" kindref="compound">cipher_ctx</ref><sp/>*ctx);</highlight></codeline>
<codeline lineno="75"><highlight class="normal"></highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Register<sp/>async<sp/>crypto<sp/>op<sp/>completion<sp/>callback<sp/>with<sp/>the<sp/>driver<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="77" refid="structcrypto__driver__api_1a2c59735e94df3e8740611937c6ed1c2f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int<sp/>(*<ref refid="structcrypto__driver__api_1a2c59735e94df3e8740611937c6ed1c2f" kindref="member">cipher_async_callback_set</ref>)(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structdevice" kindref="compound">device</ref><sp/>*dev,</highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__crypto__cipher_1ga062b07459bcc2990535465a7b9044ecd" kindref="member">cipher_completion_cb</ref><sp/>cb);</highlight></codeline>
<codeline lineno="79"><highlight class="normal"></highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Setup<sp/>a<sp/>hash<sp/>session<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="81" refid="structcrypto__driver__api_1a48845d14ff94ff16633227d10f971f57" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int<sp/>(*<ref refid="structcrypto__driver__api_1a48845d14ff94ff16633227d10f971f57" kindref="member">hash_begin_session</ref>)(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structdevice" kindref="compound">device</ref><sp/>*dev,<sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structhash__ctx" kindref="compound">hash_ctx</ref><sp/>*ctx,</highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">enum</highlight><highlight class="normal"><sp/><ref refid="group__crypto__hash_1gaaea88501aa8243eacc8c57ac0914ac7a" kindref="member">hash_algo</ref><sp/>algo);</highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Tear<sp/>down<sp/>an<sp/>established<sp/>hash<sp/>session<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="84" refid="structcrypto__driver__api_1aa3033ec374a10abd180af38f6fdc080b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int<sp/>(*<ref refid="structcrypto__driver__api_1aa3033ec374a10abd180af38f6fdc080b" kindref="member">hash_free_session</ref>)(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structdevice" kindref="compound">device</ref><sp/>*dev,<sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structhash__ctx" kindref="compound">hash_ctx</ref><sp/>*ctx);</highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Register<sp/>async<sp/>hash<sp/>op<sp/>completion<sp/>callback<sp/>with<sp/>the<sp/>driver<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="86" refid="structcrypto__driver__api_1a87d5891e9ce4a76ed50c7591ae7a27ff" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int<sp/>(*<ref refid="structcrypto__driver__api_1a87d5891e9ce4a76ed50c7591ae7a27ff" kindref="member">hash_async_callback_set</ref>)(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structdevice" kindref="compound">device</ref><sp/>*dev,</highlight></codeline>
<codeline lineno="87"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__crypto__hash_1ga1f49008c35d9f04b66e587d1b43404bd" kindref="member">hash_completion_cb</ref><sp/>cb);</highlight></codeline>
<codeline lineno="88"><highlight class="normal">};</highlight></codeline>
<codeline lineno="89"><highlight class="normal"></highlight></codeline>
<codeline lineno="90"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Following<sp/>are<sp/>the<sp/>public<sp/>API<sp/>a<sp/>user<sp/>app<sp/>may<sp/>call.</highlight></codeline>
<codeline lineno="91"><highlight class="comment"><sp/>*<sp/>The<sp/>first<sp/>two<sp/>relate<sp/>to<sp/>crypto<sp/>&quot;session&quot;<sp/>setup<sp/>/<sp/>teardown.<sp/>Further<sp/>we</highlight></codeline>
<codeline lineno="92"><highlight class="comment"><sp/>*<sp/>have<sp/>four<sp/>cipher<sp/>mode<sp/>specific<sp/>(CTR,<sp/>CCM,<sp/>CBC<sp/>...)<sp/>calls<sp/>to<sp/>perform<sp/>the</highlight></codeline>
<codeline lineno="93"><highlight class="comment"><sp/>*<sp/>actual<sp/>crypto<sp/>operation<sp/>in<sp/>the<sp/>context<sp/>of<sp/>a<sp/>session.<sp/>Also<sp/>we<sp/>have<sp/>an</highlight></codeline>
<codeline lineno="94"><highlight class="comment"><sp/>*<sp/>API<sp/>to<sp/>provide<sp/>the<sp/>callback<sp/>for<sp/>async<sp/>operations.</highlight></codeline>
<codeline lineno="95"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="96"><highlight class="normal"></highlight></codeline>
<codeline lineno="108" refid="group__crypto_1gadb2c24136bb56927bb14d4cfffdd5d80" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__crypto_1gadb2c24136bb56927bb14d4cfffdd5d80" kindref="member">crypto_query_hwcaps</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="structdevice" kindref="compound">device</ref><sp/>*dev)</highlight></codeline>
<codeline lineno="109"><highlight class="normal">{</highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structcrypto__driver__api" kindref="compound">crypto_driver_api</ref><sp/>*api;</highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>tmp;</highlight></codeline>
<codeline lineno="112"><highlight class="normal"></highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>api<sp/>=<sp/>(</highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structcrypto__driver__api" kindref="compound">crypto_driver_api</ref><sp/>*)<sp/>dev-&gt;<ref refid="structdevice_1a4a2e6a2cfeb6efed7d5383c33458f46d" kindref="member">api</ref>;</highlight></codeline>
<codeline lineno="114"><highlight class="normal"></highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tmp<sp/>=<sp/>api-&gt;<ref refid="structcrypto__driver__api_1a19859cdd9185f5d333fe6893efc27967" kindref="member">query_hw_caps</ref>(dev);</highlight></codeline>
<codeline lineno="116"><highlight class="normal"></highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>__ASSERT((tmp<sp/>&amp;<sp/>(<ref refid="group__crypto_1ga821c2629510aad5d591a565767d8abbd" kindref="member">CAP_OPAQUE_KEY_HNDL</ref><sp/>|<sp/><ref refid="group__crypto_1ga95fd2a144207a575b2e0d24d5d6bf85a" kindref="member">CAP_RAW_KEY</ref>))<sp/>!=<sp/>0,</highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Driver<sp/>should<sp/>support<sp/>at<sp/>least<sp/>one<sp/>key<sp/>type:<sp/>RAW/Opaque&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="119"><highlight class="normal"></highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>__ASSERT((tmp<sp/>&amp;<sp/>(<ref refid="group__crypto_1ga4c00d0513306fbc511fb4828108d37c8" kindref="member">CAP_INPLACE_OPS</ref><sp/>|<sp/><ref refid="group__crypto_1ga858150378de8f024e96614a6c2f138a2" kindref="member">CAP_SEPARATE_IO_BUFS</ref>))<sp/>!=<sp/>0,</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Driver<sp/>should<sp/>support<sp/>at<sp/>least<sp/>one<sp/>IO<sp/>buf<sp/>type:<sp/>Inplace/separate&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="122"><highlight class="normal"></highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>__ASSERT((tmp<sp/>&amp;<sp/>(<ref refid="group__crypto_1ga469bae7c354d17ba9b22c7ce4d8e076a" kindref="member">CAP_SYNC_OPS</ref><sp/>|<sp/><ref refid="group__crypto_1ga62492a4ce9c9274c78f3a7a915a66983" kindref="member">CAP_ASYNC_OPS</ref>))<sp/>!=<sp/>0,</highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Driver<sp/>should<sp/>support<sp/>at<sp/>least<sp/>one<sp/>op-type:<sp/>sync/async&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>tmp;</highlight></codeline>
<codeline lineno="126"><highlight class="normal"></highlight></codeline>
<codeline lineno="127"><highlight class="normal">}</highlight></codeline>
<codeline lineno="128"><highlight class="normal"></highlight></codeline>
<codeline lineno="159" refid="group__crypto__cipher_1ga0720700438ba5819aa826aa37f0c4227" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__crypto__cipher_1ga0720700438ba5819aa826aa37f0c4227" kindref="member">cipher_begin_session</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="structdevice" kindref="compound">device</ref><sp/>*dev,</highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="structcipher__ctx" kindref="compound">cipher_ctx</ref><sp/>*ctx,</highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">enum</highlight><highlight class="normal"><sp/><ref refid="group__crypto__cipher_1gaa43d9907b508cb28c649aaa524d84424" kindref="member">cipher_algo</ref><sp/>algo,</highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">enum</highlight><highlight class="normal"><sp/><ref refid="group__crypto__cipher_1gaeedaf8017f8d6518f7dedef365bbae43" kindref="member">cipher_mode</ref><sp/><sp/>mode,</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">enum</highlight><highlight class="normal"><sp/><ref refid="group__crypto__cipher_1ga1db3a5604bff0669672af4457aaaee21" kindref="member">cipher_op</ref><sp/>optype)</highlight></codeline>
<codeline lineno="164"><highlight class="normal">{</highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structcrypto__driver__api" kindref="compound">crypto_driver_api</ref><sp/>*api;</highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="stdint_8h_1a0a8582351ac627ee8bde2973c825e47f" kindref="member">uint32_t</ref><sp/><ref refid="http__parser_8h_1ab6b306ef981f5e21bb41ea2c2dbe8cd9" kindref="member">flags</ref>;</highlight></codeline>
<codeline lineno="167"><highlight class="normal"></highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>api<sp/>=<sp/>(</highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structcrypto__driver__api" kindref="compound">crypto_driver_api</ref><sp/>*)<sp/>dev-&gt;<ref refid="structdevice_1a4a2e6a2cfeb6efed7d5383c33458f46d" kindref="member">api</ref>;</highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ctx-&gt;<ref refid="structcipher__ctx_1a44842ea8ece2aaea4d757137cdb67b52" kindref="member">device</ref><sp/>=<sp/>dev;</highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ctx-&gt;<ref refid="structcipher__ctx_1ae3eb86d5be42450b761f89114723b682" kindref="member">ops</ref>.<ref refid="structcipher__ops_1a93c8c2c77d44ea013fbb6e7fd788d4d4" kindref="member">cipher_mode</ref><sp/>=<sp/>mode;</highlight></codeline>
<codeline lineno="171"><highlight class="normal"></highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="http__parser_8h_1ab6b306ef981f5e21bb41ea2c2dbe8cd9" kindref="member">flags</ref><sp/>=<sp/>(ctx-&gt;<ref refid="structcipher__ctx_1a5745811b9b08e6df51f9b8f8b14ceae7" kindref="member">flags</ref><sp/>&amp;<sp/>(<ref refid="group__crypto_1ga821c2629510aad5d591a565767d8abbd" kindref="member">CAP_OPAQUE_KEY_HNDL</ref><sp/>|<sp/><ref refid="group__crypto_1ga95fd2a144207a575b2e0d24d5d6bf85a" kindref="member">CAP_RAW_KEY</ref>));</highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>__ASSERT(<ref refid="http__parser_8h_1ab6b306ef981f5e21bb41ea2c2dbe8cd9" kindref="member">flags</ref><sp/>!=<sp/>0U,<sp/></highlight><highlight class="stringliteral">&quot;Keytype<sp/>missing:<sp/>RAW<sp/>Key<sp/>or<sp/>OPAQUE<sp/>handle&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>__ASSERT(<ref refid="http__parser_8h_1ab6b306ef981f5e21bb41ea2c2dbe8cd9" kindref="member">flags</ref><sp/>!=<sp/>(<ref refid="group__crypto_1ga821c2629510aad5d591a565767d8abbd" kindref="member">CAP_OPAQUE_KEY_HNDL</ref><sp/>|<sp/><ref refid="group__crypto_1ga95fd2a144207a575b2e0d24d5d6bf85a" kindref="member">CAP_RAW_KEY</ref>),</highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;conflicting<sp/>options<sp/>for<sp/>keytype&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="176"><highlight class="normal"></highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="http__parser_8h_1ab6b306ef981f5e21bb41ea2c2dbe8cd9" kindref="member">flags</ref><sp/>=<sp/>(ctx-&gt;<ref refid="structcipher__ctx_1a5745811b9b08e6df51f9b8f8b14ceae7" kindref="member">flags</ref><sp/>&amp;<sp/>(<ref refid="group__crypto_1ga4c00d0513306fbc511fb4828108d37c8" kindref="member">CAP_INPLACE_OPS</ref><sp/>|<sp/><ref refid="group__crypto_1ga858150378de8f024e96614a6c2f138a2" kindref="member">CAP_SEPARATE_IO_BUFS</ref>));</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>__ASSERT(<ref refid="http__parser_8h_1ab6b306ef981f5e21bb41ea2c2dbe8cd9" kindref="member">flags</ref><sp/>!=<sp/>0U,<sp/></highlight><highlight class="stringliteral">&quot;IO<sp/>buffer<sp/>type<sp/>missing&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>__ASSERT(<ref refid="http__parser_8h_1ab6b306ef981f5e21bb41ea2c2dbe8cd9" kindref="member">flags</ref><sp/>!=<sp/>(<ref refid="group__crypto_1ga4c00d0513306fbc511fb4828108d37c8" kindref="member">CAP_INPLACE_OPS</ref><sp/>|<sp/><ref refid="group__crypto_1ga858150378de8f024e96614a6c2f138a2" kindref="member">CAP_SEPARATE_IO_BUFS</ref>),</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;conflicting<sp/>options<sp/>for<sp/>IO<sp/>buffer<sp/>type&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="181"><highlight class="normal"></highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="http__parser_8h_1ab6b306ef981f5e21bb41ea2c2dbe8cd9" kindref="member">flags</ref><sp/>=<sp/>(ctx-&gt;<ref refid="structcipher__ctx_1a5745811b9b08e6df51f9b8f8b14ceae7" kindref="member">flags</ref><sp/>&amp;<sp/>(<ref refid="group__crypto_1ga469bae7c354d17ba9b22c7ce4d8e076a" kindref="member">CAP_SYNC_OPS</ref><sp/>|<sp/><ref refid="group__crypto_1ga62492a4ce9c9274c78f3a7a915a66983" kindref="member">CAP_ASYNC_OPS</ref>));</highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>__ASSERT(<ref refid="http__parser_8h_1ab6b306ef981f5e21bb41ea2c2dbe8cd9" kindref="member">flags</ref><sp/>!=<sp/>0U,<sp/></highlight><highlight class="stringliteral">&quot;sync/async<sp/>type<sp/>missing&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>__ASSERT(<ref refid="http__parser_8h_1ab6b306ef981f5e21bb41ea2c2dbe8cd9" kindref="member">flags</ref><sp/>!=<sp/>(<ref refid="group__crypto_1ga469bae7c354d17ba9b22c7ce4d8e076a" kindref="member">CAP_SYNC_OPS</ref><sp/>|<sp/><sp/><ref refid="group__crypto_1ga62492a4ce9c9274c78f3a7a915a66983" kindref="member">CAP_ASYNC_OPS</ref>),</highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;conflicting<sp/>options<sp/>for<sp/>sync/async&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="186"><highlight class="normal"></highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>api-&gt;<ref refid="structcrypto__driver__api_1af2ddc3aa1447dbef500715e1ea4dd780" kindref="member">cipher_begin_session</ref>(dev,<sp/>ctx,<sp/>algo,<sp/>mode,<sp/>optype);</highlight></codeline>
<codeline lineno="188"><highlight class="normal">}</highlight></codeline>
<codeline lineno="189"><highlight class="normal"></highlight></codeline>
<codeline lineno="201" refid="group__crypto__cipher_1gaa818a3de1f2d6319cd21bf6b7caf7cbb" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__crypto__cipher_1gaa818a3de1f2d6319cd21bf6b7caf7cbb" kindref="member">cipher_free_session</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="structdevice" kindref="compound">device</ref><sp/>*dev,</highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="structcipher__ctx" kindref="compound">cipher_ctx</ref><sp/>*ctx)</highlight></codeline>
<codeline lineno="203"><highlight class="normal">{</highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structcrypto__driver__api" kindref="compound">crypto_driver_api</ref><sp/>*api;</highlight></codeline>
<codeline lineno="205"><highlight class="normal"></highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>api<sp/>=<sp/>(</highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structcrypto__driver__api" kindref="compound">crypto_driver_api</ref><sp/>*)<sp/>dev-&gt;<ref refid="structdevice_1a4a2e6a2cfeb6efed7d5383c33458f46d" kindref="member">api</ref>;</highlight></codeline>
<codeline lineno="207"><highlight class="normal"></highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>api-&gt;<ref refid="structcrypto__driver__api_1a77f9e6ab2b527c4433ddf5cbcf6b8dca" kindref="member">cipher_free_session</ref>(dev,<sp/>ctx);</highlight></codeline>
<codeline lineno="209"><highlight class="normal">}</highlight></codeline>
<codeline lineno="210"><highlight class="normal"></highlight></codeline>
<codeline lineno="225" refid="group__crypto__cipher_1gaaf0add27d9116f584e7bbc2d8f1eb39b" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__crypto__cipher_1gaaf0add27d9116f584e7bbc2d8f1eb39b" kindref="member">cipher_callback_set</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="structdevice" kindref="compound">device</ref><sp/>*dev,</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__crypto__cipher_1ga062b07459bcc2990535465a7b9044ecd" kindref="member">cipher_completion_cb</ref><sp/>cb)</highlight></codeline>
<codeline lineno="227"><highlight class="normal">{</highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structcrypto__driver__api" kindref="compound">crypto_driver_api</ref><sp/>*api;</highlight></codeline>
<codeline lineno="229"><highlight class="normal"></highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>api<sp/>=<sp/>(</highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structcrypto__driver__api" kindref="compound">crypto_driver_api</ref><sp/>*)<sp/>dev-&gt;<ref refid="structdevice_1a4a2e6a2cfeb6efed7d5383c33458f46d" kindref="member">api</ref>;</highlight></codeline>
<codeline lineno="231"><highlight class="normal"></highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(api-&gt;<ref refid="structcrypto__driver__api_1a2c59735e94df3e8740611937c6ed1c2f" kindref="member">cipher_async_callback_set</ref>)<sp/>{</highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>api-&gt;<ref refid="structcrypto__driver__api_1a2c59735e94df3e8740611937c6ed1c2f" kindref="member">cipher_async_callback_set</ref>(dev,<sp/>cb);</highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="235"><highlight class="normal"></highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-<ref refid="group__system__errno_1ga91457bbf35f0f1085619a99423bb1f33" kindref="member">ENOTSUP</ref>;</highlight></codeline>
<codeline lineno="237"><highlight class="normal"></highlight></codeline>
<codeline lineno="238"><highlight class="normal">}</highlight></codeline>
<codeline lineno="239"><highlight class="normal"></highlight></codeline>
<codeline lineno="249" refid="group__crypto__cipher_1ga05a2569f8d404593e053ce69817a457e" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__crypto__cipher_1ga05a2569f8d404593e053ce69817a457e" kindref="member">cipher_block_op</ref>(</highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="structcipher__ctx" kindref="compound">cipher_ctx</ref><sp/>*ctx,</highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="structcipher__pkt" kindref="compound">cipher_pkt</ref><sp/>*pkt)</highlight></codeline>
<codeline lineno="251"><highlight class="normal">{</highlight></codeline>
<codeline lineno="252"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>__ASSERT(ctx-&gt;<ref refid="structcipher__ctx_1ae3eb86d5be42450b761f89114723b682" kindref="member">ops</ref>.<ref refid="structcipher__ops_1a93c8c2c77d44ea013fbb6e7fd788d4d4" kindref="member">cipher_mode</ref><sp/>==<sp/><ref refid="group__crypto__cipher_1ggaeedaf8017f8d6518f7dedef365bbae43a30ffc1c7c1489f938ed8c567a4fb885e" kindref="member">CRYPTO_CIPHER_MODE_ECB</ref>,<sp/></highlight><highlight class="stringliteral">&quot;ECB<sp/>mode<sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;session<sp/>invoking<sp/>a<sp/>different<sp/>mode<sp/>handler&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="254"><highlight class="normal"></highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkt-&gt;<ref refid="structcipher__pkt_1a26fb877d705580648da03ce95264d100" kindref="member">ctx</ref><sp/>=<sp/>ctx;</highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ctx-&gt;<ref refid="structcipher__ctx_1ae3eb86d5be42450b761f89114723b682" kindref="member">ops</ref>.<ref refid="structcipher__ops_1a2675dd312be240c24d7d2c0e81bcde2b" kindref="member">block_crypt_hndlr</ref>(ctx,<sp/>pkt);</highlight></codeline>
<codeline lineno="257"><highlight class="normal">}</highlight></codeline>
<codeline lineno="258"><highlight class="normal"></highlight></codeline>
<codeline lineno="270" refid="group__crypto__cipher_1ga2c4ac483eb4e11110be939e669040700" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__crypto__cipher_1ga2c4ac483eb4e11110be939e669040700" kindref="member">cipher_cbc_op</ref>(</highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="structcipher__ctx" kindref="compound">cipher_ctx</ref><sp/>*ctx,</highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="structcipher__pkt" kindref="compound">cipher_pkt</ref><sp/>*pkt,<sp/><ref refid="stdint_8h_1a3cb4a16b0e8d6af0af86d4fd6ba5fd9d" kindref="member">uint8_t</ref><sp/>*iv)</highlight></codeline>
<codeline lineno="272"><highlight class="normal">{</highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>__ASSERT(ctx-&gt;<ref refid="structcipher__ctx_1ae3eb86d5be42450b761f89114723b682" kindref="member">ops</ref>.<ref refid="structcipher__ops_1a93c8c2c77d44ea013fbb6e7fd788d4d4" kindref="member">cipher_mode</ref><sp/>==<sp/><ref refid="group__crypto__cipher_1ggaeedaf8017f8d6518f7dedef365bbae43a98034da3b89ae5c47749c59a3b15bbfd" kindref="member">CRYPTO_CIPHER_MODE_CBC</ref>,<sp/></highlight><highlight class="stringliteral">&quot;CBC<sp/>mode<sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;session<sp/>invoking<sp/>a<sp/>different<sp/>mode<sp/>handler&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="275"><highlight class="normal"></highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkt-&gt;<ref refid="structcipher__pkt_1a26fb877d705580648da03ce95264d100" kindref="member">ctx</ref><sp/>=<sp/>ctx;</highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ctx-&gt;<ref refid="structcipher__ctx_1ae3eb86d5be42450b761f89114723b682" kindref="member">ops</ref>.<ref refid="structcipher__ops_1abc7cf6306467c5aff24ae3faa37902e6" kindref="member">cbc_crypt_hndlr</ref>(ctx,<sp/>pkt,<sp/>iv);</highlight></codeline>
<codeline lineno="278"><highlight class="normal">}</highlight></codeline>
<codeline lineno="279"><highlight class="normal"></highlight></codeline>
<codeline lineno="297" refid="group__crypto__cipher_1gaeffb9d5dd85bf135eb2cca6d47cb373c" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__crypto__cipher_1gaeffb9d5dd85bf135eb2cca6d47cb373c" kindref="member">cipher_ctr_op</ref>(</highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="structcipher__ctx" kindref="compound">cipher_ctx</ref><sp/>*ctx,</highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="structcipher__pkt" kindref="compound">cipher_pkt</ref><sp/>*pkt,<sp/><ref refid="stdint_8h_1a3cb4a16b0e8d6af0af86d4fd6ba5fd9d" kindref="member">uint8_t</ref><sp/>*iv)</highlight></codeline>
<codeline lineno="299"><highlight class="normal">{</highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>__ASSERT(ctx-&gt;<ref refid="structcipher__ctx_1ae3eb86d5be42450b761f89114723b682" kindref="member">ops</ref>.<ref refid="structcipher__ops_1a93c8c2c77d44ea013fbb6e7fd788d4d4" kindref="member">cipher_mode</ref><sp/>==<sp/><ref refid="group__crypto__cipher_1ggaeedaf8017f8d6518f7dedef365bbae43a58823b401487d57d62a067d71bd2e9d2" kindref="member">CRYPTO_CIPHER_MODE_CTR</ref>,<sp/></highlight><highlight class="stringliteral">&quot;CTR<sp/>mode<sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;session<sp/>invoking<sp/>a<sp/>different<sp/>mode<sp/>handler&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="302"><highlight class="normal"></highlight></codeline>
<codeline lineno="303"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkt-&gt;<ref refid="structcipher__pkt_1a26fb877d705580648da03ce95264d100" kindref="member">ctx</ref><sp/>=<sp/>ctx;</highlight></codeline>
<codeline lineno="304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ctx-&gt;<ref refid="structcipher__ctx_1ae3eb86d5be42450b761f89114723b682" kindref="member">ops</ref>.<ref refid="structcipher__ops_1ac792113d841e3a6b7dc107d7123162db" kindref="member">ctr_crypt_hndlr</ref>(ctx,<sp/>pkt,<sp/>iv);</highlight></codeline>
<codeline lineno="305"><highlight class="normal">}</highlight></codeline>
<codeline lineno="306"><highlight class="normal"></highlight></codeline>
<codeline lineno="319" refid="group__crypto__cipher_1ga4886e7e1cc2fcff411066875b35b8b45" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__crypto__cipher_1ga4886e7e1cc2fcff411066875b35b8b45" kindref="member">cipher_ccm_op</ref>(</highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="structcipher__ctx" kindref="compound">cipher_ctx</ref><sp/>*ctx,</highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="structcipher__aead__pkt" kindref="compound">cipher_aead_pkt</ref><sp/>*pkt,<sp/><ref refid="stdint_8h_1a3cb4a16b0e8d6af0af86d4fd6ba5fd9d" kindref="member">uint8_t</ref><sp/>*nonce)</highlight></codeline>
<codeline lineno="321"><highlight class="normal">{</highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>__ASSERT(ctx-&gt;<ref refid="structcipher__ctx_1ae3eb86d5be42450b761f89114723b682" kindref="member">ops</ref>.<ref refid="structcipher__ops_1a93c8c2c77d44ea013fbb6e7fd788d4d4" kindref="member">cipher_mode</ref><sp/>==<sp/><ref refid="group__crypto__cipher_1ggaeedaf8017f8d6518f7dedef365bbae43a5116e1683b8c9c26582863a65128ce3b" kindref="member">CRYPTO_CIPHER_MODE_CCM</ref>,<sp/></highlight><highlight class="stringliteral">&quot;CCM<sp/>mode<sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="323"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;session<sp/>invoking<sp/>a<sp/>different<sp/>mode<sp/>handler&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="324"><highlight class="normal"></highlight></codeline>
<codeline lineno="325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkt-&gt;<ref refid="structcipher__aead__pkt_1a4953711ca04b1c1d17980fff03561d03" kindref="member">pkt</ref>-&gt;<ref refid="structcipher__pkt_1a26fb877d705580648da03ce95264d100" kindref="member">ctx</ref><sp/>=<sp/>ctx;</highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ctx-&gt;<ref refid="structcipher__ctx_1ae3eb86d5be42450b761f89114723b682" kindref="member">ops</ref>.<ref refid="structcipher__ops_1af53f5f04fb5e1a7ca148f786d8cfe41f" kindref="member">ccm_crypt_hndlr</ref>(ctx,<sp/>pkt,<sp/>nonce);</highlight></codeline>
<codeline lineno="327"><highlight class="normal">}</highlight></codeline>
<codeline lineno="328"><highlight class="normal"></highlight></codeline>
<codeline lineno="341" refid="group__crypto__cipher_1ga3706b034252e40b818a782c28ba5e485" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__crypto__cipher_1ga3706b034252e40b818a782c28ba5e485" kindref="member">cipher_gcm_op</ref>(</highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="structcipher__ctx" kindref="compound">cipher_ctx</ref><sp/>*ctx,</highlight></codeline>
<codeline lineno="342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="structcipher__aead__pkt" kindref="compound">cipher_aead_pkt</ref><sp/>*pkt,<sp/><ref refid="stdint_8h_1a3cb4a16b0e8d6af0af86d4fd6ba5fd9d" kindref="member">uint8_t</ref><sp/>*nonce)</highlight></codeline>
<codeline lineno="343"><highlight class="normal">{</highlight></codeline>
<codeline lineno="344"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>__ASSERT(ctx-&gt;<ref refid="structcipher__ctx_1ae3eb86d5be42450b761f89114723b682" kindref="member">ops</ref>.<ref refid="structcipher__ops_1a93c8c2c77d44ea013fbb6e7fd788d4d4" kindref="member">cipher_mode</ref><sp/>==<sp/><ref refid="group__crypto__cipher_1ggaeedaf8017f8d6518f7dedef365bbae43a2f0de7c8f0b9c1a8ac7343ca3ca72c12" kindref="member">CRYPTO_CIPHER_MODE_GCM</ref>,<sp/></highlight><highlight class="stringliteral">&quot;GCM<sp/>mode<sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="345"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;session<sp/>invoking<sp/>a<sp/>different<sp/>mode<sp/>handler&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="346"><highlight class="normal"></highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkt-&gt;<ref refid="structcipher__aead__pkt_1a4953711ca04b1c1d17980fff03561d03" kindref="member">pkt</ref>-&gt;<ref refid="structcipher__pkt_1a26fb877d705580648da03ce95264d100" kindref="member">ctx</ref><sp/>=<sp/>ctx;</highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ctx-&gt;<ref refid="structcipher__ctx_1ae3eb86d5be42450b761f89114723b682" kindref="member">ops</ref>.<ref refid="structcipher__ops_1a570d1ed37d6cce61caa1c6e257f9cdc8" kindref="member">gcm_crypt_hndlr</ref>(ctx,<sp/>pkt,<sp/>nonce);</highlight></codeline>
<codeline lineno="349"><highlight class="normal">}</highlight></codeline>
<codeline lineno="350"><highlight class="normal"></highlight></codeline>
<codeline lineno="351"><highlight class="normal"></highlight></codeline>
<codeline lineno="381" refid="group__crypto__hash_1ga9b736d047cbfb7530ffa0bc4b64d6ad1" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__crypto__hash_1ga9b736d047cbfb7530ffa0bc4b64d6ad1" kindref="member">hash_begin_session</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="structdevice" kindref="compound">device</ref><sp/>*dev,</highlight></codeline>
<codeline lineno="382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="structhash__ctx" kindref="compound">hash_ctx</ref><sp/>*ctx,</highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">enum</highlight><highlight class="normal"><sp/><ref refid="group__crypto__hash_1gaaea88501aa8243eacc8c57ac0914ac7a" kindref="member">hash_algo</ref><sp/>algo)</highlight></codeline>
<codeline lineno="384"><highlight class="normal">{</highlight></codeline>
<codeline lineno="385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="stdint_8h_1a0a8582351ac627ee8bde2973c825e47f" kindref="member">uint32_t</ref><sp/><ref refid="http__parser_8h_1ab6b306ef981f5e21bb41ea2c2dbe8cd9" kindref="member">flags</ref>;</highlight></codeline>
<codeline lineno="386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structcrypto__driver__api" kindref="compound">crypto_driver_api</ref><sp/>*api;</highlight></codeline>
<codeline lineno="387"><highlight class="normal"></highlight></codeline>
<codeline lineno="388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>api<sp/>=<sp/>(</highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structcrypto__driver__api" kindref="compound">crypto_driver_api</ref><sp/>*)<sp/>dev-&gt;<ref refid="structdevice_1a4a2e6a2cfeb6efed7d5383c33458f46d" kindref="member">api</ref>;</highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ctx-&gt;<ref refid="structhash__ctx_1abe1e70bd23305296e54564b5966ff310" kindref="member">device</ref><sp/>=<sp/>dev;</highlight></codeline>
<codeline lineno="390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ctx-&gt;<ref refid="structhash__ctx_1abe1e70bd23305296e54564b5966ff310" kindref="member">device</ref><sp/>=<sp/>dev;</highlight></codeline>
<codeline lineno="391"><highlight class="normal"></highlight></codeline>
<codeline lineno="392"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="http__parser_8h_1ab6b306ef981f5e21bb41ea2c2dbe8cd9" kindref="member">flags</ref><sp/>=<sp/>(ctx-&gt;<ref refid="structhash__ctx_1ab550711912423a0eb03c410aef491854" kindref="member">flags</ref><sp/>&amp;<sp/>(<ref refid="group__crypto_1ga4c00d0513306fbc511fb4828108d37c8" kindref="member">CAP_INPLACE_OPS</ref><sp/>|<sp/><ref refid="group__crypto_1ga858150378de8f024e96614a6c2f138a2" kindref="member">CAP_SEPARATE_IO_BUFS</ref>));</highlight></codeline>
<codeline lineno="393"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>__ASSERT(<ref refid="http__parser_8h_1ab6b306ef981f5e21bb41ea2c2dbe8cd9" kindref="member">flags</ref><sp/>!=<sp/>0U,<sp/></highlight><highlight class="stringliteral">&quot;IO<sp/>buffer<sp/>type<sp/>missing&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="394"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>__ASSERT(<ref refid="http__parser_8h_1ab6b306ef981f5e21bb41ea2c2dbe8cd9" kindref="member">flags</ref><sp/>!=<sp/>(<ref refid="group__crypto_1ga4c00d0513306fbc511fb4828108d37c8" kindref="member">CAP_INPLACE_OPS</ref><sp/>|<sp/><ref refid="group__crypto_1ga858150378de8f024e96614a6c2f138a2" kindref="member">CAP_SEPARATE_IO_BUFS</ref>),</highlight></codeline>
<codeline lineno="395"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;conflicting<sp/>options<sp/>for<sp/>IO<sp/>buffer<sp/>type&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="396"><highlight class="normal"></highlight></codeline>
<codeline lineno="397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="http__parser_8h_1ab6b306ef981f5e21bb41ea2c2dbe8cd9" kindref="member">flags</ref><sp/>=<sp/>(ctx-&gt;<ref refid="structhash__ctx_1ab550711912423a0eb03c410aef491854" kindref="member">flags</ref><sp/>&amp;<sp/>(<ref refid="group__crypto_1ga469bae7c354d17ba9b22c7ce4d8e076a" kindref="member">CAP_SYNC_OPS</ref><sp/>|<sp/><ref refid="group__crypto_1ga62492a4ce9c9274c78f3a7a915a66983" kindref="member">CAP_ASYNC_OPS</ref>));</highlight></codeline>
<codeline lineno="398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>__ASSERT(<ref refid="http__parser_8h_1ab6b306ef981f5e21bb41ea2c2dbe8cd9" kindref="member">flags</ref><sp/>!=<sp/>0U,<sp/></highlight><highlight class="stringliteral">&quot;sync/async<sp/>type<sp/>missing&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>__ASSERT(<ref refid="http__parser_8h_1ab6b306ef981f5e21bb41ea2c2dbe8cd9" kindref="member">flags</ref><sp/>!=<sp/>(<ref refid="group__crypto_1ga469bae7c354d17ba9b22c7ce4d8e076a" kindref="member">CAP_SYNC_OPS</ref><sp/>|<sp/><sp/><ref refid="group__crypto_1ga62492a4ce9c9274c78f3a7a915a66983" kindref="member">CAP_ASYNC_OPS</ref>),</highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;conflicting<sp/>options<sp/>for<sp/>sync/async&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="401"><highlight class="normal"></highlight></codeline>
<codeline lineno="402"><highlight class="normal"></highlight></codeline>
<codeline lineno="403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>api-&gt;<ref refid="structcrypto__driver__api_1a48845d14ff94ff16633227d10f971f57" kindref="member">hash_begin_session</ref>(dev,<sp/>ctx,<sp/>algo);</highlight></codeline>
<codeline lineno="404"><highlight class="normal">}</highlight></codeline>
<codeline lineno="405"><highlight class="normal"></highlight></codeline>
<codeline lineno="417" refid="group__crypto__hash_1gadafcd2ad79e0695245c8884b6b282508" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__crypto__hash_1gadafcd2ad79e0695245c8884b6b282508" kindref="member">hash_free_session</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="structdevice" kindref="compound">device</ref><sp/>*dev,</highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="structhash__ctx" kindref="compound">hash_ctx</ref><sp/>*ctx)</highlight></codeline>
<codeline lineno="419"><highlight class="normal">{</highlight></codeline>
<codeline lineno="420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structcrypto__driver__api" kindref="compound">crypto_driver_api</ref><sp/>*api;</highlight></codeline>
<codeline lineno="421"><highlight class="normal"></highlight></codeline>
<codeline lineno="422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>api<sp/>=<sp/>(</highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structcrypto__driver__api" kindref="compound">crypto_driver_api</ref><sp/>*)<sp/>dev-&gt;<ref refid="structdevice_1a4a2e6a2cfeb6efed7d5383c33458f46d" kindref="member">api</ref>;</highlight></codeline>
<codeline lineno="423"><highlight class="normal"></highlight></codeline>
<codeline lineno="424"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>api-&gt;<ref refid="structcrypto__driver__api_1aa3033ec374a10abd180af38f6fdc080b" kindref="member">hash_free_session</ref>(dev,<sp/>ctx);</highlight></codeline>
<codeline lineno="425"><highlight class="normal">}</highlight></codeline>
<codeline lineno="426"><highlight class="normal"></highlight></codeline>
<codeline lineno="441" refid="group__crypto__hash_1gaa69bbf41cc150dae0d97b215862729cf" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__crypto__hash_1gaa69bbf41cc150dae0d97b215862729cf" kindref="member">hash_callback_set</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="structdevice" kindref="compound">device</ref><sp/>*dev,</highlight></codeline>
<codeline lineno="442"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__crypto__hash_1ga1f49008c35d9f04b66e587d1b43404bd" kindref="member">hash_completion_cb</ref><sp/>cb)</highlight></codeline>
<codeline lineno="443"><highlight class="normal">{</highlight></codeline>
<codeline lineno="444"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structcrypto__driver__api" kindref="compound">crypto_driver_api</ref><sp/>*api;</highlight></codeline>
<codeline lineno="445"><highlight class="normal"></highlight></codeline>
<codeline lineno="446"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>api<sp/>=<sp/>(</highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structcrypto__driver__api" kindref="compound">crypto_driver_api</ref><sp/>*)<sp/>dev-&gt;<ref refid="structdevice_1a4a2e6a2cfeb6efed7d5383c33458f46d" kindref="member">api</ref>;</highlight></codeline>
<codeline lineno="447"><highlight class="normal"></highlight></codeline>
<codeline lineno="448"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(api-&gt;<ref refid="structcrypto__driver__api_1a87d5891e9ce4a76ed50c7591ae7a27ff" kindref="member">hash_async_callback_set</ref>)<sp/>{</highlight></codeline>
<codeline lineno="449"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>api-&gt;<ref refid="structcrypto__driver__api_1a87d5891e9ce4a76ed50c7591ae7a27ff" kindref="member">hash_async_callback_set</ref>(dev,<sp/>cb);</highlight></codeline>
<codeline lineno="450"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="451"><highlight class="normal"></highlight></codeline>
<codeline lineno="452"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-<ref refid="group__system__errno_1ga91457bbf35f0f1085619a99423bb1f33" kindref="member">ENOTSUP</ref>;</highlight></codeline>
<codeline lineno="453"><highlight class="normal"></highlight></codeline>
<codeline lineno="454"><highlight class="normal">}</highlight></codeline>
<codeline lineno="455"><highlight class="normal"></highlight></codeline>
<codeline lineno="464" refid="group__crypto__hash_1ga761e5d0bda9937d7fa4550c876a1c387" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__crypto__hash_1ga761e5d0bda9937d7fa4550c876a1c387" kindref="member">hash_compute</ref>(</highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="structhash__ctx" kindref="compound">hash_ctx</ref><sp/>*ctx,<sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="structhash__pkt" kindref="compound">hash_pkt</ref><sp/>*pkt)</highlight></codeline>
<codeline lineno="465"><highlight class="normal">{</highlight></codeline>
<codeline lineno="466"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkt-&gt;<ref refid="structhash__pkt_1ab5b3ffd87a11ce3838178b2e652d49b9" kindref="member">ctx</ref><sp/>=<sp/>ctx;</highlight></codeline>
<codeline lineno="467"><highlight class="normal"></highlight></codeline>
<codeline lineno="468"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ctx-&gt;<ref refid="structhash__ctx_1a72a2e7af667bed1ee1dabb8411b01e40" kindref="member">hash_hndlr</ref>(ctx,<sp/>pkt,<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="469"><highlight class="normal">}</highlight></codeline>
<codeline lineno="470"><highlight class="normal"></highlight></codeline>
<codeline lineno="483" refid="group__crypto__hash_1gaf54ee20fb1ca58764f6f301739c3ba93" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="group__crypto__hash_1gaf54ee20fb1ca58764f6f301739c3ba93" kindref="member">hash_update</ref>(</highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="structhash__ctx" kindref="compound">hash_ctx</ref><sp/>*ctx,<sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"><sp/><ref refid="structhash__pkt" kindref="compound">hash_pkt</ref><sp/>*pkt)</highlight></codeline>
<codeline lineno="484"><highlight class="normal">{</highlight></codeline>
<codeline lineno="485"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pkt-&gt;<ref refid="structhash__pkt_1ab5b3ffd87a11ce3838178b2e652d49b9" kindref="member">ctx</ref><sp/>=<sp/>ctx;</highlight></codeline>
<codeline lineno="486"><highlight class="normal"></highlight></codeline>
<codeline lineno="487"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ctx-&gt;<ref refid="structhash__ctx_1a72a2e7af667bed1ee1dabb8411b01e40" kindref="member">hash_hndlr</ref>(ctx,<sp/>pkt,<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="488"><highlight class="normal">}</highlight></codeline>
<codeline lineno="489"><highlight class="normal"></highlight></codeline>
<codeline lineno="494"><highlight class="normal"></highlight><highlight class="preprocessor">#endif<sp/></highlight><highlight class="comment">/*<sp/>ZEPHYR_INCLUDE_CRYPTO_H_<sp/>*/</highlight><highlight class="preprocessor"></highlight></codeline>
    </programlisting>
    <location file="include/crypto/crypto.h"/>
  </compounddef>
</doxygen>
