<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Zephyr API Documentation: Architecture-specific userspace APIs</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-zephyr.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-zephyr.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.svg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Zephyr API Documentation
   &#160;<span id="projectnumber">3.0.99</span>
   </div>
   <div id="projectbrief">A Scalable Open Source RTOS</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('group__arch-userspace.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Architecture-specific userspace APIs<div class="ingroups"><a class="el" href="group__arch-interface.html">Architecture Interface</a></div></div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga5e9ab24b9c980e327903fbe3f5bd97f3"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__arch-userspace.html#ga5e9ab24b9c980e327903fbe3f5bd97f3">arch_syscall_invoke0</a> (<a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a> call_id)</td></tr>
<tr class="separator:ga5e9ab24b9c980e327903fbe3f5bd97f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4cfb3b2b38e5afca889e8b9765d6c3df"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__arch-userspace.html#ga4cfb3b2b38e5afca889e8b9765d6c3df">arch_syscall_invoke1</a> (<a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a> arg1, <a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a> call_id)</td></tr>
<tr class="separator:ga4cfb3b2b38e5afca889e8b9765d6c3df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1e78f1022aaf10e88727b142b56d4ef0"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__arch-userspace.html#ga1e78f1022aaf10e88727b142b56d4ef0">arch_syscall_invoke2</a> (<a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a> arg1, <a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a> arg2, <a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a> call_id)</td></tr>
<tr class="separator:ga1e78f1022aaf10e88727b142b56d4ef0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaacb1c66a1b7bf2293fea269f6b5e1c7e"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__arch-userspace.html#gaacb1c66a1b7bf2293fea269f6b5e1c7e">arch_syscall_invoke3</a> (<a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a> arg1, <a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a> arg2, <a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a> arg3, <a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a> call_id)</td></tr>
<tr class="separator:gaacb1c66a1b7bf2293fea269f6b5e1c7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0ba3ae2290827385b226ebdbf3de3b53"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__arch-userspace.html#ga0ba3ae2290827385b226ebdbf3de3b53">arch_syscall_invoke4</a> (<a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a> arg1, <a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a> arg2, <a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a> arg3, <a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a> arg4, <a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a> call_id)</td></tr>
<tr class="separator:ga0ba3ae2290827385b226ebdbf3de3b53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9971c78bc8f579a0dadf84225dc0c3ff"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__arch-userspace.html#ga9971c78bc8f579a0dadf84225dc0c3ff">arch_syscall_invoke5</a> (<a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a> arg1, <a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a> arg2, <a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a> arg3, <a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a> arg4, <a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a> arg5, <a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a> call_id)</td></tr>
<tr class="separator:ga9971c78bc8f579a0dadf84225dc0c3ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac6cae2197637993a86b6ec6803b5742b"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__arch-userspace.html#gac6cae2197637993a86b6ec6803b5742b">arch_syscall_invoke6</a> (<a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a> arg1, <a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a> arg2, <a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a> arg3, <a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a> arg4, <a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a> arg5, <a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a> arg6, <a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a> call_id)</td></tr>
<tr class="separator:gac6cae2197637993a86b6ec6803b5742b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga89ab53a218add419e37f89c1f5fd955f"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="stdbool_8h.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__arch-userspace.html#ga89ab53a218add419e37f89c1f5fd955f">arch_is_user_context</a> (void)</td></tr>
<tr class="separator:ga89ab53a218add419e37f89c1f5fd955f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga71542fcc679a94ad9ea60d7ac46da361"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__arch-userspace.html#ga71542fcc679a94ad9ea60d7ac46da361">arch_mem_domain_max_partitions_get</a> (void)</td></tr>
<tr class="memdesc:ga71542fcc679a94ad9ea60d7ac46da361"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the maximum number of partitions for a memory domain.  <a href="group__arch-userspace.html#ga71542fcc679a94ad9ea60d7ac46da361">More...</a><br /></td></tr>
<tr class="separator:ga71542fcc679a94ad9ea60d7ac46da361"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1532ef5705aa71f0f93899abca0939da"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__arch-userspace.html#ga1532ef5705aa71f0f93899abca0939da">arch_buffer_validate</a> (void *addr, size_t size, int write)</td></tr>
<tr class="memdesc:ga1532ef5705aa71f0f93899abca0939da"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check memory region permissions.  <a href="group__arch-userspace.html#ga1532ef5705aa71f0f93899abca0939da">More...</a><br /></td></tr>
<tr class="separator:ga1532ef5705aa71f0f93899abca0939da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga48be2412ba65ec550ded63e2f1a0470f"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__arch-userspace.html#ga48be2412ba65ec550ded63e2f1a0470f">arch_virt_region_align</a> (<a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a> phys, size_t size)</td></tr>
<tr class="separator:ga48be2412ba65ec550ded63e2f1a0470f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga447daa0454a90a7a3a247de01e522567"><td class="memItemLeft" align="right" valign="top">FUNC_NORETURN void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__arch-userspace.html#ga447daa0454a90a7a3a247de01e522567">arch_user_mode_enter</a> (<a class="el" href="arch__interface_8h.html#af1bd193a26c6e6a8658140185cae42e1">k_thread_entry_t</a> user_entry, void *p1, void *p2, void *p3)</td></tr>
<tr class="separator:ga447daa0454a90a7a3a247de01e522567"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad53908f229d7e2c333574b009493644b"><td class="memItemLeft" align="right" valign="top">FUNC_NORETURN void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__arch-userspace.html#gad53908f229d7e2c333574b009493644b">arch_syscall_oops</a> (void *ssf)</td></tr>
<tr class="memdesc:gad53908f229d7e2c333574b009493644b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Induce a kernel oops that appears to come from a specific location.  <a href="group__arch-userspace.html#gad53908f229d7e2c333574b009493644b">More...</a><br /></td></tr>
<tr class="separator:gad53908f229d7e2c333574b009493644b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga174c4f356fe315c523cefbf513858c9c"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__arch-userspace.html#ga174c4f356fe315c523cefbf513858c9c">arch_user_string_nlen</a> (const char *<a class="el" href="kobject_8c.html#ac3f4657537e42ff1fa877307841464af">s</a>, size_t maxsize, int *err)</td></tr>
<tr class="memdesc:ga174c4f356fe315c523cefbf513858c9c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Safely take the length of a potentially bad string.  <a href="group__arch-userspace.html#ga174c4f356fe315c523cefbf513858c9c">More...</a><br /></td></tr>
<tr class="separator:ga174c4f356fe315c523cefbf513858c9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8c6bb0f6730c115689452b016ac1761f"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="stdbool_8h.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__arch-userspace.html#ga8c6bb0f6730c115689452b016ac1761f">arch_mem_coherent</a> (void *<a class="el" href="printk_8c.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>)</td></tr>
<tr class="memdesc:ga8c6bb0f6730c115689452b016ac1761f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Detect memory coherence type.  <a href="group__arch-userspace.html#ga8c6bb0f6730c115689452b016ac1761f">More...</a><br /></td></tr>
<tr class="separator:ga8c6bb0f6730c115689452b016ac1761f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga306e9d0e5f8094cb75686f1c43d068a9"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__arch-userspace.html#ga306e9d0e5f8094cb75686f1c43d068a9">arch_cohere_stacks</a> (struct <a class="el" href="structk__thread.html">k_thread</a> *old_thread, void *old_switch_handle, struct <a class="el" href="structk__thread.html">k_thread</a> *new_thread)</td></tr>
<tr class="memdesc:ga306e9d0e5f8094cb75686f1c43d068a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Ensure cache coherence prior to context switch.  <a href="group__arch-userspace.html#ga306e9d0e5f8094cb75686f1c43d068a9">More...</a><br /></td></tr>
<tr class="separator:ga306e9d0e5f8094cb75686f1c43d068a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga1532ef5705aa71f0f93899abca0939da" name="ga1532ef5705aa71f0f93899abca0939da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1532ef5705aa71f0f93899abca0939da">&#9670;&nbsp;</a></span>arch_buffer_validate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int arch_buffer_validate </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>write</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="arch__interface_8h.html">include/sys/arch_interface.h</a>&gt;</code></p>

<p>Check memory region permissions. </p>
<p >Given a memory region, return whether the current memory management hardware configuration would allow a user thread to read/write that region. Used by system calls to validate buffers coming in from userspace.</p>
<p >Notes: The function is guaranteed to never return validation success, if the entire buffer area is not user accessible.</p>
<p >The function is guaranteed to correctly validate the permissions of the supplied buffer, if the user access permissions of the entire buffer are enforced by a single, enabled memory management region.</p>
<p >In some architectures the validation will always return failure if the supplied memory buffer spans multiple enabled memory management regions (even if all such regions permit user access).</p>
<dl class="section warning"><dt>Warning</dt><dd>0 size buffer has undefined behavior.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">addr</td><td>start address of the buffer </td></tr>
    <tr><td class="paramname">size</td><td>the size of the buffer </td></tr>
    <tr><td class="paramname">write</td><td>If nonzero, additionally check if the area is writable. Otherwise, just check if the memory can be read.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>nonzero if the permissions don't match. </dd></dl>

</div>
</div>
<a id="ga306e9d0e5f8094cb75686f1c43d068a9" name="ga306e9d0e5f8094cb75686f1c43d068a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga306e9d0e5f8094cb75686f1c43d068a9">&#9670;&nbsp;</a></span>arch_cohere_stacks()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void arch_cohere_stacks </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structk__thread.html">k_thread</a> *&#160;</td>
          <td class="paramname"><em>old_thread</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>old_switch_handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structk__thread.html">k_thread</a> *&#160;</td>
          <td class="paramname"><em>new_thread</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="arch__interface_8h.html">include/sys/arch_interface.h</a>&gt;</code></p>

<p>Ensure cache coherence prior to context switch. </p>
<p >Required when ARCH_HAS_COHERENCE is true. On cache-incoherent multiprocessor architectures, thread stacks are cached by default for performance reasons. They must therefore be flushed appropriately on context switch. The rules are:</p>
<ol type="1">
<li>The region containing live data in the old stack (generally the bytes between the current stack pointer and the top of the stack memory) must be flushed to underlying storage so a new CPU that runs the same thread sees the correct data. This must happen before the assignment of the switch_handle field in the thread struct which signals the completion of context switch.</li>
<li>Any data areas to be read from the new stack (generally the same as the live region when it was saved) should be invalidated (and NOT flushed!) in the data cache. This is because another CPU may have run or re-initialized the thread since this CPU suspended it, and any data present in cache will be stale.</li>
</ol>
<dl class="section note"><dt>Note</dt><dd>The kernel will call this function during interrupt exit when a new thread has been chosen to run, and also immediately before entering <a class="el" href="group__arch-threads.html#gab411d82ce5b60f062171f5a19e33e025">arch_switch()</a> to effect a code-driven context switch. In the latter case, it is very likely that more data will be written to the old_thread stack region after this function returns but before the completion of the switch. Simply flushing naively here is not sufficient on many architectures and coordination with the <a class="el" href="group__arch-threads.html#gab411d82ce5b60f062171f5a19e33e025">arch_switch()</a> implementation is likely required.</dd></dl>
<ul>
<li>old_thread The old thread to be flushed before being allowed to run on other CPUs. </li>
<li>old_switch_handle The switch handle to be stored into old_thread (it will not be valid until the cache is flushed so is not present yet). This will be NULL if inside z_swap() (because the <a class="el" href="group__arch-threads.html#gab411d82ce5b60f062171f5a19e33e025">arch_switch()</a> has not saved it yet). </li>
<li>new_thread The new thread to be invalidated before it runs locally. </li>
</ul>

</div>
</div>
<a id="ga89ab53a218add419e37f89c1f5fd955f" name="ga89ab53a218add419e37f89c1f5fd955f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga89ab53a218add419e37f89c1f5fd955f">&#9670;&nbsp;</a></span>arch_is_user_context()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="stdbool_8h.html#abb452686968e48b67397da5f97445f5b">bool</a> arch_is_user_context </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="arch__interface_8h.html">include/sys/arch_interface.h</a>&gt;</code></p>
<p >Indicate whether we are currently running in user mode</p>
<dl class="section return"><dt>Returns</dt><dd>true if the CPU is currently running with user permissions </dd></dl>

</div>
</div>
<a id="ga8c6bb0f6730c115689452b016ac1761f" name="ga8c6bb0f6730c115689452b016ac1761f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8c6bb0f6730c115689452b016ac1761f">&#9670;&nbsp;</a></span>arch_mem_coherent()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="stdbool_8h.html#abb452686968e48b67397da5f97445f5b">bool</a> arch_mem_coherent </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ptr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="arch__interface_8h.html">include/sys/arch_interface.h</a>&gt;</code></p>

<p>Detect memory coherence type. </p>
<p >Required when ARCH_HAS_COHERENCE is true. This function returns true if the byte pointed to lies within an architecture-defined "coherence region" (typically implemented with uncached memory) and can safely be used in multiprocessor code without explicit flush or invalidate operations.</p>
<dl class="section note"><dt>Note</dt><dd>The result is for only the single byte at the specified address, this API is not required to check region boundaries or to expect aligned pointers. The expectation is that the code above will have queried the appropriate address(es). </dd></dl>

</div>
</div>
<a id="ga71542fcc679a94ad9ea60d7ac46da361" name="ga71542fcc679a94ad9ea60d7ac46da361"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga71542fcc679a94ad9ea60d7ac46da361">&#9670;&nbsp;</a></span>arch_mem_domain_max_partitions_get()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int arch_mem_domain_max_partitions_get </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="arch__interface_8h.html">include/sys/arch_interface.h</a>&gt;</code></p>

<p>Get the maximum number of partitions for a memory domain. </p>
<dl class="section return"><dt>Returns</dt><dd>Max number of partitions, or -1 if there is no limit </dd></dl>

</div>
</div>
<a id="ga5e9ab24b9c980e327903fbe3f5bd97f3" name="ga5e9ab24b9c980e327903fbe3f5bd97f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5e9ab24b9c980e327903fbe3f5bd97f3">&#9670;&nbsp;</a></span>arch_syscall_invoke0()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a> arch_syscall_invoke0 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>&#160;</td>
          <td class="paramname"><em>call_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="arch__interface_8h.html">include/sys/arch_interface.h</a>&gt;</code></p>
<p >Invoke a system call with 0 arguments.</p>
<p >No general-purpose register state other than return value may be preserved when transitioning from supervisor mode back down to user mode for security reasons.</p>
<p >It is required that all arguments be stored in registers when elevating privileges from user to supervisor mode.</p>
<p >Processing of the syscall takes place on a separate kernel stack. Interrupts should be enabled when invoking the system call marshallers from the dispatch table. Thread preemption may occur when handling system calls.</p>
<p >Call ids are untrusted and must be bounds-checked, as the value is used to index the system call dispatch table, containing function pointers to the specific system call code.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">call_id</td><td>System call ID </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Return value of the system call. Void system calls return 0 here. </dd></dl>

</div>
</div>
<a id="ga4cfb3b2b38e5afca889e8b9765d6c3df" name="ga4cfb3b2b38e5afca889e8b9765d6c3df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4cfb3b2b38e5afca889e8b9765d6c3df">&#9670;&nbsp;</a></span>arch_syscall_invoke1()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a> arch_syscall_invoke1 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>&#160;</td>
          <td class="paramname"><em>arg1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>&#160;</td>
          <td class="paramname"><em>call_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="arch__interface_8h.html">include/sys/arch_interface.h</a>&gt;</code></p>
<p >Invoke a system call with 1 argument.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__arch-userspace.html#ga5e9ab24b9c980e327903fbe3f5bd97f3">arch_syscall_invoke0()</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arg1</td><td>First argument to the system call. </td></tr>
    <tr><td class="paramname">call_id</td><td>System call ID, will be bounds-checked and used to reference kernel-side dispatch table </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Return value of the system call. Void system calls return 0 here. </dd></dl>

</div>
</div>
<a id="ga1e78f1022aaf10e88727b142b56d4ef0" name="ga1e78f1022aaf10e88727b142b56d4ef0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1e78f1022aaf10e88727b142b56d4ef0">&#9670;&nbsp;</a></span>arch_syscall_invoke2()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a> arch_syscall_invoke2 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>&#160;</td>
          <td class="paramname"><em>arg1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>&#160;</td>
          <td class="paramname"><em>arg2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>&#160;</td>
          <td class="paramname"><em>call_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="arch__interface_8h.html">include/sys/arch_interface.h</a>&gt;</code></p>
<p >Invoke a system call with 2 arguments.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__arch-userspace.html#ga5e9ab24b9c980e327903fbe3f5bd97f3">arch_syscall_invoke0()</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arg1</td><td>First argument to the system call. </td></tr>
    <tr><td class="paramname">arg2</td><td>Second argument to the system call. </td></tr>
    <tr><td class="paramname">call_id</td><td>System call ID, will be bounds-checked and used to reference kernel-side dispatch table </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Return value of the system call. Void system calls return 0 here. </dd></dl>

</div>
</div>
<a id="gaacb1c66a1b7bf2293fea269f6b5e1c7e" name="gaacb1c66a1b7bf2293fea269f6b5e1c7e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaacb1c66a1b7bf2293fea269f6b5e1c7e">&#9670;&nbsp;</a></span>arch_syscall_invoke3()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a> arch_syscall_invoke3 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>&#160;</td>
          <td class="paramname"><em>arg1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>&#160;</td>
          <td class="paramname"><em>arg2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>&#160;</td>
          <td class="paramname"><em>arg3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>&#160;</td>
          <td class="paramname"><em>call_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="arch__interface_8h.html">include/sys/arch_interface.h</a>&gt;</code></p>
<p >Invoke a system call with 3 arguments.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__arch-userspace.html#ga5e9ab24b9c980e327903fbe3f5bd97f3">arch_syscall_invoke0()</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arg1</td><td>First argument to the system call. </td></tr>
    <tr><td class="paramname">arg2</td><td>Second argument to the system call. </td></tr>
    <tr><td class="paramname">arg3</td><td>Third argument to the system call. </td></tr>
    <tr><td class="paramname">call_id</td><td>System call ID, will be bounds-checked and used to reference kernel-side dispatch table </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Return value of the system call. Void system calls return 0 here. </dd></dl>

</div>
</div>
<a id="ga0ba3ae2290827385b226ebdbf3de3b53" name="ga0ba3ae2290827385b226ebdbf3de3b53"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0ba3ae2290827385b226ebdbf3de3b53">&#9670;&nbsp;</a></span>arch_syscall_invoke4()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a> arch_syscall_invoke4 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>&#160;</td>
          <td class="paramname"><em>arg1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>&#160;</td>
          <td class="paramname"><em>arg2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>&#160;</td>
          <td class="paramname"><em>arg3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>&#160;</td>
          <td class="paramname"><em>arg4</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>&#160;</td>
          <td class="paramname"><em>call_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="arch__interface_8h.html">include/sys/arch_interface.h</a>&gt;</code></p>
<p >Invoke a system call with 4 arguments.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__arch-userspace.html#ga5e9ab24b9c980e327903fbe3f5bd97f3">arch_syscall_invoke0()</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arg1</td><td>First argument to the system call. </td></tr>
    <tr><td class="paramname">arg2</td><td>Second argument to the system call. </td></tr>
    <tr><td class="paramname">arg3</td><td>Third argument to the system call. </td></tr>
    <tr><td class="paramname">arg4</td><td>Fourth argument to the system call. </td></tr>
    <tr><td class="paramname">call_id</td><td>System call ID, will be bounds-checked and used to reference kernel-side dispatch table </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Return value of the system call. Void system calls return 0 here. </dd></dl>

</div>
</div>
<a id="ga9971c78bc8f579a0dadf84225dc0c3ff" name="ga9971c78bc8f579a0dadf84225dc0c3ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9971c78bc8f579a0dadf84225dc0c3ff">&#9670;&nbsp;</a></span>arch_syscall_invoke5()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a> arch_syscall_invoke5 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>&#160;</td>
          <td class="paramname"><em>arg1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>&#160;</td>
          <td class="paramname"><em>arg2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>&#160;</td>
          <td class="paramname"><em>arg3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>&#160;</td>
          <td class="paramname"><em>arg4</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>&#160;</td>
          <td class="paramname"><em>arg5</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>&#160;</td>
          <td class="paramname"><em>call_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="arch__interface_8h.html">include/sys/arch_interface.h</a>&gt;</code></p>
<p >Invoke a system call with 5 arguments.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__arch-userspace.html#ga5e9ab24b9c980e327903fbe3f5bd97f3">arch_syscall_invoke0()</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arg1</td><td>First argument to the system call. </td></tr>
    <tr><td class="paramname">arg2</td><td>Second argument to the system call. </td></tr>
    <tr><td class="paramname">arg3</td><td>Third argument to the system call. </td></tr>
    <tr><td class="paramname">arg4</td><td>Fourth argument to the system call. </td></tr>
    <tr><td class="paramname">arg5</td><td>Fifth argument to the system call. </td></tr>
    <tr><td class="paramname">call_id</td><td>System call ID, will be bounds-checked and used to reference kernel-side dispatch table </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Return value of the system call. Void system calls return 0 here. </dd></dl>

</div>
</div>
<a id="gac6cae2197637993a86b6ec6803b5742b" name="gac6cae2197637993a86b6ec6803b5742b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac6cae2197637993a86b6ec6803b5742b">&#9670;&nbsp;</a></span>arch_syscall_invoke6()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a> arch_syscall_invoke6 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>&#160;</td>
          <td class="paramname"><em>arg1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>&#160;</td>
          <td class="paramname"><em>arg2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>&#160;</td>
          <td class="paramname"><em>arg3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>&#160;</td>
          <td class="paramname"><em>arg4</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>&#160;</td>
          <td class="paramname"><em>arg5</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>&#160;</td>
          <td class="paramname"><em>arg6</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>&#160;</td>
          <td class="paramname"><em>call_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="arch__interface_8h.html">include/sys/arch_interface.h</a>&gt;</code></p>
<p >Invoke a system call with 6 arguments.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__arch-userspace.html#ga5e9ab24b9c980e327903fbe3f5bd97f3">arch_syscall_invoke0()</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arg1</td><td>First argument to the system call. </td></tr>
    <tr><td class="paramname">arg2</td><td>Second argument to the system call. </td></tr>
    <tr><td class="paramname">arg3</td><td>Third argument to the system call. </td></tr>
    <tr><td class="paramname">arg4</td><td>Fourth argument to the system call. </td></tr>
    <tr><td class="paramname">arg5</td><td>Fifth argument to the system call. </td></tr>
    <tr><td class="paramname">arg6</td><td>Sixth argument to the system call. </td></tr>
    <tr><td class="paramname">call_id</td><td>System call ID, will be bounds-checked and used to reference kernel-side dispatch table </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Return value of the system call. Void system calls return 0 here. </dd></dl>

</div>
</div>
<a id="gad53908f229d7e2c333574b009493644b" name="gad53908f229d7e2c333574b009493644b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad53908f229d7e2c333574b009493644b">&#9670;&nbsp;</a></span>arch_syscall_oops()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">FUNC_NORETURN void arch_syscall_oops </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ssf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="arch__interface_8h.html">include/sys/arch_interface.h</a>&gt;</code></p>

<p>Induce a kernel oops that appears to come from a specific location. </p>
<p >Normally, <a class="el" href="include_2kernel_8h.html#abde5aa8ca5e64a045b25b88f91370dcd" title="Fatally terminate a thread.">k_oops()</a> generates an exception that appears to come from the call site of the <a class="el" href="include_2kernel_8h.html#abde5aa8ca5e64a045b25b88f91370dcd" title="Fatally terminate a thread.">k_oops()</a> itself.</p>
<p >However, when validating arguments to a system call, if there are problems we want the oops to appear to come from where the system call was invoked and not inside the validation function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ssf</td><td>System call stack frame pointer. This gets passed as an argument to _k_syscall_handler_t functions and its contents are completely architecture specific. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga447daa0454a90a7a3a247de01e522567" name="ga447daa0454a90a7a3a247de01e522567"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga447daa0454a90a7a3a247de01e522567">&#9670;&nbsp;</a></span>arch_user_mode_enter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">FUNC_NORETURN void arch_user_mode_enter </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="arch__interface_8h.html#af1bd193a26c6e6a8658140185cae42e1">k_thread_entry_t</a>&#160;</td>
          <td class="paramname"><em>user_entry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p3</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="arch__interface_8h.html">include/sys/arch_interface.h</a>&gt;</code></p>
<p >Perform a one-way transition from supervisor to kernel mode.</p>
<p >Implementations of this function must do the following:</p>
<ul>
<li>Reset the thread's stack pointer to a suitable initial value. We do not need any prior context since this is a one-way operation.</li>
<li>Set up any kernel stack region for the CPU to use during privilege elevation</li>
<li>Put the CPU in whatever its equivalent of user mode is</li>
<li>Transfer execution to <a class="el" href="group__arch-threads.html#gade449838e445fa8201266e38215c616c">arch_new_thread()</a> passing along all the supplied arguments, in user mode.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">user_entry</td><td>Entry point to start executing as a user thread </td></tr>
    <tr><td class="paramname">p1</td><td>1st parameter to user thread </td></tr>
    <tr><td class="paramname">p2</td><td>2nd parameter to user thread </td></tr>
    <tr><td class="paramname">p3</td><td>3rd parameter to user thread </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga174c4f356fe315c523cefbf513858c9c" name="ga174c4f356fe315c523cefbf513858c9c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga174c4f356fe315c523cefbf513858c9c">&#9670;&nbsp;</a></span>arch_user_string_nlen()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t arch_user_string_nlen </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>maxsize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>err</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="arch__interface_8h.html">include/sys/arch_interface.h</a>&gt;</code></p>

<p>Safely take the length of a potentially bad string. </p>
<p >This must not fault, instead the err parameter must have -1 written to it. This function otherwise should work exactly like libc <a class="el" href="string_8h.html#afc92d2231e45d19988c7894aa2a07f0c">strnlen()</a>. On success *err should be set to 0.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>String to measure </td></tr>
    <tr><td class="paramname">maxsize</td><td>Max length of the string </td></tr>
    <tr><td class="paramname">err</td><td>Error value to write </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Length of the string, not counting NULL byte, up to maxsize </dd></dl>

</div>
</div>
<a id="ga48be2412ba65ec550ded63e2f1a0470f" name="ga48be2412ba65ec550ded63e2f1a0470f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga48be2412ba65ec550ded63e2f1a0470f">&#9670;&nbsp;</a></span>arch_virt_region_align()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t arch_virt_region_align </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a4788399d1d0b37ccf098a7da82254808">uintptr_t</a>&#160;</td>
          <td class="paramname"><em>phys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="arch__interface_8h.html">include/sys/arch_interface.h</a>&gt;</code></p>
<p >Get the optimal virtual region alignment to optimize the MMU table layout</p>
<p >Some MMU HW requires some region to be aligned to some of the intermediate block alignment in order to reduce table usage. This call returns the optimal virtual address alignment in order to permit such optimization in the following MMU mapping call.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">phys</td><td>Physical address of region to be mapped, aligned to MMU_PAGE_SIZE </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">size</td><td>Size of region to be mapped, aligned to MMU_PAGE_SIZE</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">alignment</td><td>to apply on the virtual address of this region </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Sat Mar 5 2022 05:00:46 for Zephyr API Documentation by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2 </li>
  </ul>
</div>
<script type="text/javascript">
  $(function() {
    toggleButton = document.createElement('doxygen-awesome-dark-mode-toggle')
    toggleButton.title = "Toggle Light/Dark Mode"
    $(document).ready(function(){
      document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
    })
    // every resize will remove the button, which is why it has to be added again:
    $(window).resize(function(){
      document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
    })
  })
</script>
</body>
</html>
