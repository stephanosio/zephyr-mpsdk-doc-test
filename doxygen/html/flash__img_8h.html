<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Zephyr API Documentation: include/dfu/flash_img.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-zephyr.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-zephyr.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.svg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Zephyr API Documentation
   &#160;<span id="projectnumber">3.0.0-rc3</span>
   </div>
   <div id="projectbrief">A Scalable Open Source RTOS</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('flash__img_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">flash_img.h File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;<a class="el" href="stream__flash_8h_source.html">storage/stream_flash.h</a>&gt;</code><br />
</div>
<p><a href="flash__img_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structflash__img__context.html">flash_img_context</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structflash__img__check.html">flash_img_check</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure for verify flash region integrity.  <a href="structflash__img__check.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a1b194edcb7e4ae34717d011f08d93e0c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flash__img_8h.html#a1b194edcb7e4ae34717d011f08d93e0c">flash_img_init_id</a> (struct <a class="el" href="structflash__img__context.html">flash_img_context</a> *ctx, <a class="el" href="stdint_8h.html#a3cb4a16b0e8d6af0af86d4fd6ba5fd9d">uint8_t</a> area_id)</td></tr>
<tr class="memdesc:a1b194edcb7e4ae34717d011f08d93e0c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize context needed for writing the image to the flash.  <a href="flash__img_8h.html#a1b194edcb7e4ae34717d011f08d93e0c">More...</a><br /></td></tr>
<tr class="separator:a1b194edcb7e4ae34717d011f08d93e0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6d1d7811516493242b318be2ecd82df"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flash__img_8h.html#ac6d1d7811516493242b318be2ecd82df">flash_img_init</a> (struct <a class="el" href="structflash__img__context.html">flash_img_context</a> *ctx)</td></tr>
<tr class="memdesc:ac6d1d7811516493242b318be2ecd82df"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize context needed for writing the image to the flash.  <a href="flash__img_8h.html#ac6d1d7811516493242b318be2ecd82df">More...</a><br /></td></tr>
<tr class="separator:ac6d1d7811516493242b318be2ecd82df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1ef017d400bda921ca894d13126b390"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flash__img_8h.html#ac1ef017d400bda921ca894d13126b390">flash_img_bytes_written</a> (struct <a class="el" href="structflash__img__context.html">flash_img_context</a> *ctx)</td></tr>
<tr class="memdesc:ac1ef017d400bda921ca894d13126b390"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read number of bytes of the image written to the flash.  <a href="flash__img_8h.html#ac1ef017d400bda921ca894d13126b390">More...</a><br /></td></tr>
<tr class="separator:ac1ef017d400bda921ca894d13126b390"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3cb2d6be9f993bcf5a97931475d9a6d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flash__img_8h.html#ae3cb2d6be9f993bcf5a97931475d9a6d">flash_img_buffered_write</a> (struct <a class="el" href="structflash__img__context.html">flash_img_context</a> *ctx, const <a class="el" href="stdint_8h.html#a3cb4a16b0e8d6af0af86d4fd6ba5fd9d">uint8_t</a> *<a class="el" href="test__stack__fail_8c.html#a4bb6fa6c719fd9021449009ab8befc04">data</a>, size_t len, <a class="el" href="stdbool_8h.html#abb452686968e48b67397da5f97445f5b">bool</a> flush)</td></tr>
<tr class="memdesc:ae3cb2d6be9f993bcf5a97931475d9a6d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process input buffers to be written to the image slot 1. flash memory in single blocks. Will store remainder between calls.  <a href="flash__img_8h.html#ae3cb2d6be9f993bcf5a97931475d9a6d">More...</a><br /></td></tr>
<tr class="separator:ae3cb2d6be9f993bcf5a97931475d9a6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a025255d8bf4a94f9e8d315d5502e88"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="flash__img_8h.html#a5a025255d8bf4a94f9e8d315d5502e88">flash_img_check</a> (struct <a class="el" href="structflash__img__context.html">flash_img_context</a> *ctx, const struct <a class="el" href="structflash__img__check.html">flash_img_check</a> *fic, <a class="el" href="stdint_8h.html#a3cb4a16b0e8d6af0af86d4fd6ba5fd9d">uint8_t</a> area_id)</td></tr>
<tr class="memdesc:a5a025255d8bf4a94f9e8d315d5502e88"><td class="mdescLeft">&#160;</td><td class="mdescRight">Verify flash memory length bytes integrity from a flash area. The start point is indicated by an offset value.  <a href="flash__img_8h.html#a5a025255d8bf4a94f9e8d315d5502e88">More...</a><br /></td></tr>
<tr class="separator:a5a025255d8bf4a94f9e8d315d5502e88"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="ae3cb2d6be9f993bcf5a97931475d9a6d" name="ae3cb2d6be9f993bcf5a97931475d9a6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3cb2d6be9f993bcf5a97931475d9a6d">&#9670;&nbsp;</a></span>flash_img_buffered_write()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int flash_img_buffered_write </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structflash__img__context.html">flash_img_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="stdint_8h.html#a3cb4a16b0e8d6af0af86d4fd6ba5fd9d">uint8_t</a> *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdbool_8h.html#abb452686968e48b67397da5f97445f5b">bool</a>&#160;</td>
          <td class="paramname"><em>flush</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Process input buffers to be written to the image slot 1. flash memory in single blocks. Will store remainder between calls. </p>
<p >A final call to this function with flush set to true will write out the remaining block buffer to flash. Since flash is written to in blocks, the contents of flash from the last byte written up to the next multiple of CONFIG_IMG_BLOCK_BUF_SIZE is padded with 0xff.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>context </td></tr>
    <tr><td class="paramname">data</td><td>data to write </td></tr>
    <tr><td class="paramname">len</td><td>Number of bytes to write </td></tr>
    <tr><td class="paramname">flush</td><td>when true this forces any buffered data to be written to flash</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, negative errno code on fail </dd></dl>

</div>
</div>
<a id="ac1ef017d400bda921ca894d13126b390" name="ac1ef017d400bda921ca894d13126b390"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1ef017d400bda921ca894d13126b390">&#9670;&nbsp;</a></span>flash_img_bytes_written()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t flash_img_bytes_written </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structflash__img__context.html">flash_img_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read number of bytes of the image written to the flash. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>context</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Number of bytes written to the image flash. </dd></dl>

</div>
</div>
<a id="a5a025255d8bf4a94f9e8d315d5502e88" name="a5a025255d8bf4a94f9e8d315d5502e88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a025255d8bf4a94f9e8d315d5502e88">&#9670;&nbsp;</a></span>flash_img_check()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="structflash__img__check.html">flash_img_check</a> </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structflash__img__context.html">flash_img_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structflash__img__check.html">flash_img_check</a> *&#160;</td>
          <td class="paramname"><em>fic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a3cb4a16b0e8d6af0af86d4fd6ba5fd9d">uint8_t</a>&#160;</td>
          <td class="paramname"><em>area_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Verify flash memory length bytes integrity from a flash area. The start point is indicated by an offset value. </p>
<p >The function is enabled via CONFIG_IMG_ENABLE_IMAGE_CHECK Kconfig options.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>context. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fic</td><td>flash img check data. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">area_id</td><td>flash area id of partition where the image should be verified.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, negative errno code on fail </dd></dl>

</div>
</div>
<a id="ac6d1d7811516493242b318be2ecd82df" name="ac6d1d7811516493242b318be2ecd82df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6d1d7811516493242b318be2ecd82df">&#9670;&nbsp;</a></span>flash_img_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int flash_img_init </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structflash__img__context.html">flash_img_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize context needed for writing the image to the flash. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>context to be initialized</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, negative errno code on fail </dd></dl>

</div>
</div>
<a id="a1b194edcb7e4ae34717d011f08d93e0c" name="a1b194edcb7e4ae34717d011f08d93e0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b194edcb7e4ae34717d011f08d93e0c">&#9670;&nbsp;</a></span>flash_img_init_id()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int flash_img_init_id </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structflash__img__context.html">flash_img_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stdint_8h.html#a3cb4a16b0e8d6af0af86d4fd6ba5fd9d">uint8_t</a>&#160;</td>
          <td class="paramname"><em>area_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize context needed for writing the image to the flash. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>context to be initialized </td></tr>
    <tr><td class="paramname">area_id</td><td>flash area id of partition where the image should be written</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, negative errno code on fail </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_7464a6b1b0a3f30b998710e6a7979f20.html">dfu</a></li><li class="navelem"><a class="el" href="flash__img_8h.html">flash_img.h</a></li>
    <li class="footer">Generated on Mon Feb 21 2022 04:59:40 for Zephyr API Documentation by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2 </li>
  </ul>
</div>
<script type="text/javascript">
  $(function() {
    toggleButton = document.createElement('doxygen-awesome-dark-mode-toggle')
    toggleButton.title = "Toggle Light/Dark Mode"
    $(document).ready(function(){
      document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
    })
    // every resize will remove the button, which is why it has to be added again:
    $(window).resize(function(){
      document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
    })
  })
</script>
</body>
</html>
