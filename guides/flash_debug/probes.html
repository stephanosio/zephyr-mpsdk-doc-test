<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Debug Probes &mdash; Zephyr Project Documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/tabs.css" type="text/css" />
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script type="module" src="../../_static/js/dark-mode-toggle.min.mjs"></script>
        <script src="https://www.googletagmanager.com/gtag/js?id=UA-831873-47"></script>
        <script src="../../_static/js/ga-tracker.js"></script>
        <script src="../../_static/tabs.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="copyright" title="Copyright" href="../../copyright.html" />
    <link rel="next" title="Debugging and Tracing" href="../debug_tools/index.html" />
    <link rel="prev" title="Flash &amp; Debug Host Tools" href="host-tools.html" />
  <meta name="color-scheme" content="dark light">
  
  <link rel="stylesheet" href="../../_static/css/light.css" type="text/css" media="(prefers-color-scheme: light)"/>
  <link rel="stylesheet" href="../../_static/css/dark.css" type="text/css" media="(prefers-color-scheme: dark)"/>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html">
            <img src="../../_static/logo.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                3.0.99
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
  
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Zephyr Project</span>
      v: latest
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        <dt>Document Release Versions</dt>
        
          <dd><a href="/">latest</a></dd>
        
          <dd><a href="/3.0.0/">3.0.0</a></dd>
        
          <dd><a href="/2.7.0/">2.7.0</a></dd>
        
          <dd><a href="/2.6.0/">2.6.0</a></dd>
        
          <dd><a href="/2.5.0/">2.5.0</a></dd>
        
          <dd><a href="/2.4.0/">2.4.0</a></dd>
        
          <dd><a href="/2.3.0/">2.3.0</a></dd>
        
          <dd><a href="/1.14.1/">1.14.1</a></dd>
        
      </dl>
      <dl>
        <dt>Downloads</dt>
        
        <dd><a href="/latest/zephyr.pdf">PDF</a></dd>
      </dl>
      <dl>
        <dt>zephyrproject.org Links</dt>
          <dd>
            <a href="https://www.zephyrproject.org/">Project Home</a>
          </dd>
          <dd>
            <a href="https://github.com/zephyrproject-rtos/sdk-ng/releases">SDK</a>
          </dd>
          <dd>
            <a href="https://github.com/zephyrproject-rtos/zephyr/releases">Releases</a>
          </dd>
      </dl>
    </div>
  </div>
  
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started/index.html">Getting Started Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contribute/index.html">Contribution Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development_process/index.html">Development and Contribution Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../build/index.html">Build and Configuration Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../application/index.html">Application Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/index.html">API Reference</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">User and Developer Guides</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../beyond-GSG.html">Beyond the Getting Started Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../arch/index.html">Architecture-related Guides</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bluetooth/index.html">Bluetooth</a></li>
<li class="toctree-l2"><a class="reference internal" href="../docs/index.html">Documentation Generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../coccinelle.html">Coccinelle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../code-relocation.html">Code And Data Relocation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../crypto/index.html">Cryptography</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Flashing and Hardware Debugging</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="host-tools.html">Flash &amp; Debug Host Tools</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Debug Probes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#lpc-link2-j-link-onboard-debug-probe">LPC-Link2 J-Link Onboard Debug Probe</a></li>
<li class="toctree-l4"><a class="reference internal" href="#opensda-daplink-onboard-debug-probe">OpenSDA DAPLink Onboard Debug Probe</a></li>
<li class="toctree-l4"><a class="reference internal" href="#opensda-j-link-onboard-debug-probe">OpenSDA J-Link Onboard Debug Probe</a></li>
<li class="toctree-l4"><a class="reference internal" href="#j-link-external-debug-probe">J-Link External Debug Probe</a></li>
<li class="toctree-l4"><a class="reference internal" href="#st-link-v2-1-onboard-debug-probe">ST-LINK/V2-1 Onboard Debug Probe</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../debug_tools/index.html">Debugging and Tracing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../device_mgmt/index.html">Device Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dts/index.html">Devicetree Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../env_vars.html">Environment Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pinctrl/index.html">Pin Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pm/index.html">Power Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../emulator/index.html">Peripheral and Hardware Emulators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules.html">Modules (External projects)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../networking/index.html">Networking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../platformio/index.html">Using with PlatformIO</a></li>
<li class="toctree-l2"><a class="reference internal" href="../portability/index.html">OS Abstraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../porting/index.html">Porting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../smf/index.html">State Machine Framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="../test/index.html">Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tfm/index.html">Trusted Firmware-M</a></li>
<li class="toctree-l2"><a class="reference internal" href="../west/index.html">West (Zephyr’s meta-tool)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../optimizations/index.html">Optimizations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../zephyr_cmake_package.html">Zephyr CMake Package</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../security/index.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../samples/index.html">Samples and Demos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../boards/index.html">Supported Boards</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../releases/index.html">Release Notes</a></li>
</ul>

  
  <div class="toctree-wrapper compound">
    <p class="caption"><span class="caption-text">Reference</span></p>
    <ul>
      
      <li class="toctree-l1">
        <a class="reference internal" href="/latest/doxygen/html/index.html">API</a>
      </li>
      
      <li class="toctree-l1">
        <a class="reference internal" href="/latest/kconfig.html">Kconfig Options</a>
      </li>
      
      <li class="toctree-l1">
        <a class="reference internal" href="/latest/reference/devicetree/bindings.html">Devicetree Bindings</a>
      </li>
      
    </ul>
  </div>
  

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Zephyr Project</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
  <!-- Docs / Latest -->
  
  

  <li><a href="../../index.html">Docs / Latest</a> &raquo;</li>
  
     <li><a href="../index.html">User and Developer Guides</a> &raquo;</li>
  
     <li><a href="index.html">Flashing and Hardware Debugging</a> &raquo;</li>
  
  <li>Debug Probes</li>


  <li class="wy-breadcrumbs-aside">
    <dark-mode-toggle id="dark-mode-toggle" appearance="toggle" permanent="true"/>
  </li>
  <li class="wy-breadcrumbs-aside">
      
      
        <a href="https://github.com/zephyrproject-rtos/zephyr/blob/main/doc/guides/flash_debug/probes.rst" class="fa fa-github"> Open on GitHub</a>
      
    
  </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
  
    <div class="wy-alert wy-alert-danger">
     This is the documentation for the latest (main) development branch of
     Zephyr. If you are looking for the documentation of previous releases, use
     the drop-down menu on the left and select the desired version.
    </div>
  
  
           <div itemprop="articleBody">
             
  <div class="section" id="debug-probes">
<span id="id1"></span><h1>Debug Probes<a class="headerlink" href="#debug-probes" title="Permalink to this headline">¶</a></h1>
<p>A <em>debug probe</em> is special hardware which allows you to control execution of a
Zephyr application running on a separate board. Debug probes usually allow
reading and writing registers and memory, and support breakpoint debugging of
the Zephyr application on your host workstation using tools like GDB. They may
also support other debug software and more advanced features such as
<a class="reference internal" href="../debug_tools/tracing/index.html#tracing"><span class="std std-ref">tracing program execution</span></a>. For details on the related host
software supported by Zephyr, see <a class="reference internal" href="host-tools.html#flash-debug-host-tools"><span class="std std-ref">Flash &amp; Debug Host Tools</span></a>.</p>
<p>Debug probes are usually connected to your host workstation via USB; they
are sometimes also accessible via an IP network or other means. They usually
connect to the device running Zephyr using the JTAG or SWD protocols. Debug
probes are either separate hardware devices or circuitry integrated into the same
board which runs Zephyr.</p>
<p>Many supported boards in Zephyr include a second microcontroller that serves as
an onboard debug probe, usb-to-serial adapter, and sometimes a drag-and-drop
flash programmer. This eliminates the need to purchase an external debug probe
and provides a variety of debug host tool options.</p>
<p>Several hardware vendors have their own branded onboard debug probe
implementations: NXP LPC boards have <a class="reference external" href="#lpclink2-jlink-onboard-debug-probe">LPC-Link2</a>,
NXP Kinetis (former Freescale) boards have <a class="reference external" href="#opensda-daplink-onboard-debug-probe">OpenSDA</a>,
and ST boards have <a class="reference external" href="#stlink-v21-onboard-debug-probe">ST-LINK</a>. Each onboard debug probe
microcontroller can support one or more types of firmware that communicate with
their respective debug host tools. For example, an OpenSDA microcontroller can
be programmed with DAPLink firmware to communicate with pyOCD or OpenOCD debug
host tools, or with J-Link firmware to communicate with J-Link debug host
tools.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 16%" />
<col style="width: 22%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 21%" />
</colgroup>
<tbody>
<tr class="row-odd"><td colspan="2" rowspan="2"><div class="line-block">
<div class="line"><em>Debug Probes &amp; Host Tools</em></div>
<div class="line"><em>Compatibility Chart</em></div>
</div>
</td>
<td colspan="3"><p>Host Tools</p></td>
</tr>
<tr class="row-even"><td><p><strong>J-Link Debug</strong></p></td>
<td><p><strong>OpenOCD</strong></p></td>
<td><p><strong>pyOCD</strong></p></td>
</tr>
<tr class="row-odd"><td rowspan="5"><p>Debug Probes</p></td>
<td><p><strong>LPC-Link2 J-Link</strong></p></td>
<td><p>✓</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>OpenSDA DAPLink</strong></p></td>
<td></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
</tr>
<tr class="row-odd"><td><p><strong>OpenSDA J-Link</strong></p></td>
<td><p>✓</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>J-Link External</strong></p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>ST-LINK/V2-1</strong></p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p><em>some STM32 boards</em></p></td>
</tr>
</tbody>
</table>
<p>Some supported boards in Zephyr do not include an onboard debug probe and
therefore require an external debug probe. In addition, boards that do include
an onboard debug probe often also have an SWD or JTAG header to enable the use
of an external debug probe instead. One reason this may be useful is that the
onboard debug probe may have limitations, such as lack of support for advanced
debuggers or high-speed tracing. You may need to adjust jumpers to prevent the
onboard debug probe from interfering with the external debug probe.</p>
<div class="section" id="lpc-link2-j-link-onboard-debug-probe">
<span id="lpclink2-jlink-onboard-debug-probe"></span><h2>LPC-Link2 J-Link Onboard Debug Probe<a class="headerlink" href="#lpc-link2-j-link-onboard-debug-probe" title="Permalink to this headline">¶</a></h2>
<p>The LPC-Link2 J-Link is an onboard debug probe and usb-to-serial adapter
supported on many NXP LPC and i.MX RT development boards.</p>
<p>This debug probe is compatible with the following debug host tools:</p>
<ul class="simple">
<li><p><a class="reference internal" href="host-tools.html#jlink-debug-host-tools"><span class="std std-ref">J-Link Debug Host Tools</span></a></p></li>
</ul>
<p>This probe is realized by programming the LPC-Link2 microcontroller with J-Link
LPC-Link2 firmware. Download and install <a class="reference external" href="https://www.nxp.com/lpcscrypt">LPCScrypt</a> to get the firmware and
programming scripts.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Verify the firmware supports your board by visiting <a class="reference external" href="https://www.segger.com/products/debug-probes/j-link/models/other-j-links/lpcxpresso-on-board/">Firmware for LPCXpresso</a></p>
</div>
<ol class="arabic simple">
<li><p>Put the LPC-Link2 microcontroller into DFU boot mode by attaching the DFU
jumper, then powering up the board.</p></li>
<li><p>Run the <code class="docutils literal notranslate"><span class="pre">program_JLINK</span></code> script.</p></li>
<li><p>Remove the DFU jumper and power cycle the board.</p></li>
</ol>
</div>
<div class="section" id="opensda-daplink-onboard-debug-probe">
<span id="id2"></span><h2>OpenSDA DAPLink Onboard Debug Probe<a class="headerlink" href="#opensda-daplink-onboard-debug-probe" title="Permalink to this headline">¶</a></h2>
<p>The OpenSDA DAPLink is an onboard debug probe and usb-to-serial adapter
supported on many NXP Kinetis and i.MX RT development boards. It also includes
drag-and-drop flash programming support.</p>
<p>This debug probe is compatible with the following debug host tools:</p>
<ul class="simple">
<li><p><a class="reference internal" href="host-tools.html#pyocd-debug-host-tools"><span class="std std-ref">pyOCD Debug Host Tools</span></a></p></li>
<li><p><a class="reference internal" href="host-tools.html#openocd-debug-host-tools"><span class="std std-ref">OpenOCD Debug Host Tools</span></a></p></li>
</ul>
<p>This probe is realized by programming the OpenSDA microcontroller with DAPLink
OpenSDA firmware. NXP provides <a class="reference external" href="https://www.nxp.com/opensda">OpenSDA DAPLink Board-Specific Firmwares</a>.</p>
<p>Install the debug host tools before you program the firmware.</p>
<p>As with all OpenSDA debug probes, the steps for programming the firmware are:</p>
<ol class="arabic simple">
<li><p>Put the OpenSDA microcontroller into bootloader mode by holding the reset
button while you power on the board. Note that “bootloader mode” in this
context applies to the OpenSDA microcontroller itself, not the target
microcontroller of your Zephyr application.</p></li>
<li><p>After you power on the board, release the reset button. A USB mass storage
device called <strong>BOOTLOADER</strong> or <strong>MAINTENANCE</strong> will enumerate.</p></li>
<li><p>Copy the OpenSDA firmware binary to the USB mass storage device.</p></li>
<li><p>Power cycle the board, this time without holding the reset button. You
should see three USB devices enumerate: a CDC device (serial port), a HID
device (debug port), and a mass storage device (drag-and-drop flash
programming).</p></li>
</ol>
</div>
<div class="section" id="opensda-j-link-onboard-debug-probe">
<span id="opensda-jlink-onboard-debug-probe"></span><h2>OpenSDA J-Link Onboard Debug Probe<a class="headerlink" href="#opensda-j-link-onboard-debug-probe" title="Permalink to this headline">¶</a></h2>
<p>The OpenSDA J-Link is an onboard debug probe and usb-to-serial adapter
supported on many NXP Kinetis and i.MX RT development boards.</p>
<p>This debug probe is compatible with the following debug host tools:</p>
<ul class="simple">
<li><p><a class="reference internal" href="host-tools.html#jlink-debug-host-tools"><span class="std std-ref">J-Link Debug Host Tools</span></a></p></li>
</ul>
<p>This probe is realized by programming the OpenSDA microcontroller with J-Link
OpenSDA firmware. Segger provides <a class="reference external" href="https://www.segger.com/downloads/jlink/#JLinkOpenSDAGenericFirmwares">OpenSDA J-Link Generic Firmwares</a> and
<a class="reference external" href="https://www.segger.com/downloads/jlink/#JLinkOpenSDABoardSpecificFirmwares">OpenSDA J-Link Board-Specific Firmwares</a>, where the latter is generally
recommended when available. Board-specific firmwares are required for i.MX RT
boards to support their external flash memories, whereas generic firmwares are
compatible with all Kinetis boards.</p>
<p>Install the debug host tools before you program the firmware.</p>
<p>As with all OpenSDA debug probes, the steps for programming the firmware are:</p>
<ol class="arabic simple">
<li><p>Put the OpenSDA microcontroller into bootloader mode by holding the reset
button while you power on the board. Note that “bootloader mode” in this
context applies to the OpenSDA microcontroller itself, not the target
microcontroller of your Zephyr application.</p></li>
<li><p>After you power on the board, release the reset button. A USB mass storage
device called <strong>BOOTLOADER</strong> or <strong>MAINTENANCE</strong> will enumerate.</p></li>
<li><p>Copy the OpenSDA firmware binary to the USB mass storage device.</p></li>
<li><p>Power cycle the board, this time without holding the reset button. You
should see two USB devices enumerate: a CDC device (serial port) and a
vendor-specific device (debug port).</p></li>
</ol>
</div>
<div class="section" id="j-link-external-debug-probe">
<span id="jlink-external-debug-probe"></span><h2>J-Link External Debug Probe<a class="headerlink" href="#j-link-external-debug-probe" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://www.segger.com/products/debug-probes/j-link/">Segger J-Link</a> is a family of external debug probes, including J-Link EDU,
J-Link PLUS, J-Link ULTRA+, and J-Link PRO, that support a large number of
devices from different hardware architectures and vendors.</p>
<p>This debug probe is compatible with the following debug host tools:</p>
<ul class="simple">
<li><p><a class="reference internal" href="host-tools.html#jlink-debug-host-tools"><span class="std std-ref">J-Link Debug Host Tools</span></a></p></li>
<li><p><a class="reference internal" href="host-tools.html#openocd-debug-host-tools"><span class="std std-ref">OpenOCD Debug Host Tools</span></a></p></li>
</ul>
<p>Install the debug host tools before you program the firmware.</p>
</div>
<div class="section" id="st-link-v2-1-onboard-debug-probe">
<span id="stlink-v21-onboard-debug-probe"></span><h2>ST-LINK/V2-1 Onboard Debug Probe<a class="headerlink" href="#st-link-v2-1-onboard-debug-probe" title="Permalink to this headline">¶</a></h2>
<p>ST-LINK/V2-1 is a serial and debug adapter built into all Nucleo and Discovery
boards. It provides a bridge between your computer (or other USB host) and the
embedded target processor, which can be used for debugging, flash programming,
and serial communication, all over a simple USB cable.</p>
<p>It is compatible with the following host debug tools:</p>
<ul class="simple">
<li><p><a class="reference internal" href="host-tools.html#openocd-debug-host-tools"><span class="std std-ref">OpenOCD Debug Host Tools</span></a></p></li>
<li><p><a class="reference internal" href="host-tools.html#jlink-debug-host-tools"><span class="std std-ref">J-Link Debug Host Tools</span></a></p></li>
</ul>
<p>For some STM32 based boards, it is also compatible with:</p>
<ul class="simple">
<li><p><a class="reference internal" href="host-tools.html#pyocd-debug-host-tools"><span class="std std-ref">pyOCD Debug Host Tools</span></a></p></li>
</ul>
<p>While it works out of the box with OpenOCD, it requires some flashing
to work with J-Link. To do this, SEGGER offers a firmware upgrading the
ST-LINK/V2-1 on board on the Nucleo and Discovery boards. This firmware makes
the ST-LINK/V2-1 compatible with J-LinkOB, allowing users to take advantage of
most J-Link features like the ultra fast flash download and debugging speed or
the free-to-use GDBServer.</p>
<p>More informations about upgrading ST-LINK/V2-1 to JLink or restore ST-Link/V2-1
firmware please visit: <a class="reference external" href="https://www.segger.com/products/debug-probes/j-link/models/other-j-links/st-link-on-board/">Segger over ST-Link</a></p>
<div class="section" id="flash-and-debug-with-st-link">
<h3>Flash and debug with ST-Link<a class="headerlink" href="#flash-and-debug-with-st-link" title="Permalink to this headline">¶</a></h3>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-0-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-0-0-0" name="0-0" role="tab" tabindex="0">Using OpenOCD</button><button aria-controls="panel-0-0-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-0-0-1" name="0-1" role="tab" tabindex="-1"><span class="target" id="using-segger-j-link">Using Segger J-Link</span></button></div><div aria-labelledby="tab-0-0-0" class="sphinx-tabs-panel" id="panel-0-0-0" name="0-0" role="tabpanel" tabindex="0"><p>OpenOCD is available by default on ST-Link and configured as the default flash
and debug tool. Flash and debug can be done as follows:</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp"># </span>From the root of the zephyr repository
<span class="go">west build -b None samples/hello_world</span>
<span class="go">west flash</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp"># </span>From the root of the zephyr repository
<span class="go">west build -b None samples/hello_world</span>
<span class="go">west debug</span>
</pre></div>
</div>
</div></blockquote>
</div><div aria-labelledby="tab-0-0-1" class="sphinx-tabs-panel" hidden="true" id="panel-0-0-1" name="0-1" role="tabpanel" tabindex="0"><p>Once STLink is flashed with SEGGER FW and J-Link GDB server is installed on your
host computer, you can flash and debug as follows:</p>
<p>Use CMake with <code class="docutils literal notranslate"><span class="pre">-DBOARD_FLASH_RUNNER=jlink</span></code> to change the default OpenOCD
runner to J-Link. Alternatively, you might add the following line to your
application <code class="docutils literal notranslate"><span class="pre">CMakeList.txt</span></code> file.</p>
<blockquote>
<div><div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span><span class="p">(</span><span class="s">BOARD_FLASH_RUNNER</span><span class="w"> </span><span class="s">jlink</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p>If you use West (Zephyr’s meta-tool) you can modify the default runner using
the <code class="docutils literal notranslate"><span class="pre">--runner</span></code> (or <code class="docutils literal notranslate"><span class="pre">-r</span></code>) option.</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">west flash --runner jlink</span>
</pre></div>
</div>
</div></blockquote>
<p>To attach a debugger to your board and open up a debug console with <code class="docutils literal notranslate"><span class="pre">jlink</span></code>.</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">west debug --runner jlink</span>
</pre></div>
</div>
</div></blockquote>
<p>For more information about West and available options, see <a class="reference internal" href="../west/index.html#west"><span class="std std-ref">West (Zephyr’s meta-tool)</span></a>.</p>
<p>If you configured your Zephyr application to use <a class="reference external" href="https://www.segger.com/jlink-rtt.html">Segger RTT</a> console instead,
open telnet:</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>telnet localhost <span class="m">19021</span>
<span class="go">Trying ::1...</span>
<span class="go">Trying 127.0.0.1...</span>
<span class="go">Connected to localhost.</span>
<span class="go">Escape character is &#39;^]&#39;.</span>
<span class="go">SEGGER J-Link V6.30f - Real time terminal output</span>
<span class="go">J-Link STLink V21 compiled Jun 26 2017 10:35:16 V1.0, SN=773895351</span>
<span class="go">Process: JLinkGDBServerCLExe</span>
<span class="go">Zephyr Shell, Zephyr version: 1.12.99</span>
<span class="go">Type &#39;help&#39; for a list of available commands</span>
<span class="go">shell&gt;</span>
</pre></div>
</div>
</div></blockquote>
<p>If you get no RTT output you might need to disable other consoles which conflict
with the RTT one if they are enabled by default in the particular sample or
application you are running, such as disable UART_CONSOLE in menucon</p>
</div></div>
</div>
<div class="section" id="updating-or-restoring-st-link-firmware">
<h3>Updating or restoring ST-Link firmware<a class="headerlink" href="#updating-or-restoring-st-link-firmware" title="Permalink to this headline">¶</a></h3>
<p>ST-Link firmware can be updated using <a class="reference external" href="https://www.st.com/en/development-tools/stm32cubeprog.html">STM32CubeProgrammer Tool</a>.
It is usually useful when facing flashing issues, for instance when using
twister’s device-testing option.</p>
<p>Once installed, you can update attached board ST-Link firmware with the
following command</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">s java -jar ~/STMicroelectronics/STM32Cube/STM32CubeProgrammer/Drivers/FirmwareUpgrade/STLinkUpgrade.jar -sn &lt;board_uid&gt;</span>
</pre></div>
</div>
</div></blockquote>
<p>Where board_uid can be obtained using twister’s generate-hardware-map
option. For more information about twister and available options, see
<a class="reference internal" href="../test/twister.html#twister-script"><span class="std std-ref">Test Runner (Twister)</span></a>.</p>
</div>
</div>
</div>


           </div>
          </div>

          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; <a href="../../copyright.html">Copyright</a> 2015-2022 Zephyr Project members and individual contributors.
      <span class="lastupdated">Last updated on Mar 05, 2022.
      </span></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>